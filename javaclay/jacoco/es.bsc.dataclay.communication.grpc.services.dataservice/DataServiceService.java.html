<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>DataServiceService.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">dataclay</a> &gt; <a href="index.source.html" class="el_package">es.bsc.dataclay.communication.grpc.services.dataservice</a> &gt; <span class="el_source">DataServiceService.java</span></div><h1>DataServiceService.java</h1><pre class="source lang-java linenums">
/**
 * 
 */
package es.bsc.dataclay.communication.grpc.services.dataservice;

import java.util.ArrayList;
import java.util.HashSet;
import java.util.List;
import java.util.Map;
import java.util.Map.Entry;
import java.util.Set;
import java.util.concurrent.ConcurrentHashMap;
import java.util.concurrent.TimeUnit;

import com.google.protobuf.Any;
import com.google.rpc.Code;
import com.google.rpc.Status;
import io.grpc.protobuf.StatusProto;
import org.apache.logging.log4j.LogManager;
import org.apache.logging.log4j.Logger;

import com.google.protobuf.ByteString;

import es.bsc.dataclay.communication.grpc.Utils;
import es.bsc.dataclay.communication.grpc.generated.dataservice.DataServiceGrpc;
import es.bsc.dataclay.communication.grpc.messages.common.CommonMessages;
import es.bsc.dataclay.communication.grpc.messages.common.CommonMessages.EmptyMessage;
import es.bsc.dataclay.communication.grpc.messages.common.CommonMessages.ExceptionInfo;
import es.bsc.dataclay.communication.grpc.messages.common.CommonMessages.GetTracesResponse;
import es.bsc.dataclay.communication.grpc.messages.dataservice.DataserviceMessages;
import es.bsc.dataclay.communication.grpc.messages.dataservice.DataserviceMessages.ActivateTracingRequest;
import es.bsc.dataclay.communication.grpc.messages.dataservice.DataserviceMessages.CloseSessionInDSRequest;
import es.bsc.dataclay.communication.grpc.messages.dataservice.DataserviceMessages.ConsolidateVersionRequest;
import es.bsc.dataclay.communication.grpc.messages.dataservice.DataserviceMessages.DeployClassesRequest;
import es.bsc.dataclay.communication.grpc.messages.dataservice.DataserviceMessages.DeployMetaClassesRequest;
import es.bsc.dataclay.communication.grpc.messages.dataservice.DataserviceMessages.EnrichClassRequest;
import es.bsc.dataclay.communication.grpc.messages.dataservice.DataserviceMessages.ExecuteImplementationRequest;
import es.bsc.dataclay.communication.grpc.messages.dataservice.DataserviceMessages.ExecuteImplementationResponse;
import es.bsc.dataclay.communication.grpc.messages.dataservice.DataserviceMessages.GetClassIDFromObjectInMemoryRequest;
import es.bsc.dataclay.communication.grpc.messages.dataservice.DataserviceMessages.GetClassIDFromObjectInMemoryResponse;
import es.bsc.dataclay.communication.grpc.messages.dataservice.DataserviceMessages.GetCopyOfObjectRequest;
import es.bsc.dataclay.communication.grpc.messages.dataservice.DataserviceMessages.GetCopyOfObjectResponse;
import es.bsc.dataclay.communication.grpc.messages.dataservice.DataserviceMessages.GetFromDBResponse;
import es.bsc.dataclay.communication.grpc.messages.dataservice.DataserviceMessages.GetObjectsRequest;
import es.bsc.dataclay.communication.grpc.messages.dataservice.DataserviceMessages.GetObjectsResponse;
import es.bsc.dataclay.communication.grpc.messages.dataservice.DataserviceMessages.GetRetainedReferencesResponse;
import es.bsc.dataclay.communication.grpc.messages.dataservice.DataserviceMessages.InitBackendIDRequest;
import es.bsc.dataclay.communication.grpc.messages.dataservice.DataserviceMessages.MakePersistentRequest;
import es.bsc.dataclay.communication.grpc.messages.dataservice.DataserviceMessages.MigrateObjectsRequest;
import es.bsc.dataclay.communication.grpc.messages.dataservice.DataserviceMessages.MigrateObjectsResponse;
import es.bsc.dataclay.communication.grpc.messages.dataservice.DataserviceMessages.MigratedObjects;
import es.bsc.dataclay.communication.grpc.messages.dataservice.DataserviceMessages.MoveObjectsRequest;
import es.bsc.dataclay.communication.grpc.messages.dataservice.DataserviceMessages.MoveObjectsResponse;
import es.bsc.dataclay.communication.grpc.messages.dataservice.DataserviceMessages.NewPersistentInstanceRequest;
import es.bsc.dataclay.communication.grpc.messages.dataservice.DataserviceMessages.NewPersistentInstanceResponse;
import es.bsc.dataclay.communication.grpc.messages.dataservice.DataserviceMessages.NewReplicaRequest;
import es.bsc.dataclay.communication.grpc.messages.dataservice.DataserviceMessages.NewVersionRequest;
import es.bsc.dataclay.communication.grpc.messages.dataservice.DataserviceMessages.RemoveObjectsRequest;
import es.bsc.dataclay.communication.grpc.messages.dataservice.DataserviceMessages.RemoveObjectsResponse;
import es.bsc.dataclay.communication.grpc.messages.dataservice.DataserviceMessages.StoreObjectsRequest;
import es.bsc.dataclay.communication.grpc.messages.dataservice.DataserviceMessages.UpdateObjectRequest;
import es.bsc.dataclay.communication.grpc.messages.dataservice.DataserviceMessages.UpsertObjectsRequest;
import es.bsc.dataclay.dataservice.DataService;
import es.bsc.dataclay.serialization.lib.ObjectWithDataParamOrReturn;
import es.bsc.dataclay.serialization.lib.SerializedParametersOrReturn;
import es.bsc.dataclay.util.Configuration;
import es.bsc.dataclay.util.ids.ExecutionEnvironmentID;
import es.bsc.dataclay.util.ids.ImplementationID;
import es.bsc.dataclay.util.ids.MetaClassID;
import es.bsc.dataclay.util.ids.ObjectID;
import es.bsc.dataclay.util.ids.SessionID;
import es.bsc.dataclay.util.ids.StorageLocationID;
import es.bsc.dataclay.util.info.VersionInfo;
import es.bsc.dataclay.util.management.classmgr.MetaClass;
import es.bsc.dataclay.util.management.metadataservice.MetaDataInfo;
import es.bsc.dataclay.util.management.metadataservice.StorageLocation;
import es.bsc.dataclay.util.structs.Tuple;
import es.bsc.dataclay.util.yaml.CommonYAML;
import io.grpc.stub.StreamObserver;

/**
 * Implements all DataService GRPC methods.
 */
public final class DataServiceService extends DataServiceGrpc.DataServiceImplBase {

	/** Logger. */
<span class="nc" id="L88">	private static final Logger LOGGER = LogManager.getLogger(&quot;communication.LogicModule.service&quot;);</span>

	/** Actual DataService implementation. */
	private final DataService dataService;
	/** Indicates if debug is enabled. */
<span class="nc" id="L93">	protected static final boolean DEBUG_ENABLED = Configuration.isDebugEnabled();</span>

	/**
	 * Constructor
	 * 
	 * @param thedataService
	 *            Dataservice to process calls
	 */
<span class="nc" id="L101">	public DataServiceService(final DataService thedataService) {</span>
<span class="nc" id="L102">		this.dataService = thedataService;</span>
<span class="nc" id="L103">		LOGGER.info(&quot;Initialized DataServiceService&quot;);</span>
<span class="nc" id="L104">	}</span>

	@Override
	public void initBackendID(final InitBackendIDRequest request,
			final io.grpc.stub.StreamObserver&lt;CommonMessages.ExceptionInfo&gt; responseObserver) {
		try {
<span class="nc" id="L110">			dataService.initBackendID(Utils.getStorageLocationID(request.getBackendID()));</span>
<span class="nc" id="L111">			Utils.returnExceptionInfoMessage(responseObserver);</span>
<span class="nc" id="L112">			responseObserver.onCompleted();</span>
<span class="nc" id="L113">		} catch (final Exception e) {</span>
<span class="nc" id="L114">			final ExceptionInfo resp = Utils.serializeException(e);</span>
<span class="nc" id="L115">			responseObserver.onNext(resp);</span>
<span class="nc" id="L116">			responseObserver.onCompleted();</span>
<span class="nc" id="L117">		}</span>
<span class="nc" id="L118">	}</span>

	@Override
	public void deployMetaClasses(final DeployMetaClassesRequest request,
			final io.grpc.stub.StreamObserver&lt;CommonMessages.ExceptionInfo&gt; responseObserver) {
		try {
<span class="nc" id="L124">			final Map&lt;String, MetaClass&gt; deploymentPack = new ConcurrentHashMap&lt;&gt;();</span>
<span class="nc bnc" id="L125" title="All 2 branches missed.">			for (final Entry&lt;String, String&gt; entry : request.getDeploymentPackMap().entrySet()) {</span>
<span class="nc" id="L126">				final MetaClass mClass = (MetaClass) CommonYAML.getYamlObject().load(entry.getValue());</span>
<span class="nc" id="L127">				deploymentPack.put(entry.getKey(), mClass);</span>
<span class="nc" id="L128">			}</span>
<span class="nc" id="L129">			dataService.deployMetaClasses(request.getNamespace(), deploymentPack);</span>
<span class="nc" id="L130">			Utils.returnExceptionInfoMessage(responseObserver);</span>
<span class="nc" id="L131">			responseObserver.onCompleted();</span>
<span class="nc" id="L132">		} catch (final Exception e) {</span>
<span class="nc" id="L133">			final ExceptionInfo resp = Utils.serializeException(e);</span>
<span class="nc" id="L134">			responseObserver.onNext(resp);</span>
<span class="nc" id="L135">			responseObserver.onCompleted();</span>
<span class="nc" id="L136">		}</span>
<span class="nc" id="L137">	}</span>

	@Override
	public void deployClasses(final DeployClassesRequest request,
			final io.grpc.stub.StreamObserver&lt;CommonMessages.ExceptionInfo&gt; responseObserver) {
		try {
<span class="nc" id="L143">			final Map&lt;Tuple&lt;String, MetaClassID&gt;, byte[]&gt; newClasses = new ConcurrentHashMap&lt;&gt;();</span>
<span class="nc bnc" id="L144" title="All 2 branches missed.">			for (final Entry&lt;String, ByteString&gt; entry : request.getClassesToDeployMap().entrySet()) {</span>
<span class="nc" id="L145">				final String className = entry.getKey();</span>
<span class="nc" id="L146">				final MetaClassID classID = Utils.getMetaClassID(request.getClassIdsMap().get(className));</span>
<span class="nc" id="L147">				newClasses.put(new Tuple&lt;&gt;(className, classID), entry.getValue().toByteArray());</span>
<span class="nc" id="L148">			}</span>

<span class="nc" id="L150">			final Map&lt;String, byte[]&gt; aspects = new ConcurrentHashMap&lt;&gt;();</span>
<span class="nc bnc" id="L151" title="All 2 branches missed.">			for (final Entry&lt;String, ByteString&gt; entry : request.getAspectsMap().entrySet()) {</span>
<span class="nc" id="L152">				aspects.put(entry.getKey(), entry.getValue().toByteArray());</span>
<span class="nc" id="L153">			}</span>

<span class="nc" id="L155">			final Map&lt;String, byte[]&gt; yamls = new ConcurrentHashMap&lt;&gt;();</span>
<span class="nc bnc" id="L156" title="All 2 branches missed.">			for (final Entry&lt;String, ByteString&gt; entry : request.getYamlsMap().entrySet()) {</span>
<span class="nc" id="L157">				yamls.put(entry.getKey(), entry.getValue().toByteArray());</span>
<span class="nc" id="L158">			}</span>
<span class="nc" id="L159">			dataService.deployClasses(request.getNamespace(), newClasses, aspects, yamls);</span>
<span class="nc" id="L160">			Utils.returnExceptionInfoMessage(responseObserver);</span>
<span class="nc" id="L161">			responseObserver.onCompleted();</span>
<span class="nc" id="L162">		} catch (final Exception e) {</span>
<span class="nc" id="L163">			final ExceptionInfo resp = Utils.serializeException(e);</span>
<span class="nc" id="L164">			responseObserver.onNext(resp);</span>
<span class="nc" id="L165">			responseObserver.onCompleted();</span>
<span class="nc" id="L166">		}</span>
<span class="nc" id="L167">	}</span>

	@Override
	public void enrichClass(final EnrichClassRequest request,
			final io.grpc.stub.StreamObserver&lt;CommonMessages.ExceptionInfo&gt; responseObserver) {

		try {
<span class="nc" id="L174">			dataService.enrichClass(request.getNamespace(), request.getClassname(),</span>
<span class="nc" id="L175">					request.getClassToDeploy().toByteArray(), request.getAspect().toByteArray(),</span>
<span class="nc" id="L176">					request.getYaml().toByteArray());</span>
<span class="nc" id="L177">			Utils.returnExceptionInfoMessage(responseObserver);</span>
<span class="nc" id="L178">			responseObserver.onCompleted();</span>
<span class="nc" id="L179">		} catch (final Exception e) {</span>
<span class="nc" id="L180">			final ExceptionInfo resp = Utils.serializeException(e);</span>
<span class="nc" id="L181">			responseObserver.onNext(resp);</span>
<span class="nc" id="L182">			responseObserver.onCompleted();</span>
<span class="nc" id="L183">		}</span>
<span class="nc" id="L184">	}</span>

	/**
	 * &lt;pre&gt;
	 * Storage Location.
	 * &lt;/pre&gt;
	 */
	@Override
	public void newPersistentInstance(final NewPersistentInstanceRequest request,
			final io.grpc.stub.StreamObserver&lt;NewPersistentInstanceResponse&gt; responseObserver) {

		try {

<span class="nc" id="L197">			final Map&lt;MetaClassID, byte[]&gt; ifaceBitMaps = new ConcurrentHashMap&lt;&gt;();</span>
<span class="nc bnc" id="L198" title="All 2 branches missed.">			for (final Entry&lt;String, ByteString&gt; entry : request.getIfaceBitMapsMap().entrySet()) {</span>
<span class="nc" id="L199">				ifaceBitMaps.put(Utils.getMetaClassID(entry.getKey()), entry.getValue().toByteArray());</span>
<span class="nc" id="L200">			}</span>

<span class="nc" id="L202">			SerializedParametersOrReturn params = null;</span>
<span class="nc bnc" id="L203" title="All 2 branches missed.">			if (request.hasParams()) {</span>
<span class="nc" id="L204">				params = Utils.getParamsOrReturn(request.getParams());</span>
			}
<span class="nc" id="L206">			final ObjectID oid = dataService.newPersistentInstance(</span>
<span class="nc" id="L207">					Utils.getSessionID(request.getSessionID()),</span>
<span class="nc" id="L208">					Utils.getMetaClassID(request.getClassID()), </span>
<span class="nc" id="L209">					Utils.getImplementationID(request.getImplementationID()), ifaceBitMaps,</span>
					params);

<span class="nc" id="L212">			final NewPersistentInstanceResponse resp = NewPersistentInstanceResponse.newBuilder()</span>
<span class="nc" id="L213">					.setObjectID(Utils.getMsgID(oid)).build();</span>
<span class="nc" id="L214">			responseObserver.onNext(resp);</span>
<span class="nc" id="L215">			responseObserver.onCompleted();</span>
<span class="nc" id="L216">		} catch (final Exception e) {</span>
<span class="nc" id="L217">			final NewPersistentInstanceResponse.Builder builder = NewPersistentInstanceResponse.newBuilder();</span>
<span class="nc" id="L218">			builder.setExcInfo(Utils.serializeException(e));</span>
<span class="nc" id="L219">			final NewPersistentInstanceResponse resp = builder.build();</span>
<span class="nc" id="L220">			responseObserver.onNext(resp);</span>
<span class="nc" id="L221">			responseObserver.onCompleted();</span>
<span class="nc" id="L222">		}</span>
<span class="nc" id="L223">	}</span>

	@Override
	public void storeObjects(final StoreObjectsRequest request,
			final io.grpc.stub.StreamObserver&lt;CommonMessages.ExceptionInfo&gt; responseObserver) {

		try {
<span class="nc" id="L230">			final List&lt;ObjectWithDataParamOrReturn&gt; objects = new ArrayList&lt;&gt;();</span>
<span class="nc bnc" id="L231" title="All 2 branches missed.">			for (final CommonMessages.ObjectWithDataParamOrReturn volParam : request.getObjectsList()) {</span>
<span class="nc" id="L232">				objects.add(Utils.getObjectWithDataParamOrReturn(volParam));</span>
<span class="nc" id="L233">			}</span>
<span class="nc" id="L234">			final Set&lt;ObjectID&gt; idsWithAlias = new HashSet&lt;&gt;();</span>
<span class="nc bnc" id="L235" title="All 2 branches missed.">			if (request.getIdsWithAliasCount() &gt; 0) {</span>
<span class="nc bnc" id="L236" title="All 2 branches missed.">				for (final String idWithAlias : request.getIdsWithAliasList()) {</span>
<span class="nc" id="L237">					idsWithAlias.add(Utils.getObjectID(idWithAlias));</span>
<span class="nc" id="L238">				}</span>
			}

<span class="nc" id="L241">			dataService.storeObjects(Utils.getSessionID(request.getSessionID()), objects, request.getMoving(), idsWithAlias);</span>
<span class="nc" id="L242">			Utils.returnExceptionInfoMessage(responseObserver);</span>
<span class="nc" id="L243">			responseObserver.onCompleted();</span>
<span class="nc" id="L244">		} catch (final Exception ex) {</span>
<span class="nc" id="L245">			LOGGER.debug(&quot;storeObjects DataClay native error&quot;, ex);</span>
<span class="nc" id="L246">			final ExceptionInfo resp = Utils.serializeException(ex);</span>
<span class="nc" id="L247">			responseObserver.onNext(resp);</span>
<span class="nc" id="L248">			responseObserver.onCompleted();</span>
<span class="nc" id="L249">		}</span>

<span class="nc" id="L251">	}</span>

	@Override
	public void getCopyOfObject(final GetCopyOfObjectRequest request,
			final io.grpc.stub.StreamObserver&lt;GetCopyOfObjectResponse&gt; responseObserver) {

		try {

<span class="nc" id="L259">			final SerializedParametersOrReturn result = dataService.getCopyOfObject(</span>
<span class="nc" id="L260">					Utils.getSessionID(request.getSessionID()),</span>
<span class="nc" id="L261">					Utils.getObjectID(request.getObjectID()), request.getRecursive());</span>

<span class="nc" id="L263">			final GetCopyOfObjectResponse.Builder builder = GetCopyOfObjectResponse.newBuilder();</span>
<span class="nc" id="L264">			builder.setRet(Utils.getParamsOrReturn(result));</span>

<span class="nc" id="L266">			final GetCopyOfObjectResponse resp = builder.build();</span>
<span class="nc" id="L267">			responseObserver.onNext(resp);</span>
<span class="nc" id="L268">			responseObserver.onCompleted();</span>

<span class="nc" id="L270">		} catch (final Exception e) {</span>
<span class="nc" id="L271">			final GetCopyOfObjectResponse.Builder builder = GetCopyOfObjectResponse.newBuilder();</span>
<span class="nc" id="L272">			builder.setExcInfo(Utils.serializeException(e));</span>
<span class="nc" id="L273">			final GetCopyOfObjectResponse resp = builder.build();</span>
<span class="nc" id="L274">			responseObserver.onNext(resp);</span>
<span class="nc" id="L275">			responseObserver.onCompleted();</span>
<span class="nc" id="L276">		}</span>
<span class="nc" id="L277">	}</span>

	@Override
	public void updateObject(final UpdateObjectRequest request,
			final io.grpc.stub.StreamObserver&lt;CommonMessages.ExceptionInfo&gt; responseObserver) {

		try {

<span class="nc" id="L285">			dataService.updateObject(</span>
<span class="nc" id="L286">					Utils.getSessionID(request.getSessionID()), </span>
<span class="nc" id="L287">					Utils.getObjectID(request.getIntoObjectID()),</span>
<span class="nc" id="L288">					Utils.getParamsOrReturn(request.getFromObject()));</span>

<span class="nc" id="L290">			Utils.returnExceptionInfoMessage(responseObserver);</span>
<span class="nc" id="L291">			responseObserver.onCompleted();</span>

<span class="nc" id="L293">		} catch (final Exception ex) {</span>
<span class="nc" id="L294">			LOGGER.debug(&quot;putObject DataClay native error&quot;, ex);</span>
<span class="nc" id="L295">			final ExceptionInfo resp = Utils.serializeException(ex);</span>
<span class="nc" id="L296">			responseObserver.onNext(resp);</span>
<span class="nc" id="L297">			responseObserver.onCompleted();</span>
<span class="nc" id="L298">		}</span>
<span class="nc" id="L299">	}</span>

	@Override
	public void getObjects(final GetObjectsRequest request,
			final io.grpc.stub.StreamObserver&lt;GetObjectsResponse&gt; responseObserver) {

		try {

<span class="nc" id="L307">			final Set&lt;ObjectID&gt; objectIDs = new HashSet&lt;&gt;();</span>
<span class="nc bnc" id="L308" title="All 2 branches missed.">			for (final String oid : request.getObjectIDSList()) {</span>
<span class="nc" id="L309">				objectIDs.add(Utils.getObjectID(oid));</span>
<span class="nc" id="L310">			}</span>
<span class="nc" id="L311">			final Set&lt;ObjectID&gt; alreadyObtainedObjects = new HashSet&lt;&gt;();</span>
<span class="nc bnc" id="L312" title="All 2 branches missed.">			for (final String oid : request.getAlreadyObtainedObjectsList()) {</span>
<span class="nc" id="L313">				alreadyObtainedObjects.add(Utils.getObjectID(oid));</span>
<span class="nc" id="L314">			}</span>
<span class="nc" id="L315">			final List&lt;ObjectWithDataParamOrReturn&gt; result = dataService.getObjects(</span>
<span class="nc" id="L316">					Utils.getSessionID(request.getSessionID()),</span>
<span class="nc" id="L317">					objectIDs, alreadyObtainedObjects, request.getRecursive(),</span>
<span class="nc" id="L318">					Utils.getExecutionEnvironmentID(request.getDestBackendID()),</span>
<span class="nc" id="L319">					request.getUpdateReplicaLocs());</span>

<span class="nc" id="L321">			final GetObjectsResponse.Builder builder = GetObjectsResponse.newBuilder();</span>
<span class="nc bnc" id="L322" title="All 2 branches missed.">			for (final ObjectWithDataParamOrReturn entry : result) {</span>
<span class="nc" id="L323">				builder.addObjects(Utils.getObjectWithDataParamOrReturn(entry));</span>
<span class="nc" id="L324">			}</span>
<span class="nc" id="L325">			final GetObjectsResponse resp = builder.build();</span>
<span class="nc" id="L326">			responseObserver.onNext(resp);</span>
<span class="nc" id="L327">			responseObserver.onCompleted();</span>

<span class="nc" id="L329">		} catch (final Exception e) {</span>
<span class="nc" id="L330">			final GetObjectsResponse.Builder builder = GetObjectsResponse.newBuilder();</span>
<span class="nc" id="L331">			builder.setExcInfo(Utils.serializeException(e));</span>
<span class="nc" id="L332">			final GetObjectsResponse resp = builder.build();</span>
<span class="nc" id="L333">			responseObserver.onNext(resp);</span>
<span class="nc" id="L334">			responseObserver.onCompleted();</span>
<span class="nc" id="L335">		}</span>
<span class="nc" id="L336">	}</span>

	@Override
	public void newVersion(final NewVersionRequest request,
			final io.grpc.stub.StreamObserver&lt;DataserviceMessages.NewVersionResponse&gt; responseObserver) {

		try {
<span class="nc" id="L343">			ObjectID versionOID = dataService.newVersion(</span>
<span class="nc" id="L344">					Utils.getSessionID(request.getSessionID()),</span>
<span class="nc" id="L345">					Utils.getObjectID(request.getObjectID()),</span>
<span class="nc" id="L346">					Utils.getExecutionEnvironmentID(request.getDestBackendID()));</span>
<span class="nc" id="L347">			final DataserviceMessages.NewVersionResponse.Builder resp = DataserviceMessages.NewVersionResponse.newBuilder();</span>
<span class="nc" id="L348">			resp.setObjectID(Utils.getMsgID(versionOID));</span>
<span class="nc" id="L349">			responseObserver.onNext(resp.build());</span>
<span class="nc" id="L350">			responseObserver.onCompleted();</span>

<span class="nc" id="L352">		} catch (final Exception e) {</span>
<span class="nc" id="L353">			final DataserviceMessages.NewVersionResponse.Builder builder = DataserviceMessages.NewVersionResponse.newBuilder();</span>
<span class="nc" id="L354">			builder.setExcInfo(Utils.serializeException(e));</span>
<span class="nc" id="L355">			final DataserviceMessages.NewVersionResponse resp = builder.build();</span>
<span class="nc" id="L356">			responseObserver.onNext(resp);</span>
<span class="nc" id="L357">			responseObserver.onCompleted();</span>
<span class="nc" id="L358">		}</span>
<span class="nc" id="L359">	}</span>

	@Override
	public void consolidateVersion(final ConsolidateVersionRequest request,
			final io.grpc.stub.StreamObserver&lt;CommonMessages.ExceptionInfo&gt; responseObserver) {

		try {
<span class="nc" id="L366">			dataService.consolidateVersion(Utils.getSessionID(request.getSessionID()),</span>
<span class="nc" id="L367">					Utils.getObjectID(request.getVersionObjectID()));</span>
<span class="nc" id="L368">			Utils.returnExceptionInfoMessage(responseObserver);</span>
<span class="nc" id="L369">			responseObserver.onCompleted();</span>

<span class="nc" id="L371">		} catch (final Exception e) {</span>
<span class="nc" id="L372">			final ExceptionInfo resp = Utils.serializeException(e);</span>
<span class="nc" id="L373">			responseObserver.onNext(resp);</span>
<span class="nc" id="L374">			responseObserver.onCompleted();</span>
<span class="nc" id="L375">		}</span>
<span class="nc" id="L376">	}</span>

	@Override
	public void upsertObjects(final UpsertObjectsRequest request,
			final io.grpc.stub.StreamObserver&lt;CommonMessages.ExceptionInfo&gt; responseObserver) {

		try {
<span class="nc" id="L383">			final SessionID sessionID = Utils.getSessionID(request.getSessionID());</span>
<span class="nc" id="L384">			final List&lt;ObjectWithDataParamOrReturn&gt; objects = new ArrayList&lt;&gt;();</span>
<span class="nc bnc" id="L385" title="All 2 branches missed.">			for (final CommonMessages.ObjectWithDataParamOrReturn entry : request.getBytesUpdateList()) {</span>
<span class="nc" id="L386">				objects.add(Utils.getObjectWithDataParamOrReturn(entry));</span>
<span class="nc" id="L387">			}</span>
<span class="nc" id="L388">			dataService.upsertObjects(sessionID, objects);</span>
<span class="nc" id="L389">			Utils.returnExceptionInfoMessage(responseObserver);</span>
<span class="nc" id="L390">			responseObserver.onCompleted();</span>

<span class="nc" id="L392">		} catch (final Exception e) {</span>
<span class="nc" id="L393">			final ExceptionInfo resp = Utils.serializeException(e);</span>
<span class="nc" id="L394">			responseObserver.onNext(resp);</span>
<span class="nc" id="L395">			responseObserver.onCompleted();</span>
<span class="nc" id="L396">		}</span>
<span class="nc" id="L397">	}</span>

	@Override
	public void newReplica(final NewReplicaRequest request,
			final io.grpc.stub.StreamObserver&lt;DataserviceMessages.NewReplicaResponse&gt; responseObserver) {
		try {

<span class="nc" id="L404">			Set&lt;ObjectID&gt; replicatedIDs = dataService.newReplica(Utils.getSessionID(request.getSessionID()),</span>
<span class="nc" id="L405">					Utils.getObjectID(request.getObjectID()),</span>
<span class="nc" id="L406">					Utils.getExecutionEnvironmentID(request.getDestBackendID()),</span>
<span class="nc" id="L407">					request.getRecursive());</span>

<span class="nc" id="L409">			final DataserviceMessages.NewReplicaResponse.Builder resp = DataserviceMessages.NewReplicaResponse.newBuilder();</span>
<span class="nc bnc" id="L410" title="All 2 branches missed.">			for (ObjectID replicatedID : replicatedIDs) {</span>
<span class="nc" id="L411">				resp.addReplicatedObjects(Utils.getMsgID(replicatedID));</span>
<span class="nc" id="L412">			}</span>
<span class="nc" id="L413">			responseObserver.onNext(resp.build());</span>
<span class="nc" id="L414">			responseObserver.onCompleted();</span>

<span class="nc" id="L416">		} catch (final Exception e) {</span>
<span class="nc" id="L417">			final DataserviceMessages.NewReplicaResponse.Builder builder = DataserviceMessages.NewReplicaResponse.newBuilder();</span>
<span class="nc" id="L418">			builder.setExcInfo(Utils.serializeException(e));</span>
<span class="nc" id="L419">			final DataserviceMessages.NewReplicaResponse resp = builder.build();</span>
<span class="nc" id="L420">			responseObserver.onNext(resp);</span>
<span class="nc" id="L421">			responseObserver.onCompleted();</span>
<span class="nc" id="L422">		}</span>
<span class="nc" id="L423">	}</span>

	@Override
	public void moveObjects(final MoveObjectsRequest request,
			final io.grpc.stub.StreamObserver&lt;MoveObjectsResponse&gt; responseObserver) {
		try {

<span class="nc" id="L430">			final Set&lt;ObjectID&gt; result = dataService.moveObjects(Utils.getSessionID(request.getSessionID()),</span>
<span class="nc" id="L431">					Utils.getObjectID(request.getObjectID()), Utils.getExecutionEnvironmentID(request.getDestLocID()), request.getRecursive());</span>
<span class="nc" id="L432">			final MoveObjectsResponse.Builder builder = MoveObjectsResponse.newBuilder();</span>
<span class="nc bnc" id="L433" title="All 2 branches missed.">			for (final ObjectID oid : result) {</span>
<span class="nc" id="L434">				builder.addMovedObjects(Utils.getMsgID(oid));</span>
<span class="nc" id="L435">			}</span>

<span class="nc" id="L437">			final MoveObjectsResponse resp = builder.build();</span>
<span class="nc" id="L438">			responseObserver.onNext(resp);</span>
<span class="nc" id="L439">			responseObserver.onCompleted();</span>

<span class="nc" id="L441">		} catch (final Exception e) {</span>
<span class="nc" id="L442">			final MoveObjectsResponse.Builder builder = MoveObjectsResponse.newBuilder();</span>
<span class="nc" id="L443">			builder.setExcInfo(Utils.serializeException(e));</span>
<span class="nc" id="L444">			final MoveObjectsResponse resp = builder.build();</span>
<span class="nc" id="L445">			responseObserver.onNext(resp);</span>
<span class="nc" id="L446">			responseObserver.onCompleted();</span>
<span class="nc" id="L447">		}</span>
<span class="nc" id="L448">	}</span>

	@Override
	public void removeObjects(final RemoveObjectsRequest request,
			final io.grpc.stub.StreamObserver&lt;RemoveObjectsResponse&gt; responseObserver) {
		try {

<span class="nc" id="L455">			final Set&lt;ObjectID&gt; objectIDs = new HashSet&lt;&gt;();</span>
<span class="nc bnc" id="L456" title="All 2 branches missed.">			for (final String oid : request.getObjectIDsList()) {</span>
<span class="nc" id="L457">				objectIDs.add(Utils.getObjectID(oid));</span>
<span class="nc" id="L458">			}</span>
<span class="nc" id="L459">			final Map&lt;ObjectID, ExecutionEnvironmentID&gt; result = dataService.removeObjects(</span>
<span class="nc" id="L460">					Utils.getSessionID(request.getSessionID()), objectIDs, request.getRecursive(), request.getMoving(),</span>
<span class="nc" id="L461">					Utils.getExecutionEnvironmentID(request.getNewHint()));</span>
<span class="nc" id="L462">			final RemoveObjectsResponse.Builder builder = RemoveObjectsResponse.newBuilder();</span>
<span class="nc bnc" id="L463" title="All 2 branches missed.">			for (final Entry&lt;ObjectID, ExecutionEnvironmentID&gt; entry : result.entrySet()) {</span>
<span class="nc" id="L464">				builder.putRemovedObjects(entry.getKey().getId().toString(), entry.getValue().getId().toString());</span>
<span class="nc" id="L465">			}</span>

<span class="nc" id="L467">			final RemoveObjectsResponse resp = builder.build();</span>
<span class="nc" id="L468">			responseObserver.onNext(resp);</span>
<span class="nc" id="L469">			responseObserver.onCompleted();</span>

<span class="nc" id="L471">		} catch (final Exception e) {</span>
<span class="nc" id="L472">			final RemoveObjectsResponse.Builder builder = RemoveObjectsResponse.newBuilder();</span>
<span class="nc" id="L473">			builder.setExcInfo(Utils.serializeException(e));</span>
<span class="nc" id="L474">			final RemoveObjectsResponse resp = builder.build();</span>
<span class="nc" id="L475">			responseObserver.onNext(resp);</span>
<span class="nc" id="L476">			responseObserver.onCompleted();</span>
<span class="nc" id="L477">		}</span>
<span class="nc" id="L478">	}</span>

	@Override
	public void migrateObjectsToBackends(final MigrateObjectsRequest request,
			final io.grpc.stub.StreamObserver&lt;MigrateObjectsResponse&gt; responseObserver) {
		try {

<span class="nc" id="L485">			final Map&lt;StorageLocationID, StorageLocation&gt; backends = new ConcurrentHashMap&lt;&gt;();</span>
<span class="nc bnc" id="L486" title="All 2 branches missed.">			for (final Entry&lt;String, CommonMessages.StorageLocationInfo&gt; entry : request.getDestStorageLocsMap().entrySet()) {</span>
<span class="nc" id="L487">				backends.put(Utils.getStorageLocationID(entry.getKey()), Utils.getStorageLocation(entry.getValue()));</span>
<span class="nc" id="L488">			}</span>
<span class="nc" id="L489">			final Tuple&lt;Map&lt;StorageLocationID, Set&lt;ObjectID&gt;&gt;, Set&lt;ObjectID&gt;&gt; result = dataService</span>
<span class="nc" id="L490">					.migrateObjectsToBackends(backends);</span>

<span class="nc" id="L492">			final MigrateObjectsResponse.Builder builder = MigrateObjectsResponse.newBuilder();</span>
<span class="nc bnc" id="L493" title="All 2 branches missed.">			for (final Entry&lt;StorageLocationID, Set&lt;ObjectID&gt;&gt; entry : result.getFirst().entrySet()) {</span>
<span class="nc" id="L494">				final MigratedObjects.Builder migratedObjsBuilder = MigratedObjects.newBuilder();</span>
<span class="nc bnc" id="L495" title="All 2 branches missed.">				for (final ObjectID oid : entry.getValue()) {</span>
<span class="nc" id="L496">					migratedObjsBuilder.addObjs(Utils.getMsgID(oid));</span>
<span class="nc" id="L497">				}</span>
<span class="nc" id="L498">				final MigratedObjects mObjs = migratedObjsBuilder.build();</span>
<span class="nc" id="L499">				builder.putMigratedObjs(entry.getKey().getId().toString(), mObjs);</span>
<span class="nc" id="L500">			}</span>

<span class="nc" id="L502">			final MigratedObjects.Builder nonmigratedObjsBuilder = MigratedObjects.newBuilder();</span>
<span class="nc bnc" id="L503" title="All 2 branches missed.">			for (final ObjectID oid : result.getSecond()) {</span>
<span class="nc" id="L504">				nonmigratedObjsBuilder.addObjs(Utils.getMsgID(oid));</span>
<span class="nc" id="L505">			}</span>
<span class="nc" id="L506">			final MigratedObjects nonmObjs = nonmigratedObjsBuilder.build();</span>
<span class="nc" id="L507">			builder.setNonMigratedObjs(nonmObjs);</span>

<span class="nc" id="L509">			final MigrateObjectsResponse resp = builder.build();</span>
<span class="nc" id="L510">			responseObserver.onNext(resp);</span>
<span class="nc" id="L511">			responseObserver.onCompleted();</span>

<span class="nc" id="L513">		} catch (final Exception e) {</span>
<span class="nc" id="L514">			final MigrateObjectsResponse.Builder builder = MigrateObjectsResponse.newBuilder();</span>
<span class="nc" id="L515">			builder.setExcInfo(Utils.serializeException(e));</span>
<span class="nc" id="L516">			final MigrateObjectsResponse resp = builder.build();</span>
<span class="nc" id="L517">			responseObserver.onNext(resp);</span>
<span class="nc" id="L518">			responseObserver.onCompleted();</span>
<span class="nc" id="L519">		}</span>
<span class="nc" id="L520">	}</span>

	@Override
	public void getClassIDFromObjectInMemory(final GetClassIDFromObjectInMemoryRequest request,
			final io.grpc.stub.StreamObserver&lt;GetClassIDFromObjectInMemoryResponse&gt; responseObserver) {
		try {

<span class="nc" id="L527">			final ObjectID oid = Utils.getObjectID(request.getObjectID());</span>

<span class="nc" id="L529">			final MetaClassID result = dataService.getClassIDFromObjectInMemory(oid);</span>

			final GetClassIDFromObjectInMemoryResponse.Builder builder = GetClassIDFromObjectInMemoryResponse
<span class="nc" id="L532">					.newBuilder();</span>
<span class="nc bnc" id="L533" title="All 2 branches missed.">			if (result != null) {</span>
<span class="nc" id="L534">				builder.setClassID(Utils.getMsgID(result));</span>
			}
<span class="nc" id="L536">			final GetClassIDFromObjectInMemoryResponse resp = builder.build();</span>
<span class="nc" id="L537">			responseObserver.onNext(resp);</span>
<span class="nc" id="L538">			responseObserver.onCompleted();</span>

<span class="nc" id="L540">		} catch (final Exception e) {</span>
			final GetClassIDFromObjectInMemoryResponse.Builder builder = GetClassIDFromObjectInMemoryResponse
<span class="nc" id="L542">					.newBuilder();</span>
<span class="nc" id="L543">			builder.setExcInfo(Utils.serializeException(e));</span>
<span class="nc" id="L544">			final GetClassIDFromObjectInMemoryResponse resp = builder.build();</span>
<span class="nc" id="L545">			responseObserver.onNext(resp);</span>
<span class="nc" id="L546">			responseObserver.onCompleted();</span>
<span class="nc" id="L547">		}</span>
<span class="nc" id="L548">	}</span>

	@Override
	public void makePersistent(final MakePersistentRequest request,
			final io.grpc.stub.StreamObserver&lt;CommonMessages.ExceptionInfo&gt; responseObserver) {
<span class="nc" id="L553">		LOGGER.debug(&quot;[==Serialization==] Received request for make persistent &quot;);</span>
		try {
<span class="nc" id="L555">			List&lt;ObjectWithDataParamOrReturn&gt; params = new ArrayList&lt;&gt;();</span>
<span class="nc bnc" id="L556" title="All 2 branches missed.">			for (CommonMessages.ObjectWithDataParamOrReturn curObj : request.getObjectsList()) {</span>
<span class="nc" id="L557">				params.add(Utils.getObjectWithDataParamOrReturn(curObj));</span>
<span class="nc" id="L558">			}</span>
<span class="nc bnc" id="L559" title="All 2 branches missed.">			if (DEBUG_ENABLED) {</span>
<span class="nc" id="L560">				LOGGER.debug(&quot;[==Serialization==] Received request for make persistent with params:&quot; + params);</span>
			}
<span class="nc" id="L562">			dataService.makePersistent(Utils.getSessionID(request.getSessionID()), params);</span>

<span class="nc" id="L564">			Utils.returnExceptionInfoMessage(responseObserver);</span>
<span class="nc" id="L565">			responseObserver.onCompleted();</span>

<span class="nc" id="L567">		} catch (final Exception e) {</span>
<span class="nc" id="L568">			final ExceptionInfo resp = Utils.serializeException(e);</span>
<span class="nc" id="L569">			responseObserver.onNext(resp);</span>
<span class="nc" id="L570">			responseObserver.onCompleted();</span>
<span class="nc" id="L571">		}</span>
<span class="nc" id="L572">	}</span>

	@Override
	public void federate(final DataserviceMessages.FederateRequest request,
								 final io.grpc.stub.StreamObserver&lt;CommonMessages.ExceptionInfo&gt; responseObserver) {
		try {

<span class="nc" id="L579">			dataService.federate(Utils.getSessionID(request.getSessionID()),</span>
<span class="nc" id="L580">					Utils.getObjectID(request.getObjectID()),</span>
<span class="nc" id="L581">					Utils.getExecutionEnvironmentID(request.getExternalExecutionEnvironmentID()),</span>
<span class="nc" id="L582">					request.getRecursive());</span>
<span class="nc" id="L583">			Utils.returnExceptionInfoMessage(responseObserver);</span>
<span class="nc" id="L584">			responseObserver.onCompleted();</span>

<span class="nc" id="L586">		} catch (final Exception e) {</span>
<span class="nc" id="L587">			final ExceptionInfo resp = Utils.serializeException(e);</span>
<span class="nc" id="L588">			responseObserver.onNext(resp);</span>
<span class="nc" id="L589">			responseObserver.onCompleted();</span>
<span class="nc" id="L590">		}</span>
<span class="nc" id="L591">	}</span>

	@Override
	public void unfederate(final DataserviceMessages.UnfederateRequest request,
						 final io.grpc.stub.StreamObserver&lt;CommonMessages.ExceptionInfo&gt; responseObserver) {
		try {

<span class="nc" id="L598">			dataService.unfederate(Utils.getSessionID(request.getSessionID()),</span>
<span class="nc" id="L599">					Utils.getObjectID(request.getObjectID()),</span>
<span class="nc" id="L600">					Utils.getExecutionEnvironmentID(request.getExternalExecutionEnvironmentID()),</span>
<span class="nc" id="L601">					request.getRecursive());</span>
<span class="nc" id="L602">			Utils.returnExceptionInfoMessage(responseObserver);</span>
<span class="nc" id="L603">			responseObserver.onCompleted();</span>

<span class="nc" id="L605">		} catch (final Exception e) {</span>
<span class="nc" id="L606">			final ExceptionInfo resp = Utils.serializeException(e);</span>
<span class="nc" id="L607">			responseObserver.onNext(resp);</span>
<span class="nc" id="L608">			responseObserver.onCompleted();</span>
<span class="nc" id="L609">		}</span>
<span class="nc" id="L610">	}</span>


	@Override
	public void notifyFederation(final DataserviceMessages.NotifyFederationRequest request,
			final io.grpc.stub.StreamObserver&lt;CommonMessages.ExceptionInfo&gt; responseObserver) {
		try {

<span class="nc" id="L618">			List&lt;ObjectWithDataParamOrReturn&gt; params = new ArrayList&lt;&gt;();</span>
<span class="nc bnc" id="L619" title="All 2 branches missed.">			for (CommonMessages.ObjectWithDataParamOrReturn curObj : request.getObjectsList()) {</span>
<span class="nc" id="L620">				params.add(Utils.getObjectWithDataParamOrReturn(curObj));</span>
<span class="nc" id="L621">			}</span>

<span class="nc" id="L623">			dataService.notifyFederation(Utils.getSessionID(request.getSessionID()), params);</span>

<span class="nc" id="L625">			Utils.returnExceptionInfoMessage(responseObserver);</span>
<span class="nc" id="L626">			responseObserver.onCompleted();</span>

<span class="nc" id="L628">		} catch (final Exception e) {</span>
<span class="nc" id="L629">			final ExceptionInfo resp = Utils.serializeException(e);</span>
<span class="nc" id="L630">			responseObserver.onNext(resp);</span>
<span class="nc" id="L631">			responseObserver.onCompleted();</span>
<span class="nc" id="L632">		}</span>
<span class="nc" id="L633">	}</span>

	@Override
	public void notifyUnfederation(final DataserviceMessages.NotifyUnfederationRequest request,
			final io.grpc.stub.StreamObserver&lt;CommonMessages.ExceptionInfo&gt; responseObserver) {
		try {
<span class="nc" id="L639">			final Set&lt;ObjectID&gt; objectIDs = new HashSet&lt;&gt;();</span>
<span class="nc bnc" id="L640" title="All 2 branches missed.">			for (final String oid : request.getObjectIDsList()) {</span>
<span class="nc" id="L641">				objectIDs.add(Utils.getObjectID(oid));</span>
<span class="nc" id="L642">			}</span>
<span class="nc" id="L643">			dataService.notifyUnfederation(Utils.getSessionID(request.getSessionID()), objectIDs);</span>
<span class="nc" id="L644">			Utils.returnExceptionInfoMessage(responseObserver);</span>
<span class="nc" id="L645">			responseObserver.onCompleted();</span>
<span class="nc" id="L646">		} catch (final Exception e) {</span>
<span class="nc" id="L647">			final ExceptionInfo resp = Utils.serializeException(e);</span>
<span class="nc" id="L648">			responseObserver.onNext(resp);</span>
<span class="nc" id="L649">			responseObserver.onCompleted();</span>
<span class="nc" id="L650">		}</span>
<span class="nc" id="L651">	}</span>

	@Override
	public void executeImplementation(final ExecuteImplementationRequest request,
			final io.grpc.stub.StreamObserver&lt;ExecuteImplementationResponse&gt; responseObserver) {
		try {

<span class="nc" id="L658">			SerializedParametersOrReturn params = null;</span>
<span class="nc bnc" id="L659" title="All 2 branches missed.">			if (request.hasParams()) {</span>
<span class="nc" id="L660">				params = Utils.getParamsOrReturn(request.getParams());</span>
			}

<span class="nc" id="L663">			final ObjectID objectID = Utils.getObjectID(request.getObjectID());</span>
<span class="nc" id="L664">			final ImplementationID implID = Utils.getImplementationID(request.getImplementationID());</span>

<span class="nc" id="L666">			final SerializedParametersOrReturn result = dataService.executeImplementation(objectID, implID, params,</span>
<span class="nc" id="L667">					Utils.getSessionID(request.getSessionID()));</span>

<span class="nc" id="L669">			final ExecuteImplementationResponse.Builder builder = ExecuteImplementationResponse.newBuilder();</span>
<span class="nc bnc" id="L670" title="All 2 branches missed.">			if (result != null) {</span>
<span class="nc" id="L671">				builder.setRet(Utils.getParamsOrReturn(result));</span>
			}

<span class="nc" id="L674">			final ExecuteImplementationResponse resp = builder.build();</span>

<span class="nc" id="L676">			responseObserver.onNext(resp);</span>
<span class="nc" id="L677">			responseObserver.onCompleted();</span>

<span class="nc" id="L679">		} catch (final Exception e) {</span>
<span class="nc" id="L680">			LOGGER.debug(&quot;executeImplementation DataClay native error&quot;, e);</span>
<span class="nc" id="L681">			final ExecuteImplementationResponse.Builder builder = ExecuteImplementationResponse.newBuilder();</span>
<span class="nc" id="L682">			builder.setExcInfo(Utils.serializeException(e));</span>
<span class="nc" id="L683">			final ExecuteImplementationResponse resp = builder.build();</span>
<span class="nc" id="L684">			responseObserver.onNext(resp);</span>
<span class="nc" id="L685">			responseObserver.onCompleted();</span>
<span class="nc" id="L686">		}</span>
<span class="nc" id="L687">	}</span>


	@Override
	public void synchronize(final DataserviceMessages.SynchronizeRequest request,
									  final io.grpc.stub.StreamObserver&lt;CommonMessages.ExceptionInfo&gt; responseObserver) {
		try {

<span class="nc" id="L695">			SerializedParametersOrReturn params = null;</span>
<span class="nc bnc" id="L696" title="All 2 branches missed.">			if (request.hasParams()) {</span>
<span class="nc" id="L697">				params = Utils.getParamsOrReturn(request.getParams());</span>
			}

<span class="nc" id="L700">			final ObjectID objectID = Utils.getObjectID(request.getObjectID());</span>
<span class="nc" id="L701">			final ImplementationID implID = Utils.getImplementationID(request.getImplementationID());</span>
<span class="nc" id="L702">			final ExecutionEnvironmentID callingBackendID = Utils.getExecutionEnvironmentID(request.getCallingBackendID());</span>
<span class="nc" id="L703">			dataService.synchronize(Utils.getSessionID(request.getSessionID()), objectID, implID, params,</span>
					callingBackendID);
<span class="nc" id="L705">			Utils.returnExceptionInfoMessage(responseObserver);</span>
<span class="nc" id="L706">			responseObserver.onCompleted();</span>

<span class="nc" id="L708">		} catch (final Exception e) {</span>
<span class="nc" id="L709">			final ExceptionInfo resp = Utils.serializeException(e);</span>
<span class="nc" id="L710">			responseObserver.onNext(resp);</span>
<span class="nc" id="L711">			responseObserver.onCompleted();</span>
<span class="nc" id="L712">		}</span>
<span class="nc" id="L713">	}</span>

	@Override
	public void closeSessionInDS(final CloseSessionInDSRequest request,
			final io.grpc.stub.StreamObserver&lt;CommonMessages.ExceptionInfo&gt; responseObserver) {

		try {
<span class="nc" id="L720">			dataService.closeSessionInDS(Utils.getSessionID(request.getSessionID()));</span>
<span class="nc" id="L721">			Utils.returnExceptionInfoMessage(responseObserver);</span>
<span class="nc" id="L722">			responseObserver.onCompleted();</span>

<span class="nc" id="L724">		} catch (final Exception e) {</span>
<span class="nc" id="L725">			final ExceptionInfo resp = Utils.serializeException(e);</span>
<span class="nc" id="L726">			responseObserver.onNext(resp);</span>
<span class="nc" id="L727">			responseObserver.onCompleted();</span>
<span class="nc" id="L728">		}</span>
<span class="nc" id="L729">	}</span>

	@Override
	public void updateRefs(
			final es.bsc.dataclay.communication.grpc.messages.dataservice.DataserviceMessages.UpdateRefsRequest request,
			final io.grpc.stub.StreamObserver&lt;es.bsc.dataclay.communication.grpc.messages.common.CommonMessages.ExceptionInfo&gt; responseObserver) {
		try {
<span class="nc" id="L736">			final Map&lt;ObjectID, Integer&gt; updateRefs = new ConcurrentHashMap&lt;&gt;();</span>
<span class="nc bnc" id="L737" title="All 2 branches missed.">			if (request.getRefsToUpdateCount() &gt; 0) {</span>
<span class="nc bnc" id="L738" title="All 2 branches missed.">				for (final Entry&lt;String, Integer&gt; curEntry : request.getRefsToUpdateMap().entrySet()) {</span>
<span class="nc" id="L739">					updateRefs.put(Utils.getObjectID(curEntry.getKey()), curEntry.getValue());</span>
<span class="nc" id="L740">				}</span>
			}
<span class="nc" id="L742">			dataService.updateRefs(updateRefs);</span>
<span class="nc" id="L743">			Utils.returnExceptionInfoMessage(responseObserver);</span>
<span class="nc" id="L744">			responseObserver.onCompleted();</span>

<span class="nc" id="L746">		} catch (final Exception e) {</span>
<span class="nc" id="L747">			final ExceptionInfo resp = Utils.serializeException(e);</span>
<span class="nc" id="L748">			responseObserver.onNext(resp);</span>
<span class="nc" id="L749">			responseObserver.onCompleted();</span>
<span class="nc" id="L750">		}</span>
<span class="nc" id="L751">	}</span>

	@Override
	public void getRetainedReferences(
			final es.bsc.dataclay.communication.grpc.messages.common.CommonMessages.EmptyMessage request,
			final io.grpc.stub.StreamObserver&lt;es.bsc.dataclay.communication.grpc.messages.dataservice.DataserviceMessages.GetRetainedReferencesResponse&gt; responseObserver) {
		try {
<span class="nc" id="L758">			final Set&lt;ObjectID&gt; result = dataService.getRetainedReferences();</span>

<span class="nc" id="L760">			final GetRetainedReferencesResponse.Builder builder = GetRetainedReferencesResponse.newBuilder();</span>
<span class="nc bnc" id="L761" title="All 2 branches missed.">			for (final ObjectID oid : result) {</span>
<span class="nc" id="L762">				builder.addRetainedReferences(Utils.getMsgID(oid));</span>
<span class="nc" id="L763">			}</span>

<span class="nc" id="L765">			final GetRetainedReferencesResponse resp = builder.build();</span>
<span class="nc" id="L766">			responseObserver.onNext(resp);</span>
<span class="nc" id="L767">			responseObserver.onCompleted();</span>

<span class="nc" id="L769">		} catch (final Exception ex) {</span>
<span class="nc" id="L770">			LOGGER.debug(&quot;getRetainedReferences error&quot;, ex);</span>

<span class="nc" id="L772">			final GetRetainedReferencesResponse.Builder builder = GetRetainedReferencesResponse.newBuilder();</span>
<span class="nc" id="L773">			builder.setExcInfo(Utils.serializeException(ex));</span>
<span class="nc" id="L774">			final GetRetainedReferencesResponse resp = builder.build();</span>
<span class="nc" id="L775">			responseObserver.onNext(resp);</span>
<span class="nc" id="L776">			responseObserver.onCompleted();</span>
<span class="nc" id="L777">		}</span>
<span class="nc" id="L778">	}</span>

	/**
	 * &lt;pre&gt;
	 * Others.
	 * &lt;/pre&gt;
	 */
	@Override
	public void cleanExecutionClassDirectory(final CommonMessages.EmptyMessage request,
			final io.grpc.stub.StreamObserver&lt;CommonMessages.ExceptionInfo&gt; responseObserver) {
		try {
<span class="nc" id="L789">			dataService.cleanExecutionClassDirectory();</span>
<span class="nc" id="L790">			Utils.returnExceptionInfoMessage(responseObserver);</span>
<span class="nc" id="L791">			responseObserver.onCompleted();</span>

<span class="nc" id="L793">		} catch (final Exception e) {</span>
<span class="nc" id="L794">			final ExceptionInfo resp = Utils.serializeException(e);</span>
<span class="nc" id="L795">			responseObserver.onNext(resp);</span>
<span class="nc" id="L796">			responseObserver.onCompleted();</span>
<span class="nc" id="L797">		}</span>
<span class="nc" id="L798">	}</span>

	@Override
	public void closeDbHandler(final CommonMessages.EmptyMessage request,
			final io.grpc.stub.StreamObserver&lt;CommonMessages.ExceptionInfo&gt; responseObserver) {
		try {
<span class="nc" id="L804">			dataService.closeDbHandler();</span>
<span class="nc" id="L805">			Utils.returnExceptionInfoMessage(responseObserver);</span>
<span class="nc" id="L806">			responseObserver.onCompleted();</span>

<span class="nc" id="L808">		} catch (final Exception e) {</span>
<span class="nc" id="L809">			final ExceptionInfo resp = Utils.serializeException(e);</span>
<span class="nc" id="L810">			responseObserver.onNext(resp);</span>
<span class="nc" id="L811">			responseObserver.onCompleted();</span>
<span class="nc" id="L812">		}</span>
<span class="nc" id="L813">	}</span>

	@Override
	public void shutDown(final CommonMessages.EmptyMessage request,
			final io.grpc.stub.StreamObserver&lt;CommonMessages.ExceptionInfo&gt; responseObserver) {
		try {
<span class="nc" id="L819">			dataService.shutDown();</span>
<span class="nc" id="L820">			Utils.returnExceptionInfoMessage(responseObserver);</span>
<span class="nc" id="L821">			responseObserver.onCompleted();</span>

<span class="nc" id="L823">		} catch (final Exception e) {</span>
<span class="nc" id="L824">			final ExceptionInfo resp = Utils.serializeException(e);</span>
<span class="nc" id="L825">			responseObserver.onNext(resp);</span>
<span class="nc" id="L826">			responseObserver.onCompleted();</span>
<span class="nc" id="L827">		}</span>
<span class="nc" id="L828">	}</span>

	@Override
	public void disconnectFromOthers(final CommonMessages.EmptyMessage request,
			final io.grpc.stub.StreamObserver&lt;CommonMessages.ExceptionInfo&gt; responseObserver) {
		try {
<span class="nc" id="L834">			dataService.disconnectFromOthers();</span>
<span class="nc" id="L835">			Utils.returnExceptionInfoMessage(responseObserver);</span>
<span class="nc" id="L836">			responseObserver.onCompleted();</span>

<span class="nc" id="L838">		} catch (final Exception e) {</span>
<span class="nc" id="L839">			final ExceptionInfo resp = Utils.serializeException(e);</span>
<span class="nc" id="L840">			responseObserver.onNext(resp);</span>
<span class="nc" id="L841">			responseObserver.onCompleted();</span>
<span class="nc" id="L842">		}</span>
<span class="nc" id="L843">	}</span>

	/**
	 * &lt;pre&gt;
	 * Paraver.
	 * &lt;/pre&gt;
	 */
	@Override
	public void cleanCaches(final CommonMessages.EmptyMessage request,
			final io.grpc.stub.StreamObserver&lt;CommonMessages.ExceptionInfo&gt; responseObserver) {
		try {
<span class="nc" id="L854">			dataService.cleanCaches();</span>
<span class="nc" id="L855">			Utils.returnExceptionInfoMessage(responseObserver);</span>
<span class="nc" id="L856">			responseObserver.onCompleted();</span>

<span class="nc" id="L858">		} catch (final Exception e) {</span>
<span class="nc" id="L859">			final ExceptionInfo resp = Utils.serializeException(e);</span>
<span class="nc" id="L860">			responseObserver.onNext(resp);</span>
<span class="nc" id="L861">			responseObserver.onCompleted();</span>
<span class="nc" id="L862">		}</span>
<span class="nc" id="L863">	}</span>

	@Override
	public void activateTracing(final ActivateTracingRequest request,
			final io.grpc.stub.StreamObserver&lt;CommonMessages.ExceptionInfo&gt; responseObserver) {

<span class="nc" id="L869">		final int currentAvailableTaskID = request.getTaskid();</span>
		try {
<span class="nc" id="L871">			dataService.activateTracing(currentAvailableTaskID);</span>
<span class="nc" id="L872">			Utils.returnExceptionInfoMessage(responseObserver);</span>
<span class="nc" id="L873">			responseObserver.onCompleted();</span>
<span class="nc" id="L874">		} catch (final Exception e) {</span>
<span class="nc" id="L875">			final ExceptionInfo resp = Utils.serializeException(e);</span>
<span class="nc" id="L876">			responseObserver.onNext(resp);</span>
<span class="nc" id="L877">			responseObserver.onCompleted();</span>
<span class="nc" id="L878">		}</span>
<span class="nc" id="L879">	}</span>

	@Override
	public void deactivateTracing(final CommonMessages.EmptyMessage request,
			final io.grpc.stub.StreamObserver&lt;CommonMessages.ExceptionInfo&gt; responseObserver) {
		try {
<span class="nc" id="L885">			dataService.deactivateTracing();</span>
<span class="nc" id="L886">			Utils.returnExceptionInfoMessage(responseObserver);</span>
<span class="nc" id="L887">			responseObserver.onCompleted();</span>
<span class="nc" id="L888">		} catch (final Exception e) {</span>
<span class="nc" id="L889">			final ExceptionInfo resp = Utils.serializeException(e);</span>
<span class="nc" id="L890">			responseObserver.onNext(resp);</span>
<span class="nc" id="L891">			responseObserver.onCompleted();</span>
<span class="nc" id="L892">		}</span>
<span class="nc" id="L893">	}</span>
	
	@Override
	public void getTraces(final EmptyMessage request, final StreamObserver&lt;GetTracesResponse&gt; responseObserver) {
		try {
<span class="nc" id="L898">			final Map&lt;String, byte[]&gt; traces = dataService.getTraces();</span>
<span class="nc" id="L899">			final GetTracesResponse.Builder builder = GetTracesResponse.newBuilder();</span>
<span class="nc bnc" id="L900" title="All 2 branches missed.">			for (final Entry&lt;String, byte[]&gt; entry : traces.entrySet()) {</span>
<span class="nc" id="L901">				builder.putTraces(entry.getKey(), ByteString.copyFrom(entry.getValue()));</span>
<span class="nc" id="L902">			}</span>

<span class="nc" id="L904">			final GetTracesResponse resp = builder.build();</span>
<span class="nc" id="L905">			responseObserver.onNext(resp);</span>
<span class="nc" id="L906">			responseObserver.onCompleted();</span>

<span class="nc" id="L908">		} catch (final Exception e) {</span>
<span class="nc" id="L909">			final GetTracesResponse.Builder builder = GetTracesResponse.newBuilder();</span>
<span class="nc" id="L910">			builder.setExcInfo(Utils.serializeException(e));</span>
<span class="nc" id="L911">			final GetTracesResponse resp = builder.build();</span>
<span class="nc" id="L912">			responseObserver.onNext(resp);</span>
<span class="nc" id="L913">			responseObserver.onCompleted();</span>
<span class="nc" id="L914">		}</span>
<span class="nc" id="L915">	}</span>

	@Override
	public void registerPendingObjects(final CommonMessages.EmptyMessage request,
			final io.grpc.stub.StreamObserver&lt;CommonMessages.ExceptionInfo&gt; responseObserver) {

		try {
<span class="nc" id="L922">			dataService.registerPendingObjects();</span>
<span class="nc" id="L923">			Utils.returnExceptionInfoMessage(responseObserver);</span>
<span class="nc" id="L924">			responseObserver.onCompleted();</span>

<span class="nc" id="L926">		} catch (final Exception e) {</span>
<span class="nc" id="L927">			final ExceptionInfo resp = Utils.serializeException(e);</span>
<span class="nc" id="L928">			responseObserver.onNext(resp);</span>
<span class="nc" id="L929">			responseObserver.onCompleted();</span>
<span class="nc" id="L930">		}</span>
<span class="nc" id="L931">	}</span>
	
	@Override
	public void exists(final DataserviceMessages.ExistsRequest request,
			final io.grpc.stub.StreamObserver&lt;DataserviceMessages.ExistsResponse&gt; responseObserver) {
		try {
<span class="nc" id="L937">			final ObjectID objectID = Utils.getObjectID(request.getObjectID());</span>
<span class="nc" id="L938">			final boolean result = dataService.exists(objectID);</span>
<span class="nc" id="L939">			final DataserviceMessages.ExistsResponse.Builder builder = DataserviceMessages.ExistsResponse.newBuilder();</span>
<span class="nc" id="L940">			builder.setExists(result);</span>
<span class="nc" id="L941">			final DataserviceMessages.ExistsResponse resp = builder.build();</span>
<span class="nc" id="L942">			responseObserver.onNext(resp);</span>
<span class="nc" id="L943">			responseObserver.onCompleted();</span>
<span class="nc" id="L944">		} catch (final Exception e) {</span>
<span class="nc" id="L945">			final DataserviceMessages.ExistsResponse.Builder builder = DataserviceMessages.ExistsResponse.newBuilder();</span>
<span class="nc" id="L946">			builder.setExcInfo(Utils.serializeException(e));</span>
<span class="nc" id="L947">			final DataserviceMessages.ExistsResponse resp = builder.build();</span>
<span class="nc" id="L948">			responseObserver.onNext(resp);</span>
<span class="nc" id="L949">			responseObserver.onCompleted();</span>
<span class="nc" id="L950">		}</span>
<span class="nc" id="L951">	}</span>
	
	@Override
	public void existsInDB(final DataserviceMessages.ExistsInDBRequest request,
			final io.grpc.stub.StreamObserver&lt;DataserviceMessages.ExistsInDBResponse&gt; responseObserver) {
		try {
<span class="nc" id="L957">			final ObjectID objectID = Utils.getObjectID(request.getObjectID());</span>

<span class="nc" id="L959">			final boolean result = dataService.existsInDB(objectID);</span>
			
<span class="nc" id="L961">			final DataserviceMessages.ExistsInDBResponse.Builder builder = DataserviceMessages.ExistsInDBResponse.newBuilder();</span>
<span class="nc" id="L962">			builder.setExists(result);</span>
<span class="nc" id="L963">			final DataserviceMessages.ExistsInDBResponse resp = builder.build();</span>
<span class="nc" id="L964">			responseObserver.onNext(resp);</span>
<span class="nc" id="L965">			responseObserver.onCompleted();</span>

<span class="nc" id="L967">		} catch (final Exception e) {</span>
<span class="nc" id="L968">			final DataserviceMessages.ExistsInDBResponse.Builder builder = DataserviceMessages.ExistsInDBResponse.newBuilder();</span>
<span class="nc" id="L969">			builder.setExcInfo(Utils.serializeException(e));</span>
<span class="nc" id="L970">			final DataserviceMessages.ExistsInDBResponse resp = builder.build();</span>
<span class="nc" id="L971">			responseObserver.onNext(resp);</span>
<span class="nc" id="L972">			responseObserver.onCompleted();</span>
<span class="nc" id="L973">		}</span>
<span class="nc" id="L974">	}</span>

	@Override
	public void getNumObjects(final EmptyMessage request,
					   final io.grpc.stub.StreamObserver&lt;CommonMessages.GetNumObjectsResponse&gt; responseObserver) {
		try {
<span class="nc" id="L980">			final int result = dataService.getNumObjects();</span>
<span class="nc" id="L981">			final CommonMessages.GetNumObjectsResponse.Builder builder = CommonMessages.GetNumObjectsResponse.newBuilder();</span>
<span class="nc" id="L982">			builder.setNumObjs(result);</span>
<span class="nc" id="L983">			final CommonMessages.GetNumObjectsResponse resp = builder.build();</span>
<span class="nc" id="L984">			responseObserver.onNext(resp);</span>
<span class="nc" id="L985">			responseObserver.onCompleted();</span>
<span class="nc" id="L986">		} catch (final Exception e) {</span>
<span class="nc" id="L987">			final CommonMessages.GetNumObjectsResponse.Builder builder = CommonMessages.GetNumObjectsResponse.newBuilder();</span>
<span class="nc" id="L988">			builder.setExcInfo(Utils.serializeException(e));</span>
<span class="nc" id="L989">			final CommonMessages.GetNumObjectsResponse resp = builder.build();</span>
<span class="nc" id="L990">			responseObserver.onNext(resp);</span>
<span class="nc" id="L991">			responseObserver.onCompleted();</span>
<span class="nc" id="L992">		}</span>
<span class="nc" id="L993">	}</span>

	@Override
	public void getNumObjectsInEE(final EmptyMessage request,
							  final io.grpc.stub.StreamObserver&lt;CommonMessages.GetNumObjectsResponse&gt; responseObserver) {
		try {
<span class="nc" id="L999">			final int result = dataService.getNumObjectsInEE();</span>
<span class="nc" id="L1000">			final CommonMessages.GetNumObjectsResponse.Builder builder = CommonMessages.GetNumObjectsResponse.newBuilder();</span>
<span class="nc" id="L1001">			builder.setNumObjs(result);</span>
<span class="nc" id="L1002">			final CommonMessages.GetNumObjectsResponse resp = builder.build();</span>
<span class="nc" id="L1003">			responseObserver.onNext(resp);</span>
<span class="nc" id="L1004">			responseObserver.onCompleted();</span>
<span class="nc" id="L1005">		} catch (final Exception e) {</span>
<span class="nc" id="L1006">			final CommonMessages.GetNumObjectsResponse.Builder builder = CommonMessages.GetNumObjectsResponse.newBuilder();</span>
<span class="nc" id="L1007">			builder.setExcInfo(Utils.serializeException(e));</span>
<span class="nc" id="L1008">			final CommonMessages.GetNumObjectsResponse resp = builder.build();</span>
<span class="nc" id="L1009">			responseObserver.onNext(resp);</span>
<span class="nc" id="L1010">			responseObserver.onCompleted();</span>
<span class="nc" id="L1011">		}</span>
<span class="nc" id="L1012">	}</span>

	@Override
	public void storeToDB(final DataserviceMessages.StoreToDBRequest request,
			final io.grpc.stub.StreamObserver&lt;CommonMessages.ExceptionInfo&gt; responseObserver) {
		try {
<span class="nc" id="L1018">			final ExecutionEnvironmentID eeID = Utils.getExecutionEnvironmentID(request.getExecutionEnvironmentID());</span>
<span class="nc" id="L1019">			final ObjectID objectID = Utils.getObjectID(request.getObjectID());</span>
<span class="nc" id="L1020">			final byte[] bytes = request.getObjBytes().toByteArray();</span>

<span class="nc" id="L1022">			dataService.store(eeID, objectID, bytes);</span>
<span class="nc" id="L1023">			Utils.returnExceptionInfoMessage(responseObserver);</span>
<span class="nc" id="L1024">			responseObserver.onCompleted();</span>

<span class="nc" id="L1026">		} catch (final Exception e) {</span>
<span class="nc" id="L1027">			final ExceptionInfo resp = Utils.serializeException(e);</span>
<span class="nc" id="L1028">			responseObserver.onNext(resp);</span>
<span class="nc" id="L1029">			responseObserver.onCompleted();</span>
<span class="nc" id="L1030">		}</span>
<span class="nc" id="L1031">	}</span>

	@Override
	public void getFromDB(final DataserviceMessages.GetFromDBRequest request,
			final io.grpc.stub.StreamObserver&lt;DataserviceMessages.GetFromDBResponse&gt; responseObserver) {
		try {
<span class="nc" id="L1037">			final ObjectID objectID = Utils.getObjectID(request.getObjectID());</span>
<span class="nc" id="L1038">			final ExecutionEnvironmentID eeID = Utils.getExecutionEnvironmentID(request.getExecutionEnvironmentID());</span>

<span class="nc" id="L1040">			final byte[] getResult = dataService.get(eeID, objectID);</span>
<span class="nc" id="L1041">			final ByteString result = ByteString.copyFrom(getResult);</span>

<span class="nc" id="L1043">			final GetFromDBResponse.Builder builder = GetFromDBResponse.newBuilder();</span>
<span class="nc bnc" id="L1044" title="All 2 branches missed.">			if (result != null) {</span>
<span class="nc" id="L1045">				builder.setObjBytes((result));</span>
			}

<span class="nc" id="L1048">			final GetFromDBResponse resp = builder.build();</span>

<span class="nc" id="L1050">			responseObserver.onNext(resp);</span>
<span class="nc" id="L1051">			responseObserver.onCompleted();</span>

<span class="nc" id="L1053">		} catch (final Exception e) {</span>
<span class="nc" id="L1054">			final GetFromDBResponse.Builder builder = GetFromDBResponse.newBuilder();</span>
<span class="nc" id="L1055">			builder.setExcInfo(Utils.serializeException(e));</span>
<span class="nc" id="L1056">			final GetFromDBResponse resp = builder.build();</span>
<span class="nc" id="L1057">			responseObserver.onNext(resp);</span>
<span class="nc" id="L1058">			responseObserver.onCompleted();</span>
<span class="nc" id="L1059">		}</span>
<span class="nc" id="L1060">	}</span>

	@Override
	public void updateToDB(final DataserviceMessages.UpdateToDBRequest request,
			final io.grpc.stub.StreamObserver&lt;CommonMessages.ExceptionInfo&gt; responseObserver) {
		try {
<span class="nc" id="L1066">			final ExecutionEnvironmentID eeID = Utils.getExecutionEnvironmentID(request.getExecutionEnvironmentID());</span>
<span class="nc" id="L1067">			final ObjectID objectID = Utils.getObjectID(request.getObjectID());</span>
<span class="nc" id="L1068">			final byte[] bytes = request.getObjBytes().toByteArray();</span>
<span class="nc" id="L1069">			final boolean dirty = request.getDirty();</span>
<span class="nc" id="L1070">			dataService.update(eeID, objectID, bytes, dirty);</span>
<span class="nc" id="L1071">			Utils.returnExceptionInfoMessage(responseObserver);</span>
<span class="nc" id="L1072">			responseObserver.onCompleted();</span>

<span class="nc" id="L1074">		} catch (final Exception e) {</span>
<span class="nc" id="L1075">			final ExceptionInfo resp = Utils.serializeException(e);</span>
<span class="nc" id="L1076">			responseObserver.onNext(resp);</span>
<span class="nc" id="L1077">			responseObserver.onCompleted();</span>
<span class="nc" id="L1078">		}</span>
<span class="nc" id="L1079">	}</span>

	@Override
	public void deleteToDB(final DataserviceMessages.DeleteToDBRequest request,
			final io.grpc.stub.StreamObserver&lt;CommonMessages.ExceptionInfo&gt; responseObserver) {
		try {
<span class="nc" id="L1085">			final ExecutionEnvironmentID eeID = Utils.getExecutionEnvironmentID(request.getExecutionEnvironmentID());</span>
<span class="nc" id="L1086">			final ObjectID objectID = Utils.getObjectID(request.getObjectID());</span>

<span class="nc" id="L1088">			dataService.delete(eeID, objectID);</span>
<span class="nc" id="L1089">			Utils.returnExceptionInfoMessage(responseObserver);</span>
<span class="nc" id="L1090">			responseObserver.onCompleted();</span>

<span class="nc" id="L1092">		} catch (final Exception e) {</span>
<span class="nc" id="L1093">			final ExceptionInfo resp = Utils.serializeException(e);</span>
<span class="nc" id="L1094">			responseObserver.onNext(resp);</span>
<span class="nc" id="L1095">			responseObserver.onCompleted();</span>
<span class="nc" id="L1096">		}</span>
<span class="nc" id="L1097">	}</span>

	@Override
	public void associateExecutionEnvironment(final DataserviceMessages.AssociateExecutionEnvironmentRequest request,
			final io.grpc.stub.StreamObserver&lt;CommonMessages.ExceptionInfo&gt; responseObserver) {
		try {
<span class="nc" id="L1103">			dataService.associateExecutionEnvironment(Utils.getExecutionEnvironmentID(request.getExecutionEnvironmentID()));</span>
<span class="nc" id="L1104">			Utils.returnExceptionInfoMessage(responseObserver);</span>
<span class="nc" id="L1105">			responseObserver.onCompleted();</span>

<span class="nc" id="L1107">		} catch (final Exception e) {</span>
<span class="nc" id="L1108">			final ExceptionInfo resp = Utils.serializeException(e);</span>
<span class="nc" id="L1109">			responseObserver.onNext(resp);</span>
<span class="nc" id="L1110">			responseObserver.onCompleted();</span>
<span class="nc" id="L1111">		}</span>
<span class="nc" id="L1112">	}</span>

	@Override
	public void detachObjectFromSession(final DataserviceMessages.DetachObjectFromSessionRequest request,
											  final io.grpc.stub.StreamObserver&lt;CommonMessages.ExceptionInfo&gt; responseObserver) {
		try {
<span class="nc" id="L1118">			dataService.detachObjectFromSession(Utils.getObjectID(request.getObjectID()),</span>
<span class="nc" id="L1119">					Utils.getSessionID(request.getSessionID()));</span>
<span class="nc" id="L1120">			Utils.returnExceptionInfoMessage(responseObserver);</span>
<span class="nc" id="L1121">			responseObserver.onCompleted();</span>

<span class="nc" id="L1123">		} catch (final Exception e) {</span>
<span class="nc" id="L1124">			final ExceptionInfo resp = Utils.serializeException(e);</span>
<span class="nc" id="L1125">			responseObserver.onNext(resp);</span>
<span class="nc" id="L1126">			responseObserver.onCompleted();</span>
<span class="nc" id="L1127">		}</span>
<span class="nc" id="L1128">	}</span>

	@Override
	public void deleteAlias(final DataserviceMessages.DeleteAliasRequest request,
										final io.grpc.stub.StreamObserver&lt;CommonMessages.ExceptionInfo&gt; responseObserver) {
		try {
<span class="nc" id="L1134">			dataService.deleteAlias(Utils.getSessionID(request.getSessionID()),</span>
<span class="nc" id="L1135">					Utils.getObjectID(request.getObjectID()));</span>
<span class="nc" id="L1136">			Utils.returnExceptionInfoMessage(responseObserver);</span>
<span class="nc" id="L1137">			responseObserver.onCompleted();</span>

<span class="nc" id="L1139">		} catch (final Exception e) {</span>
<span class="nc" id="L1140">			final ExceptionInfo resp = Utils.serializeException(e);</span>
<span class="nc" id="L1141">			responseObserver.onNext(resp);</span>
<span class="nc" id="L1142">			responseObserver.onCompleted();</span>
<span class="nc" id="L1143">		}</span>
<span class="nc" id="L1144">	}</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.6.202009150832</span></div></body></html>