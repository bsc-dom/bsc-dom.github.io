<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ClassManagerDB.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">dataclay</a> &gt; <a href="index.source.html" class="el_package">es.bsc.dataclay.logic.classmgr</a> &gt; <span class="el_source">ClassManagerDB.java</span></div><h1>ClassManagerDB.java</h1><pre class="source lang-java linenums">
package es.bsc.dataclay.logic.classmgr;

import java.sql.Array;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.HashSet;
import java.util.Iterator;
import java.util.List;
import java.util.Map;
import java.util.Map.Entry;
import java.util.Set;
import java.util.SortedSet;
import java.util.TreeSet;
import java.util.UUID;

import org.apache.commons.dbcp2.BasicDataSource;
import org.apache.logging.log4j.LogManager;
import org.apache.logging.log4j.Logger;

import es.bsc.dataclay.communication.grpc.messages.common.CommonMessages.Langs;
import es.bsc.dataclay.exceptions.dbhandler.DbObjectNotExistException;
import es.bsc.dataclay.util.Configuration;
import es.bsc.dataclay.util.ids.AccountID;
import es.bsc.dataclay.util.ids.ImplementationID;
import es.bsc.dataclay.util.ids.MetaClassID;
import es.bsc.dataclay.util.ids.NamespaceID;
import es.bsc.dataclay.util.ids.OperationID;
import es.bsc.dataclay.util.ids.PropertyID;
import es.bsc.dataclay.util.management.classmgr.AccessedImplementation;
import es.bsc.dataclay.util.management.classmgr.AccessedProperty;
import es.bsc.dataclay.util.management.classmgr.Annotation;
import es.bsc.dataclay.util.management.classmgr.Implementation;
import es.bsc.dataclay.util.management.classmgr.LanguageDependantClassInfo;
import es.bsc.dataclay.util.management.classmgr.LanguageDependantOperationInfo;
import es.bsc.dataclay.util.management.classmgr.LanguageDependantPropertyInfo;
import es.bsc.dataclay.util.management.classmgr.LanguageDependantTypeInfo;
import es.bsc.dataclay.util.management.classmgr.MetaClass;
import es.bsc.dataclay.util.management.classmgr.Operation;
import es.bsc.dataclay.util.management.classmgr.PrefetchingInformation;
import es.bsc.dataclay.util.management.classmgr.Property;
import es.bsc.dataclay.util.management.classmgr.Type;
import es.bsc.dataclay.util.management.classmgr.UserType;
import es.bsc.dataclay.util.management.classmgr.features.ArchitectureFeature;
import es.bsc.dataclay.util.management.classmgr.features.CPUFeature;
import es.bsc.dataclay.util.management.classmgr.features.Feature;
import es.bsc.dataclay.util.management.classmgr.features.LanguageFeature;
import es.bsc.dataclay.util.management.classmgr.features.MemoryFeature;
import es.bsc.dataclay.util.management.classmgr.features.QualitativeFeature;
import es.bsc.dataclay.util.management.classmgr.features.QuantitativeFeature;
import es.bsc.dataclay.util.management.classmgr.features.Feature.FeatureType;
import es.bsc.dataclay.util.management.classmgr.java.JavaClassInfo;
import es.bsc.dataclay.util.management.classmgr.java.JavaImplementation;
import es.bsc.dataclay.util.management.classmgr.java.JavaOperationInfo;
import es.bsc.dataclay.util.management.classmgr.java.JavaPropertyInfo;
import es.bsc.dataclay.util.management.classmgr.java.JavaTypeInfo;
import es.bsc.dataclay.util.management.classmgr.python.PythonClassInfo;
import es.bsc.dataclay.util.management.classmgr.python.PythonImplementation;
import es.bsc.dataclay.util.management.classmgr.python.PythonOperationInfo;
import es.bsc.dataclay.util.management.classmgr.python.PythonPropertyInfo;
import es.bsc.dataclay.util.management.classmgr.python.PythonTypeInfo;
import es.bsc.dataclay.dbhandler.sql.sqlite.SQLiteDataSource;

/**
 * Class manager data base.
 */
public final class ClassManagerDB {

	/** Logger. */
<span class="fc" id="L74">	private static final Logger logger = LogManager.getLogger(&quot;managers.ClassManager.DB&quot;);</span>

	/** Indicates if debug is enabled. */
<span class="fc" id="L77">	private static final boolean DEBUG_ENABLED = Configuration.isDebugEnabled();</span>

	/** DataSource. */
	private final SQLiteDataSource dataSource;

	/**
	 * ClassManagerDB constructor.
	 * 
	 * @param dataSource
	 *            Name of the LM service managing.
	 */
<span class="fc" id="L88">	public ClassManagerDB(final SQLiteDataSource dataSource) {</span>
<span class="fc" id="L89">		this.dataSource = dataSource;</span>
<span class="fc" id="L90">	}</span>

	/**
	 * Create tables.
	 */
	public void createTables() {
<span class="fc" id="L96">		synchronized (dataSource) {</span>
<span class="fc" id="L97">			Connection conn = null;</span>
			try {
<span class="fc" id="L99">				conn = dataSource.getConnection();</span>
<span class="fc bfc" id="L100" title="All 2 branches covered.">				for (final ClassManagerSQLStatements.SqlStatements stmt : ClassManagerSQLStatements.SqlStatements.values()) {</span>
<span class="pc bpc" id="L101" title="1 of 2 branches missed.">					if (stmt.name().startsWith(&quot;CREATE_TYPE&quot;)) {</span>
						try {
<span class="nc" id="L103">							final PreparedStatement createStmt = conn.prepareStatement(stmt.getSqlStatement());</span>
<span class="nc bnc" id="L104" title="All 2 branches missed.">							if (DEBUG_ENABLED) {</span>
<span class="nc" id="L105">								logger.debug(&quot;[==DB==] Executing &quot; + createStmt);</span>
							}
<span class="nc" id="L107">							createStmt.execute();</span>
<span class="nc" id="L108">							createStmt.close();</span>
<span class="nc" id="L109">						} catch (final SQLException e) {</span>
							// ignore if already exists
<span class="nc" id="L111">						}</span>
					}
				}
<span class="nc" id="L114">			} catch (final SQLException e1) {</span>
<span class="nc" id="L115">				logger.debug(&quot;SQL Exception in createTables (first step)&quot;, e1);</span>
			} finally {
				try {
<span class="pc bpc" id="L118" title="1 of 2 branches missed.">					if (conn != null) {</span>
<span class="fc" id="L119">						conn.close();</span>
					}
<span class="nc" id="L121">				} catch (final SQLException ex1) {</span>
<span class="nc" id="L122">					logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="fc" id="L123">				}</span>
			}

<span class="fc" id="L126">			conn = null;</span>
			try {
<span class="fc" id="L128">				conn = dataSource.getConnection();</span>
<span class="fc bfc" id="L129" title="All 2 branches covered.">				for (final ClassManagerSQLStatements.SqlStatements stmt : ClassManagerSQLStatements.SqlStatements.values()) {</span>
<span class="fc bfc" id="L130" title="All 2 branches covered.">					if (stmt.name().startsWith(&quot;CREATE_TABLE&quot;)) {</span>
<span class="fc" id="L131">						final PreparedStatement updateStatement = conn.prepareStatement(stmt.getSqlStatement());</span>
<span class="pc bpc" id="L132" title="1 of 2 branches missed.">						if (DEBUG_ENABLED) {</span>
<span class="nc" id="L133">							logger.debug(&quot;[==DB==] Executing &quot; + updateStatement);</span>
						}
<span class="fc" id="L135">						updateStatement.execute();</span>
<span class="fc" id="L136">						updateStatement.close();</span>
					}
				}
<span class="nc" id="L139">			} catch (final SQLException e) {</span>
<span class="nc" id="L140">				logger.debug(&quot;SQL Exception in createTables (second step)&quot;, e);</span>
			} finally {
				try {
<span class="pc bpc" id="L143" title="1 of 2 branches missed.">					if (conn != null) {</span>
<span class="fc" id="L144">						conn.close();</span>
					}
<span class="nc" id="L146">				} catch (final SQLException ex1) {</span>
<span class="nc" id="L147">					logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="fc" id="L148">				}</span>
			}
<span class="fc" id="L150">		}</span>
<span class="fc" id="L151">	}</span>

	/**
	 * Delete the tables of MDS. Just the other way around of createTables --much simpler.
	 */
	public void dropTables() {
<span class="fc" id="L157">		synchronized (dataSource) {</span>
<span class="fc" id="L158">			Connection conn = null;</span>
			try {
<span class="fc" id="L160">				conn = dataSource.getConnection();</span>
<span class="fc bfc" id="L161" title="All 2 branches covered.">				for (final ClassManagerSQLStatements.SqlStatements stmt : ClassManagerSQLStatements.SqlStatements.values()) {</span>
<span class="pc bpc" id="L162" title="1 of 2 branches missed.">					if (stmt.name().startsWith(&quot;DROP_TYPE&quot;)) {</span>
<span class="nc" id="L163">						final PreparedStatement updateStatement = conn.prepareStatement(stmt.getSqlStatement());</span>
<span class="nc bnc" id="L164" title="All 2 branches missed.">						if (DEBUG_ENABLED) {</span>
<span class="nc" id="L165">							logger.debug(&quot;[==DB==] Executing &quot; + updateStatement);</span>
						}
<span class="nc" id="L167">						updateStatement.execute();</span>
<span class="nc" id="L168">						updateStatement.close();</span>
					}
				}
<span class="nc" id="L171">			} catch (final SQLException e) {</span>
<span class="nc" id="L172">				logger.debug(&quot;SQL Exception in dropTables (first step)&quot;, e);</span>
			} finally {
				try {
<span class="pc bpc" id="L175" title="1 of 2 branches missed.">					if (conn != null) {</span>
<span class="fc" id="L176">						conn.close();</span>
					}
<span class="nc" id="L178">				} catch (final SQLException ex1) {</span>
<span class="nc" id="L179">					logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="fc" id="L180">				}</span>
			}

<span class="fc" id="L183">			conn = null;</span>
			try {
<span class="fc" id="L185">				conn = dataSource.getConnection();</span>
<span class="fc bfc" id="L186" title="All 2 branches covered.">				for (final ClassManagerSQLStatements.SqlStatements stmt : ClassManagerSQLStatements.SqlStatements.values()) {</span>
<span class="fc bfc" id="L187" title="All 2 branches covered.">					if (stmt.name().startsWith(&quot;DROP_TABLE&quot;)) {</span>
<span class="fc" id="L188">						final PreparedStatement updateStatement = conn.prepareStatement(stmt.getSqlStatement());</span>
<span class="pc bpc" id="L189" title="1 of 2 branches missed.">						if (DEBUG_ENABLED) {</span>
<span class="nc" id="L190">							logger.debug(&quot;[==DB==] Executing &quot; + updateStatement);</span>
						}
<span class="fc" id="L192">						updateStatement.execute();</span>
<span class="fc" id="L193">						updateStatement.close();</span>
					}
				}
<span class="nc" id="L196">			} catch (final SQLException e) {</span>
<span class="nc" id="L197">				logger.debug(&quot;SQL Exception in dropTables (second step)&quot;, e);</span>
			} finally {
				try {
<span class="pc bpc" id="L200" title="1 of 2 branches missed.">					if (conn != null) {</span>
<span class="fc" id="L201">						conn.close();</span>
					}
<span class="nc" id="L203">				} catch (final SQLException ex1) {</span>
<span class="nc" id="L204">					logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="fc" id="L205">				}</span>
			}
<span class="fc" id="L207">		}</span>
<span class="fc" id="L208">	}</span>

	/**
	 * Store accessedImplementation into database
	 * @param accessedImplementation
	 *            accessedImplementation
	 * @return UUID of stored object
	 */
	public UUID storeAccessedImplementation(final AccessedImplementation accessedImplementation) {
<span class="nc" id="L217">		synchronized (dataSource) {</span>
<span class="nc" id="L218">			Connection conn = null;</span>
<span class="nc" id="L219">			final UUID uuid = UUID.randomUUID();</span>
			try {
<span class="nc" id="L221">				conn = dataSource.getConnection();</span>
<span class="nc" id="L222">				final PreparedStatement insertStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.INSERT_ACCESSED_IMPL.getSqlStatement());</span>
<span class="nc" id="L223">				insertStatement.setObject(1, uuid);</span>
				// CHECKSTYLE:OFF
<span class="nc" id="L225">				insertStatement.setString(2, accessedImplementation.getNamespace());</span>
<span class="nc" id="L226">				insertStatement.setString(3, accessedImplementation.getClassName());</span>
<span class="nc" id="L227">				insertStatement.setString(4, accessedImplementation.getOpSignature());</span>
<span class="nc" id="L228">				insertStatement.setInt(5, accessedImplementation.getImplPosition());</span>
<span class="nc" id="L229">				insertStatement.setObject(6, accessedImplementation.getImplementationID().getId());</span>
				// CHECKSTYLE:ON
<span class="nc bnc" id="L231" title="All 2 branches missed.">				if (DEBUG_ENABLED) {</span>
<span class="nc" id="L232">					logger.debug(&quot;[==DB==] Executing &quot; + insertStatement);</span>
				}
<span class="nc" id="L234">				insertStatement.executeUpdate();</span>
<span class="nc" id="L235">				insertStatement.close();</span>
<span class="nc" id="L236">			} catch (final Exception e) {</span>
<span class="nc" id="L237">				logger.debug(&quot;SQL Exception in storeAccessedImplementation&quot;, e);</span>
			} finally {
				try {
<span class="nc bnc" id="L240" title="All 2 branches missed.">					if (conn != null) {</span>
<span class="nc" id="L241">						conn.close();</span>
					}
<span class="nc" id="L243">				} catch (final SQLException ex1) {</span>
<span class="nc" id="L244">					logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L245">				}</span>
			}
<span class="nc" id="L247">			return uuid;</span>
		}
	}

	/**
	 * Store accessedProperty into database
	 * @param accessedProperty
	 *            accessedProperty
	 * @return UUID of stored object
	 */
	public UUID storeAccessedProperty(final AccessedProperty accessedProperty) {
<span class="fc" id="L258">		synchronized (dataSource) {</span>
<span class="fc" id="L259">			Connection conn = null;</span>
<span class="fc" id="L260">			final UUID uuid = UUID.randomUUID();</span>
			try {
<span class="fc" id="L262">				conn = dataSource.getConnection();</span>
<span class="fc" id="L263">				final PreparedStatement insertStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.INSERT_ACCESSED_PROP.getSqlStatement());</span>
<span class="fc" id="L264">				insertStatement.setObject(1, uuid);</span>
				// CHECKSTYLE:OFF
<span class="fc" id="L266">				insertStatement.setString(2, accessedProperty.getNamespace());</span>
<span class="fc" id="L267">				insertStatement.setString(3, accessedProperty.getClassName());</span>
<span class="fc" id="L268">				insertStatement.setString(4, accessedProperty.getName());</span>
<span class="fc" id="L269">				insertStatement.setObject(5, accessedProperty.getPropertyID().getId());</span>
				// CHECKSTYLE:ON
<span class="pc bpc" id="L271" title="1 of 2 branches missed.">				if (DEBUG_ENABLED) {</span>
<span class="nc" id="L272">					logger.debug(&quot;[==DB==] Executing &quot; + insertStatement);</span>
				}
<span class="fc" id="L274">				insertStatement.executeUpdate();</span>
<span class="fc" id="L275">				insertStatement.close();</span>
<span class="nc" id="L276">			} catch (final Exception e) {</span>
<span class="nc" id="L277">				logger.debug(&quot;SQL Exception in storeAccessedProperty&quot;, e);</span>
			} finally {
				try {
<span class="pc bpc" id="L280" title="1 of 2 branches missed.">					if (conn != null) {</span>
<span class="fc" id="L281">						conn.close();</span>
					}
<span class="nc" id="L283">				} catch (final SQLException ex1) {</span>
<span class="nc" id="L284">					logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="fc" id="L285">				}</span>
			}
<span class="fc" id="L287">			return uuid;</span>
		}

	}

	/**
	 * Store type into database
	 * @param type
	 *            type
	 * @return UUID of stored object
	 */
	public UUID storeType(final Type type) {
<span class="fc" id="L299">		synchronized (dataSource) {</span>
<span class="fc" id="L300">			Connection conn = null;</span>
<span class="fc" id="L301">			final UUID uuid = UUID.randomUUID();</span>
			try {
<span class="fc" id="L303">				UUID[] includesArray = null;</span>
<span class="pc bpc" id="L304" title="1 of 2 branches missed.">				if (type.getIncludes() != null) {</span>
<span class="nc" id="L305">					includesArray = new UUID[type.getIncludes().size()];</span>
<span class="nc" id="L306">					int j = 0;</span>
<span class="nc bnc" id="L307" title="All 2 branches missed.">					for (final Type include : type.getIncludes()) {</span>
<span class="nc" id="L308">						includesArray[j] = storeType(include);</span>
<span class="nc" id="L309">						j++;</span>
<span class="nc" id="L310">					}</span>
				}

<span class="fc" id="L313">				String[] extensionsTypeArray = null;</span>
<span class="fc" id="L314">				UUID[] extensionsArray = null;</span>
<span class="pc bpc" id="L315" title="1 of 2 branches missed.">				if (type.getLanguageDepInfos() != null) {</span>

<span class="fc" id="L317">					extensionsTypeArray = new String[type.getLanguageDepInfos().size()];</span>
<span class="fc" id="L318">					extensionsArray = new UUID[type.getLanguageDepInfos().size()];</span>
<span class="fc" id="L319">					int i = 0;</span>
<span class="pc bpc" id="L320" title="1 of 2 branches missed.">					for (final Entry&lt;Langs, LanguageDependantTypeInfo&gt; entry : type.getLanguageDepInfos().entrySet()) {</span>
<span class="nc" id="L321">						extensionsTypeArray[i] = entry.getKey().name();</span>
<span class="nc bnc" id="L322" title="All 2 branches missed.">						if (entry.getKey().equals(Langs.LANG_JAVA)) {</span>
<span class="nc" id="L323">							extensionsArray[i] = storeJavaTypeInfo((JavaTypeInfo) entry.getValue());</span>
<span class="nc bnc" id="L324" title="All 2 branches missed.">						} else if (entry.getKey().equals(Langs.LANG_PYTHON)) {</span>
<span class="nc" id="L325">							extensionsArray[i] = storePythonTypeInfo((PythonTypeInfo) entry.getValue());</span>
						}
<span class="nc" id="L327">						i++;</span>
<span class="nc" id="L328">					}</span>

				}

<span class="fc" id="L332">				conn = dataSource.getConnection();</span>
<span class="fc" id="L333">				final PreparedStatement insertStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.INSERT_TYPE.getSqlStatement());</span>
<span class="fc" id="L334">				insertStatement.setObject(1, uuid);</span>
				// CHECKSTYLE:OFF
<span class="fc" id="L336">				insertStatement.setString(2, type.getDescriptor());</span>
<span class="fc" id="L337">				insertStatement.setString(3, type.getSignature());</span>
<span class="fc" id="L338">				insertStatement.setString(4, type.getTypeName());</span>

<span class="pc bpc" id="L340" title="1 of 2 branches missed.">				if (includesArray != null) {</span>
<span class="nc" id="L341">					final Array tArray = insertStatement.getConnection().createArrayOf(&quot;uuid&quot;, includesArray);</span>
<span class="nc" id="L342">					insertStatement.setArray(5, tArray);</span>
<span class="nc" id="L343">				} else {</span>
<span class="fc" id="L344">					insertStatement.setArray(5, null);</span>
				}

<span class="fc bfc" id="L347" title="All 2 branches covered.">				if (type instanceof UserType) {</span>
<span class="fc" id="L348">					final UserType utype = (UserType) type;</span>
<span class="fc" id="L349">					insertStatement.setString(6, utype.getNamespace());</span>
<span class="fc" id="L350">					insertStatement.setObject(7, utype.getClassID().getId());</span>
<span class="fc" id="L351">				} else {</span>
<span class="fc" id="L352">					insertStatement.setString(6, null);</span>
<span class="fc" id="L353">					insertStatement.setObject(7, null);</span>
				}

<span class="pc bpc" id="L356" title="1 of 2 branches missed.">				if (extensionsTypeArray != null) {</span>
<span class="fc" id="L357">					final Array sqlArray = insertStatement.getConnection().createArrayOf(&quot;varchar&quot;, extensionsTypeArray);</span>
<span class="fc" id="L358">					insertStatement.setArray(8, sqlArray);</span>
<span class="fc" id="L359">				} else {</span>
<span class="nc" id="L360">					insertStatement.setArray(8, null);</span>
				}

<span class="pc bpc" id="L363" title="1 of 2 branches missed.">				if (extensionsArray != null) {</span>
<span class="fc" id="L364">					final Array sqlArray = insertStatement.getConnection().createArrayOf(&quot;uuid&quot;, extensionsArray);</span>
<span class="fc" id="L365">					insertStatement.setArray(9, sqlArray);</span>
<span class="fc" id="L366">				} else {</span>
<span class="nc" id="L367">					insertStatement.setArray(9, null);</span>
				}

				// CHECKSTYLE:ON
<span class="pc bpc" id="L371" title="1 of 2 branches missed.">				if (DEBUG_ENABLED) {</span>
<span class="nc" id="L372">					logger.debug(&quot;[==DB==] Executing &quot; + insertStatement);</span>
				}
<span class="fc" id="L374">				insertStatement.executeUpdate();</span>
<span class="fc" id="L375">				insertStatement.close();</span>

<span class="nc" id="L377">			} catch (final Exception e) {</span>
<span class="nc" id="L378">				logger.debug(&quot;SQL Exception in storeType&quot;, e);</span>
			} finally {
				try {
<span class="pc bpc" id="L381" title="1 of 2 branches missed.">					if (conn != null) {</span>
<span class="fc" id="L382">						conn.close();</span>
					}
<span class="nc" id="L384">				} catch (final SQLException ex1) {</span>
<span class="nc" id="L385">					logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="fc" id="L386">				}</span>
			}
<span class="fc" id="L388">			return uuid;</span>
		}

	}

	/**
	 * Store JavaTypeInfo into database
	 * @param type
	 *            JavaTypeInfo
	 * @return UUID of stored object
	 */
	public UUID storeJavaTypeInfo(final JavaTypeInfo type) {
<span class="nc" id="L400">		synchronized (dataSource) {</span>
<span class="nc" id="L401">			Connection conn = null;</span>
<span class="nc" id="L402">			final UUID uuid = UUID.randomUUID();</span>
			try {

<span class="nc" id="L405">				conn = dataSource.getConnection();</span>
<span class="nc" id="L406">				final PreparedStatement insertStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.INSERT_JAVA_TYPE.getSqlStatement());</span>
<span class="nc" id="L407">				insertStatement.setObject(1, uuid);</span>
				// CHECKSTYLE:OFF
				// CHECKSTYLE:ON
<span class="nc bnc" id="L410" title="All 2 branches missed.">				if (DEBUG_ENABLED) {</span>
<span class="nc" id="L411">					logger.debug(&quot;[==DB==] Executing &quot; + insertStatement);</span>
				}
<span class="nc" id="L413">				insertStatement.executeUpdate();</span>
<span class="nc" id="L414">				insertStatement.close();</span>
<span class="nc" id="L415">			} catch (final Exception e) {</span>
<span class="nc" id="L416">				logger.debug(&quot;SQL Exception in storeJavaTypeInfo&quot;, e);</span>
			} finally {
				try {
<span class="nc bnc" id="L419" title="All 2 branches missed.">					if (conn != null) {</span>
<span class="nc" id="L420">						conn.close();</span>
					}
<span class="nc" id="L422">				} catch (final SQLException ex1) {</span>
<span class="nc" id="L423">					logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L424">				}</span>
			}
<span class="nc" id="L426">			return uuid;</span>
		}
	}

	/**
	 * Store PythonTypeInfo into database
	 * @param type
	 *            PythonTypeInfo
	 * @return UUID of stored object
	 */
	public UUID storePythonTypeInfo(final PythonTypeInfo type) {
<span class="nc" id="L437">		synchronized (dataSource) {</span>
<span class="nc" id="L438">			Connection conn = null;</span>
<span class="nc" id="L439">			final UUID uuid = UUID.randomUUID();</span>
			try {

<span class="nc" id="L442">				conn = dataSource.getConnection();</span>
<span class="nc" id="L443">				final PreparedStatement insertStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.INSERT_PYTHON_TYPE.getSqlStatement());</span>
<span class="nc" id="L444">				insertStatement.setObject(1, uuid);</span>
<span class="nc" id="L445">				insertStatement.setString(2, type.getSignature());</span>
				// CHECKSTYLE:OFF
				// CHECKSTYLE:ON
<span class="nc bnc" id="L448" title="All 2 branches missed.">				if (DEBUG_ENABLED) {</span>
<span class="nc" id="L449">					logger.debug(&quot;[==DB==] Executing &quot; + insertStatement);</span>
				}
<span class="nc" id="L451">				insertStatement.executeUpdate();</span>
<span class="nc" id="L452">				insertStatement.close();</span>
<span class="nc" id="L453">			} catch (final Exception e) {</span>
<span class="nc" id="L454">				logger.debug(&quot;SQL Exception in storePythonTypeInfo&quot;, e);</span>
			} finally {
				try {
<span class="nc bnc" id="L457" title="All 2 branches missed.">					if (conn != null) {</span>
<span class="nc" id="L458">						conn.close();</span>
					}
<span class="nc" id="L460">				} catch (final SQLException ex1) {</span>
<span class="nc" id="L461">					logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L462">				}</span>
			}
<span class="nc" id="L464">			return uuid;</span>
		}
	}

	/**
	 * Store MemoryFeature into database
	 * @param memFeature
	 *            MemoryFeature
	 * @return UUID of stored object
	 */
	public UUID storeMemoryFeature(final MemoryFeature memFeature) {
<span class="nc" id="L475">		synchronized (dataSource) {</span>
<span class="nc" id="L476">			Connection conn = null;</span>
<span class="nc" id="L477">			final UUID uuid = UUID.randomUUID();</span>
			try {
<span class="nc" id="L479">				conn = dataSource.getConnection();</span>
<span class="nc" id="L480">				final PreparedStatement insertStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.INSERT_MEMORY_FEATURE.getSqlStatement());</span>
<span class="nc" id="L481">				insertStatement.setObject(1, uuid);</span>
				// CHECKSTYLE:OFF
<span class="nc" id="L483">				insertStatement.setInt(2, memFeature.getCapacityInMB());</span>
				// CHECKSTYLE:ON
<span class="nc bnc" id="L485" title="All 2 branches missed.">				if (DEBUG_ENABLED) {</span>
<span class="nc" id="L486">					logger.debug(&quot;[==DB==] Executing &quot; + insertStatement);</span>
				}
<span class="nc" id="L488">				insertStatement.executeUpdate();</span>
<span class="nc" id="L489">				insertStatement.close();</span>
<span class="nc" id="L490">			} catch (final Exception e) {</span>
<span class="nc" id="L491">				logger.debug(&quot;SQL Exception in storeMemoryFeature&quot;, e);</span>
			} finally {
				try {
<span class="nc bnc" id="L494" title="All 2 branches missed.">					if (conn != null) {</span>
<span class="nc" id="L495">						conn.close();</span>
					}
<span class="nc" id="L497">				} catch (final SQLException ex1) {</span>
<span class="nc" id="L498">					logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L499">				}</span>
			}
<span class="nc" id="L501">			return uuid;</span>
		}

	}

	/**
	 * Store CPUFeature into database
	 * @param feature
	 *            CPUFeature
	 * @return UUID of stored object
	 */
	public UUID storeCPUFeature(final CPUFeature feature) {
<span class="nc" id="L513">		synchronized (dataSource) {</span>
<span class="nc" id="L514">			Connection conn = null;</span>
<span class="nc" id="L515">			final UUID uuid = UUID.randomUUID();</span>
			try {
<span class="nc" id="L517">				conn = dataSource.getConnection();</span>
<span class="nc" id="L518">				final PreparedStatement insertStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.INSERT_CPU_FEATURE.getSqlStatement());</span>
<span class="nc" id="L519">				insertStatement.setObject(1, uuid);</span>
				// CHECKSTYLE:OFF
<span class="nc" id="L521">				insertStatement.setInt(2, feature.getAmount());</span>
				// CHECKSTYLE:ON
<span class="nc bnc" id="L523" title="All 2 branches missed.">				if (DEBUG_ENABLED) {</span>
<span class="nc" id="L524">					logger.debug(&quot;[==DB==] Executing &quot; + insertStatement);</span>
				}
<span class="nc" id="L526">				insertStatement.executeUpdate();</span>
<span class="nc" id="L527">				insertStatement.close();</span>
<span class="nc" id="L528">			} catch (final Exception e) {</span>
<span class="nc" id="L529">				logger.debug(&quot;SQL Exception in storeCPUFeature&quot;, e);</span>
			} finally {
				try {
<span class="nc bnc" id="L532" title="All 2 branches missed.">					if (conn != null) {</span>
<span class="nc" id="L533">						conn.close();</span>
					}
<span class="nc" id="L535">				} catch (final SQLException ex1) {</span>
<span class="nc" id="L536">					logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L537">				}</span>
			}
<span class="nc" id="L539">			return uuid;</span>
		}

	}

	/**
	 * Store LanguageFeature into database
	 * @param feature
	 *            LanguageFeature
	 * @return UUID of stored object
	 */
	public UUID storeLanguageFeature(final LanguageFeature feature) {
<span class="fc" id="L551">		synchronized (dataSource) {</span>
<span class="fc" id="L552">			Connection conn = null;</span>
<span class="fc" id="L553">			final UUID uuid = UUID.randomUUID();</span>
			try {
<span class="fc" id="L555">				conn = dataSource.getConnection();</span>
<span class="fc" id="L556">				final PreparedStatement insertStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.INSERT_LANGUAGE_FEATURE.getSqlStatement());</span>
<span class="fc" id="L557">				insertStatement.setObject(1, uuid);</span>
				// CHECKSTYLE:OFF
<span class="fc" id="L559">				insertStatement.setString(2, feature.getLanguageName());</span>
<span class="fc" id="L560">				insertStatement.setString(3, feature.getVersion());</span>
				// CHECKSTYLE:ON
<span class="pc bpc" id="L562" title="1 of 2 branches missed.">				if (DEBUG_ENABLED) {</span>
<span class="nc" id="L563">					logger.debug(&quot;[==DB==] Executing &quot; + insertStatement);</span>
				}
<span class="fc" id="L565">				insertStatement.executeUpdate();</span>
<span class="fc" id="L566">				insertStatement.close();</span>
<span class="nc" id="L567">			} catch (final Exception e) {</span>
<span class="nc" id="L568">				logger.debug(&quot;SQL Exception in storeLanguageFeature&quot;, e);</span>
			} finally {
				try {
<span class="pc bpc" id="L571" title="1 of 2 branches missed.">					if (conn != null) {</span>
<span class="fc" id="L572">						conn.close();</span>
					}
<span class="nc" id="L574">				} catch (final SQLException ex1) {</span>
<span class="nc" id="L575">					logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="fc" id="L576">				}</span>
			}
<span class="fc" id="L578">			return uuid;</span>
		}
	}

	/**
	 * Store ArchitectureFeature into database
	 * @param feature
	 *            ArchitectureFeature
	 * @return UUID of stored object
	 */
	public UUID storeArchitectureFeature(final ArchitectureFeature feature) {
<span class="nc" id="L589">		synchronized (dataSource) {</span>
<span class="nc" id="L590">			Connection conn = null;</span>
<span class="nc" id="L591">			final UUID uuid = UUID.randomUUID();</span>
			try {
<span class="nc" id="L593">				conn = dataSource.getConnection();</span>
<span class="nc" id="L594">				final PreparedStatement insertStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.INSERT_ARCH_FEATURE.getSqlStatement());</span>
<span class="nc" id="L595">				insertStatement.setObject(1, uuid);</span>
				// CHECKSTYLE:OFF
<span class="nc" id="L597">				insertStatement.setString(2, feature.getArchitectureName());</span>
				// CHECKSTYLE:ON
<span class="nc bnc" id="L599" title="All 2 branches missed.">				if (DEBUG_ENABLED) {</span>
<span class="nc" id="L600">					logger.debug(&quot;[==DB==] Executing &quot; + insertStatement);</span>
				}
<span class="nc" id="L602">				insertStatement.executeUpdate();</span>
<span class="nc" id="L603">				insertStatement.close();</span>
<span class="nc" id="L604">			} catch (final Exception e) {</span>
<span class="nc" id="L605">				logger.debug(&quot;SQL Exception in storeArchitectureFeature&quot;, e);</span>
			} finally {
				try {
<span class="nc bnc" id="L608" title="All 2 branches missed.">					if (conn != null) {</span>
<span class="nc" id="L609">						conn.close();</span>
					}
<span class="nc" id="L611">				} catch (final SQLException ex1) {</span>
<span class="nc" id="L612">					logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L613">				}</span>
			}
<span class="nc" id="L615">			return uuid;</span>
		}

	}

	/**
	 * Store prefetchingInfo into database
	 * @param prefetchingInfo
	 *            prefetchingInfo
	 * @return UUID of stored object
	 */
	public UUID storePrefecthingInfo(final PrefetchingInformation prefetchingInfo) {
<span class="fc" id="L627">		synchronized (dataSource) {</span>
<span class="fc" id="L628">			Connection conn = null;</span>
<span class="fc" id="L629">			final UUID uuid = UUID.randomUUID();</span>
			try {
<span class="fc" id="L631">				conn = dataSource.getConnection();</span>
<span class="fc" id="L632">				final PreparedStatement insertStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.INSERT_PREFETCHING_INFO.getSqlStatement());</span>
<span class="fc" id="L633">				insertStatement.setObject(1, uuid);</span>
				// CHECKSTYLE:OFF
<span class="fc" id="L635">				insertStatement.setBoolean(2, prefetchingInfo.getDisableDynamicPrefetching());</span>
<span class="fc" id="L636">				insertStatement.setBoolean(3, prefetchingInfo.getInjectPrefetchingCall());</span>
<span class="fc" id="L637">				insertStatement.setString(4, prefetchingInfo.getPrefetchingNameSpace());</span>
<span class="fc" id="L638">				insertStatement.setString(5, prefetchingInfo.getPrefetchingClassName());</span>
<span class="fc" id="L639">				insertStatement.setString(6, prefetchingInfo.getPrefetchingMethodSignature());</span>
<span class="pc bpc" id="L640" title="1 of 2 branches missed.">				if (prefetchingInfo.getPrefetchingImplementationID() != null) {</span>
<span class="nc" id="L641">					insertStatement.setObject(7, prefetchingInfo.getPrefetchingImplementationID().getId());</span>
				} else {
<span class="fc" id="L643">					insertStatement.setObject(7, null);</span>
				}
<span class="pc bpc" id="L645" title="1 of 2 branches missed.">				if (prefetchingInfo.getPrefetchingClassID() != null) {</span>
<span class="nc" id="L646">					insertStatement.setObject(8, prefetchingInfo.getPrefetchingClassID().getId());</span>
				} else {
<span class="fc" id="L648">					insertStatement.setObject(8, null);</span>
				}
<span class="pc bpc" id="L650" title="1 of 2 branches missed.">				if (prefetchingInfo.getPropertiesToPrefetch() != null) {</span>
<span class="fc" id="L651">					final UUID[][] accProps = new UUID[prefetchingInfo.getPropertiesToPrefetch().size()][];</span>
<span class="fc" id="L652">					int i = 0;</span>
<span class="pc bpc" id="L653" title="1 of 2 branches missed.">					for (final List&lt;Property&gt; accPropsList : prefetchingInfo.getPropertiesToPrefetch()) {</span>
<span class="nc" id="L654">						int j = 0;</span>
<span class="nc" id="L655">						accProps[i] = new UUID[accPropsList.size()];</span>
<span class="nc bnc" id="L656" title="All 2 branches missed.">						for (final Property prop : accPropsList) {</span>
<span class="nc" id="L657">							accProps[i][j] = prop.getDataClayID().getId();</span>
<span class="nc" id="L658">							j++;</span>
<span class="nc" id="L659">						}</span>
<span class="nc" id="L660">						i++;</span>
<span class="nc" id="L661">					}</span>

<span class="pc bpc" id="L663" title="1 of 2 branches missed.">					if (accProps.length &gt; 0) {</span>
<span class="nc" id="L664">						final Array sqlArray = insertStatement.getConnection().createArrayOf(&quot;uuid&quot;, accProps);</span>
<span class="nc" id="L665">						insertStatement.setArray(9, sqlArray);</span>
<span class="nc" id="L666">					} else {</span>
<span class="fc" id="L667">						insertStatement.setArray(9, null);</span>
					}
<span class="fc" id="L669">				} else {</span>
<span class="nc" id="L670">					insertStatement.setArray(9, null);</span>
				}

				// CHECKSTYLE:ON
<span class="pc bpc" id="L674" title="1 of 2 branches missed.">				if (DEBUG_ENABLED) {</span>
<span class="nc" id="L675">					logger.debug(&quot;[==DB==] Executing &quot; + insertStatement);</span>
				}
<span class="fc" id="L677">				insertStatement.executeUpdate();</span>
<span class="fc" id="L678">				insertStatement.close();</span>
<span class="nc" id="L679">			} catch (final Exception e) {</span>
<span class="nc" id="L680">				logger.debug(&quot;SQL Exception in storePrefetchingInfo&quot;, e);</span>
			} finally {
				try {
<span class="pc bpc" id="L683" title="1 of 2 branches missed.">					if (conn != null) {</span>
<span class="fc" id="L684">						conn.close();</span>
					}
<span class="nc" id="L686">				} catch (final SQLException ex1) {</span>
<span class="nc" id="L687">					logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="fc" id="L688">				}</span>
			}
<span class="fc" id="L690">			return uuid;</span>
		}
	}

	/**
	 * Store JavaImplementation into database
	 * @param implementation
	 *            implementation
	 * @return UUID of stored object
	 */
	public UUID storeJavaImplementation(final JavaImplementation implementation) {
<span class="fc" id="L701">		synchronized (dataSource) {</span>
<span class="fc" id="L702">			Connection conn = null;</span>
<span class="fc" id="L703">			final UUID uuid = implementation.getDataClayID().getId();</span>
			try {

<span class="fc" id="L706">				final UUID[] includes = new UUID[implementation.getIncludes().size()];</span>
<span class="fc" id="L707">				int i = 0;</span>
<span class="fc bfc" id="L708" title="All 2 branches covered.">				for (final Type include : implementation.getIncludes()) {</span>
<span class="fc" id="L709">					includes[i] = this.storeType(include);</span>
<span class="fc" id="L710">					i++;</span>
<span class="fc" id="L711">				}</span>

<span class="fc" id="L713">				final UUID[] accessedProps = new UUID[implementation.getAccessedProperties().size()];</span>
<span class="fc" id="L714">				i = 0;</span>
<span class="fc bfc" id="L715" title="All 2 branches covered.">				for (final AccessedProperty accProp : implementation.getAccessedProperties()) {</span>
<span class="fc" id="L716">					accessedProps[i] = this.storeAccessedProperty(accProp);</span>
<span class="fc" id="L717">					i++;</span>
<span class="fc" id="L718">				}</span>

<span class="fc" id="L720">				final UUID[] accessedImpls = new UUID[implementation.getAccessedImplementations().size()];</span>
<span class="fc" id="L721">				i = 0;</span>
<span class="pc bpc" id="L722" title="1 of 2 branches missed.">				for (final AccessedImplementation accImpl : implementation.getAccessedImplementations()) {</span>
<span class="nc" id="L723">					accessedImpls[i] = this.storeAccessedImplementation(accImpl);</span>
<span class="nc" id="L724">					i++;</span>
<span class="nc" id="L725">				}</span>

<span class="fc" id="L727">				final String[] featureTypes = new String[implementation.getRequiredQualitativeFeatures().size()</span>
<span class="fc" id="L728">						+ implementation.getRequiredQuantitativeFeatures().size()];</span>
<span class="fc" id="L729">				final UUID[] features = new UUID[featureTypes.length];</span>
<span class="fc" id="L730">				i = 0;</span>
<span class="fc bfc" id="L731" title="All 2 branches covered.">				for (final Entry&lt;FeatureType, QualitativeFeature&gt; entry : implementation.getRequiredQualitativeFeatures().entrySet()) {</span>
<span class="fc" id="L732">					featureTypes[i] = entry.getKey().name();</span>
<span class="pc bpc" id="L733" title="2 of 3 branches missed.">					switch (entry.getKey()) {</span>
						case ARCHITECTURE:
<span class="nc" id="L735">							features[i] = this.storeArchitectureFeature((ArchitectureFeature) entry.getValue());</span>
<span class="nc" id="L736">							break;</span>
						case LANGUAGE:
<span class="fc" id="L738">							features[i] = this.storeLanguageFeature((LanguageFeature) entry.getValue());</span>
<span class="fc" id="L739">							break;</span>
						default:
							break;

					}
<span class="fc" id="L744">					i++;</span>
<span class="fc" id="L745">				}</span>
<span class="pc bpc" id="L746" title="1 of 2 branches missed.">				for (final Entry&lt;FeatureType, QuantitativeFeature&gt; entry : implementation.getRequiredQuantitativeFeatures().entrySet()) {</span>
<span class="nc" id="L747">					featureTypes[i] = entry.getKey().name();</span>
<span class="nc bnc" id="L748" title="All 3 branches missed.">					switch (entry.getKey()) {</span>
						case CPU:
<span class="nc" id="L750">							features[i] = this.storeCPUFeature((CPUFeature) entry.getValue());</span>
<span class="nc" id="L751">							break;</span>
						case MEMORY:
<span class="nc" id="L753">							features[i] = this.storeMemoryFeature((MemoryFeature) entry.getValue());</span>
<span class="nc" id="L754">							break;</span>
						default:
							break;

					}
<span class="nc" id="L759">					i++;</span>
<span class="nc" id="L760">				}</span>

<span class="fc" id="L762">				UUID prefetchingInfoUUID = null;</span>
<span class="fc bfc" id="L763" title="All 2 branches covered.">				if (implementation.getPrefetchingInfo() != null) {</span>
<span class="fc" id="L764">					prefetchingInfoUUID = this.storePrefecthingInfo(implementation.getPrefetchingInfo());</span>
				}

<span class="fc" id="L767">				conn = dataSource.getConnection();</span>
<span class="fc" id="L768">				final PreparedStatement insertStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.INSERT_JAVA_IMPLEMENTATION.getSqlStatement());</span>
<span class="fc" id="L769">				insertStatement.setObject(1, uuid);</span>
				// CHECKSTYLE:OFF
<span class="fc" id="L771">				insertStatement.setString(2, implementation.getResponsibleAccountName());</span>
<span class="fc" id="L772">				insertStatement.setString(3, implementation.getNamespace());</span>
<span class="fc" id="L773">				insertStatement.setString(4, implementation.getClassName());</span>
<span class="fc" id="L774">				insertStatement.setString(5, implementation.getOpNameAndDescriptor());</span>
<span class="fc" id="L775">				insertStatement.setInt(6, implementation.getPosition());</span>

<span class="fc" id="L777">				Array sqlArray = insertStatement.getConnection().createArrayOf(&quot;uuid&quot;, includes);</span>
<span class="fc" id="L778">				insertStatement.setArray(7, sqlArray);</span>
<span class="fc" id="L779">				sqlArray = insertStatement.getConnection().createArrayOf(&quot;uuid&quot;, accessedProps);</span>
<span class="fc" id="L780">				insertStatement.setArray(8, sqlArray);</span>
<span class="fc" id="L781">				sqlArray = insertStatement.getConnection().createArrayOf(&quot;uuid&quot;, accessedImpls);</span>
<span class="fc" id="L782">				insertStatement.setArray(9, sqlArray);</span>
<span class="fc" id="L783">				sqlArray = insertStatement.getConnection().createArrayOf(&quot;varchar&quot;, featureTypes);</span>
<span class="fc" id="L784">				insertStatement.setArray(10, sqlArray);</span>
<span class="fc" id="L785">				sqlArray = insertStatement.getConnection().createArrayOf(&quot;uuid&quot;, features);</span>
<span class="fc" id="L786">				insertStatement.setArray(11, sqlArray);</span>

<span class="fc" id="L788">				insertStatement.setObject(12, implementation.getOperationID().getId());</span>
<span class="fc" id="L789">				insertStatement.setObject(13, implementation.getMetaClassID().getId());</span>
<span class="fc" id="L790">				insertStatement.setObject(14, implementation.getResponsibleAccountID().getId());</span>
<span class="fc" id="L791">				insertStatement.setObject(15, implementation.getNamespaceID().getId());</span>
<span class="fc" id="L792">				insertStatement.setObject(16, prefetchingInfoUUID);</span>

				// CHECKSTYLE:ON
<span class="pc bpc" id="L795" title="1 of 2 branches missed.">				if (DEBUG_ENABLED) {</span>
<span class="nc" id="L796">					logger.debug(&quot;[==DB==] Executing &quot; + insertStatement);</span>
				}
<span class="fc" id="L798">				insertStatement.executeUpdate();</span>
<span class="fc" id="L799">				insertStatement.close();</span>
<span class="nc" id="L800">			} catch (final Exception e) {</span>
<span class="nc" id="L801">				logger.debug(&quot;SQL Exception in storeJavaImplementation&quot;, e);</span>
			} finally {
				try {
<span class="pc bpc" id="L804" title="1 of 2 branches missed.">					if (conn != null) {</span>
<span class="fc" id="L805">						conn.close();</span>
					}
<span class="nc" id="L807">				} catch (final SQLException ex1) {</span>
<span class="nc" id="L808">					logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="fc" id="L809">				}</span>
			}
<span class="fc" id="L811">			return uuid;</span>
		}
	}

	/**
	 * Store PythonImplementation into database
	 * @param implementation
	 *            implementation
	 * @return UUID of stored object
	 */
	public UUID storePythonImplementation(final PythonImplementation implementation) {
<span class="nc" id="L822">		synchronized (dataSource) {</span>
<span class="nc" id="L823">			Connection conn = null;</span>
<span class="nc" id="L824">			final UUID uuid = implementation.getDataClayID().getId();</span>
			try {

<span class="nc" id="L827">				final UUID[] includes = new UUID[implementation.getIncludes().size()];</span>
<span class="nc" id="L828">				int i = 0;</span>
<span class="nc bnc" id="L829" title="All 2 branches missed.">				for (final Type include : implementation.getIncludes()) {</span>
<span class="nc" id="L830">					includes[i] = this.storeType(include);</span>
<span class="nc" id="L831">					i++;</span>
<span class="nc" id="L832">				}</span>

<span class="nc" id="L834">				final UUID[] accessedProps = new UUID[implementation.getAccessedProperties().size()];</span>
<span class="nc" id="L835">				i = 0;</span>
<span class="nc bnc" id="L836" title="All 2 branches missed.">				for (final AccessedProperty accProp : implementation.getAccessedProperties()) {</span>
<span class="nc" id="L837">					accessedProps[i] = this.storeAccessedProperty(accProp);</span>
<span class="nc" id="L838">					i++;</span>
<span class="nc" id="L839">				}</span>

<span class="nc" id="L841">				final UUID[] accessedImpls = new UUID[implementation.getAccessedImplementations().size()];</span>
<span class="nc" id="L842">				i = 0;</span>
<span class="nc bnc" id="L843" title="All 2 branches missed.">				for (final AccessedImplementation accImpl : implementation.getAccessedImplementations()) {</span>
<span class="nc" id="L844">					accessedImpls[i] = this.storeAccessedImplementation(accImpl);</span>
<span class="nc" id="L845">					i++;</span>
<span class="nc" id="L846">				}</span>

<span class="nc" id="L848">				final String[] featureTypes = new String[implementation.getRequiredQualitativeFeatures().size()</span>
<span class="nc" id="L849">						+ implementation.getRequiredQuantitativeFeatures().size()];</span>
<span class="nc" id="L850">				final UUID[] features = new UUID[featureTypes.length];</span>
<span class="nc" id="L851">				i = 0;</span>
<span class="nc bnc" id="L852" title="All 2 branches missed.">				for (final Entry&lt;FeatureType, QualitativeFeature&gt; entry : implementation.getRequiredQualitativeFeatures().entrySet()) {</span>
<span class="nc" id="L853">					featureTypes[i] = entry.getKey().name();</span>
<span class="nc bnc" id="L854" title="All 3 branches missed.">					switch (entry.getKey()) {</span>
						case ARCHITECTURE:
<span class="nc" id="L856">							features[i] = this.storeArchitectureFeature((ArchitectureFeature) entry.getValue());</span>
<span class="nc" id="L857">							break;</span>
						case LANGUAGE:
<span class="nc" id="L859">							features[i] = this.storeLanguageFeature((LanguageFeature) entry.getValue());</span>
<span class="nc" id="L860">							break;</span>
						default:
							break;

					}
<span class="nc" id="L865">					i++;</span>
<span class="nc" id="L866">				}</span>
<span class="nc bnc" id="L867" title="All 2 branches missed.">				for (final Entry&lt;FeatureType, QuantitativeFeature&gt; entry : implementation.getRequiredQuantitativeFeatures().entrySet()) {</span>
<span class="nc" id="L868">					featureTypes[i] = entry.getKey().name();</span>
<span class="nc bnc" id="L869" title="All 3 branches missed.">					switch (entry.getKey()) {</span>
						case CPU:
<span class="nc" id="L871">							features[i] = this.storeCPUFeature((CPUFeature) entry.getValue());</span>
<span class="nc" id="L872">							break;</span>
						case MEMORY:
<span class="nc" id="L874">							features[i] = this.storeMemoryFeature((MemoryFeature) entry.getValue());</span>
<span class="nc" id="L875">							break;</span>
						default:
							break;

					}
<span class="nc" id="L880">					i++;</span>
<span class="nc" id="L881">				}</span>

<span class="nc" id="L883">				UUID prefetchingInfoUUID = null;</span>
<span class="nc bnc" id="L884" title="All 2 branches missed.">				if (implementation.getPrefetchingInfo() != null) {</span>
<span class="nc" id="L885">					prefetchingInfoUUID = this.storePrefecthingInfo(implementation.getPrefetchingInfo());</span>
				}

<span class="nc" id="L888">				conn = dataSource.getConnection();</span>
<span class="nc" id="L889">				final PreparedStatement insertStatement = conn.prepareStatement(</span>
<span class="nc" id="L890">						ClassManagerSQLStatements.SqlStatements.INSERT_PYTHON_IMPLEMENTATION.getSqlStatement());</span>
<span class="nc" id="L891">				insertStatement.setObject(1, uuid);</span>
				// CHECKSTYLE:OFF
<span class="nc" id="L893">				insertStatement.setString(2, implementation.getResponsibleAccountName());</span>
<span class="nc" id="L894">				insertStatement.setString(3, implementation.getNamespace());</span>
<span class="nc" id="L895">				insertStatement.setString(4, implementation.getClassName());</span>
<span class="nc" id="L896">				insertStatement.setString(5, implementation.getOpNameAndDescriptor());</span>
<span class="nc" id="L897">				insertStatement.setInt(6, implementation.getPosition());</span>

<span class="nc" id="L899">				Array sqlArray = insertStatement.getConnection().createArrayOf(&quot;uuid&quot;, includes);</span>
<span class="nc" id="L900">				insertStatement.setArray(7, sqlArray);</span>
<span class="nc" id="L901">				sqlArray = insertStatement.getConnection().createArrayOf(&quot;uuid&quot;, accessedProps);</span>
<span class="nc" id="L902">				insertStatement.setArray(8, sqlArray);</span>
<span class="nc" id="L903">				sqlArray = insertStatement.getConnection().createArrayOf(&quot;uuid&quot;, accessedImpls);</span>
<span class="nc" id="L904">				insertStatement.setArray(9, sqlArray);</span>
<span class="nc" id="L905">				sqlArray = insertStatement.getConnection().createArrayOf(&quot;varchar&quot;, featureTypes);</span>
<span class="nc" id="L906">				insertStatement.setArray(10, sqlArray);</span>
<span class="nc" id="L907">				sqlArray = insertStatement.getConnection().createArrayOf(&quot;uuid&quot;, features);</span>
<span class="nc" id="L908">				insertStatement.setArray(11, sqlArray);</span>

<span class="nc" id="L910">				insertStatement.setObject(12, implementation.getOperationID().getId());</span>
<span class="nc" id="L911">				insertStatement.setObject(13, implementation.getMetaClassID().getId());</span>
<span class="nc" id="L912">				insertStatement.setObject(14, implementation.getResponsibleAccountID().getId());</span>
<span class="nc" id="L913">				insertStatement.setObject(15, implementation.getNamespaceID().getId());</span>
<span class="nc" id="L914">				insertStatement.setObject(16, prefetchingInfoUUID);</span>
<span class="nc" id="L915">				insertStatement.setString(17, implementation.getCode());</span>

				// CHECKSTYLE:ON
<span class="nc bnc" id="L918" title="All 2 branches missed.">				if (DEBUG_ENABLED) {</span>
<span class="nc" id="L919">					logger.debug(&quot;[==DB==] Executing &quot; + insertStatement);</span>
				}
<span class="nc" id="L921">				insertStatement.executeUpdate();</span>
<span class="nc" id="L922">				insertStatement.close();</span>
<span class="nc" id="L923">			} catch (final Exception e) {</span>
<span class="nc" id="L924">				logger.debug(&quot;SQL Exception in storePythonImplementation&quot;, e);</span>
			} finally {
				try {
<span class="nc bnc" id="L927" title="All 2 branches missed.">					if (conn != null) {</span>
<span class="nc" id="L928">						conn.close();</span>
					}
<span class="nc" id="L930">				} catch (final SQLException ex1) {</span>
<span class="nc" id="L931">					logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L932">				}</span>
			}

<span class="nc" id="L935">			return uuid;</span>
		}
	}

	/**
	 * Store Property into database
	 * @param property
	 *            property
	 * @return UUID of stored object
	 */
	public UUID storeProperty(final Property property) {
<span class="fc" id="L946">		synchronized (dataSource) {</span>
<span class="fc" id="L947">			Connection conn = null;</span>
<span class="fc" id="L948">			final UUID uuid = property.getDataClayID().getId();</span>
			try {

<span class="fc" id="L951">				final UUID typeID = this.storeType(property.getType());</span>

<span class="fc" id="L953">				conn = dataSource.getConnection();</span>
<span class="fc" id="L954">				final PreparedStatement insertStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.INSERT_PROPERTY.getSqlStatement());</span>
<span class="fc" id="L955">				insertStatement.setObject(1, uuid);</span>
				// CHECKSTYLE:OFF
<span class="fc" id="L957">				insertStatement.setString(2, property.getNamespace());</span>
<span class="fc" id="L958">				insertStatement.setString(3, property.getClassName());</span>
<span class="fc" id="L959">				insertStatement.setString(4, property.getName());</span>
<span class="fc" id="L960">				insertStatement.setInt(5, property.getPosition());</span>

<span class="fc" id="L962">				insertStatement.setObject(6, typeID);</span>
<span class="pc bpc" id="L963" title="1 of 2 branches missed.">				if (property.getGetterOperationID() != null) {</span>
<span class="fc" id="L964">					insertStatement.setObject(7, property.getGetterOperationID().getId());</span>
				} else {
<span class="nc" id="L966">					insertStatement.setObject(7, null);</span>
				}
<span class="pc bpc" id="L968" title="1 of 2 branches missed.">				if (property.getGetterImplementationID() != null) {</span>
<span class="fc" id="L969">					insertStatement.setObject(8, property.getGetterImplementationID().getId());</span>
				} else {
<span class="nc" id="L971">					insertStatement.setObject(8, null);</span>
				}
<span class="pc bpc" id="L973" title="1 of 2 branches missed.">				if (property.getSetterOperationID() != null) {</span>
<span class="fc" id="L974">					insertStatement.setObject(9, property.getSetterOperationID().getId());</span>
				} else {
<span class="nc" id="L976">					insertStatement.setObject(9, null);</span>
				}
<span class="pc bpc" id="L978" title="1 of 2 branches missed.">				if (property.getSetterImplementationID() != null) {</span>
<span class="fc" id="L979">					insertStatement.setObject(10, property.getSetterImplementationID().getId());</span>
				} else {
<span class="nc" id="L981">					insertStatement.setObject(10, null);</span>
				}

<span class="fc" id="L984">				insertStatement.setObject(11, property.getNamespaceID().getId());</span>
<span class="fc" id="L985">				insertStatement.setObject(12, property.getMetaClassID().getId());</span>

<span class="pc bpc" id="L987" title="1 of 2 branches missed.">				if (property.getLanguageDepInfos() != null) {</span>
<span class="fc" id="L988">					final String[] extensionsTypeArray = new String[property.getLanguageDepInfos().size()];</span>
<span class="fc" id="L989">					final UUID[] extensionsArray = new UUID[property.getLanguageDepInfos().size()];</span>
<span class="fc" id="L990">					int i = 0;</span>
<span class="fc bfc" id="L991" title="All 2 branches covered.">					for (final Entry&lt;Langs, LanguageDependantPropertyInfo&gt; entry : property.getLanguageDepInfos().entrySet()) {</span>
<span class="fc" id="L992">						extensionsTypeArray[i] = entry.getKey().name();</span>
<span class="pc bpc" id="L993" title="1 of 2 branches missed.">						if (entry.getKey().equals(Langs.LANG_JAVA)) {</span>
<span class="fc" id="L994">							extensionsArray[i] = storeJavaPropertyInfo((JavaPropertyInfo) entry.getValue());</span>
<span class="nc bnc" id="L995" title="All 2 branches missed.">						} else if (entry.getKey().equals(Langs.LANG_PYTHON)) {</span>
<span class="nc" id="L996">							extensionsArray[i] = storePythonPropertyInfo((PythonPropertyInfo) entry.getValue());</span>
						}
<span class="fc" id="L998">						i++;</span>
<span class="fc" id="L999">					}</span>

<span class="fc" id="L1001">					Array sqlArray = insertStatement.getConnection().createArrayOf(&quot;varchar&quot;, extensionsTypeArray);</span>
<span class="fc" id="L1002">					insertStatement.setArray(13, sqlArray);</span>
<span class="fc" id="L1003">					sqlArray = insertStatement.getConnection().createArrayOf(&quot;uuid&quot;, extensionsArray);</span>
<span class="fc" id="L1004">					insertStatement.setArray(14, sqlArray);</span>
<span class="fc" id="L1005">				} else {</span>
<span class="nc" id="L1006">					insertStatement.setArray(13, null);</span>
<span class="nc" id="L1007">					insertStatement.setArray(14, null);</span>
				}

<span class="fc" id="L1010">				final List&lt;Annotation&gt; annotations = property.getAnnotations();</span>
<span class="pc bpc" id="L1011" title="2 of 4 branches missed.">				if (annotations != null &amp;&amp; annotations.size() &gt; 0) {</span>
<span class="nc" id="L1012">					final UUID[] annotationsUUIDArray = new UUID[annotations.size()];</span>
<span class="nc bnc" id="L1013" title="All 2 branches missed.">					for (int i = 0; i &lt; annotations.size(); i++) {</span>
<span class="nc" id="L1014">						annotationsUUIDArray[i] = storeAnnotation(annotations.get(i));</span>
					}
<span class="nc" id="L1016">					final Array sqlArray = insertStatement.getConnection().createArrayOf(&quot;uuid&quot;, annotationsUUIDArray);</span>
<span class="nc" id="L1017">					insertStatement.setArray(15, sqlArray);</span>
<span class="nc" id="L1018">				} else {</span>
<span class="fc" id="L1019">					insertStatement.setArray(15, null);</span>
				}

<span class="pc bpc" id="L1022" title="1 of 2 branches missed.">				if (property.getUpdateImplementationID() != null) {</span>
<span class="nc" id="L1023">					insertStatement.setObject(16, property.getUpdateImplementationID().getId());</span>
				} else {
<span class="fc" id="L1025">					insertStatement.setObject(16, null);</span>
				}
<span class="pc bpc" id="L1027" title="1 of 2 branches missed.">				if (property.getUpdateOperationID() != null) {</span>
<span class="nc" id="L1028">					insertStatement.setObject(17, property.getUpdateOperationID().getId());</span>
				} else {
<span class="fc" id="L1030">					insertStatement.setObject(17, null);</span>
				}

<span class="fc" id="L1033">				insertStatement.setString(18, property.getBeforeUpdate());</span>
<span class="fc" id="L1034">				insertStatement.setString(19, property.getAfterUpdate());</span>
<span class="fc" id="L1035">				insertStatement.setBoolean(20, property.getInMaster());</span>

				// CHECKSTYLE:ON
<span class="pc bpc" id="L1038" title="1 of 2 branches missed.">				if (DEBUG_ENABLED) {</span>
<span class="nc" id="L1039">					logger.debug(&quot;[==DB==] Executing &quot; + insertStatement);</span>
				}
<span class="fc" id="L1041">				insertStatement.executeUpdate();</span>
<span class="fc" id="L1042">				insertStatement.close();</span>
<span class="nc" id="L1043">			} catch (final Exception e) {</span>
<span class="nc" id="L1044">				logger.debug(&quot;SQL Exception in storeProperty&quot;, e);</span>
			} finally {
				try {
<span class="pc bpc" id="L1047" title="1 of 2 branches missed.">					if (conn != null) {</span>
<span class="fc" id="L1048">						conn.close();</span>
					}
<span class="nc" id="L1050">				} catch (final SQLException ex1) {</span>
<span class="nc" id="L1051">					logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="fc" id="L1052">				}</span>
			}
<span class="fc" id="L1054">			return uuid;</span>
		}
	}

	/**
	 * Store JavaPropertyInfo into database
	 * @param type
	 *            JavaPropertyInfo
	 * @return UUID of stored object
	 */
	public UUID storeJavaPropertyInfo(final JavaPropertyInfo type) {
<span class="fc" id="L1065">		synchronized (dataSource) {</span>
<span class="fc" id="L1066">			Connection conn = null;</span>
<span class="fc" id="L1067">			final UUID uuid = UUID.randomUUID();</span>
			try {

<span class="fc" id="L1070">				conn = dataSource.getConnection();</span>
<span class="fc" id="L1071">				final PreparedStatement insertStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.INSERT_JAVA_PROPERTY.getSqlStatement());</span>
<span class="fc" id="L1072">				insertStatement.setObject(1, uuid);</span>
<span class="fc" id="L1073">				insertStatement.setInt(2, type.getModifier());</span>
				// CHECKSTYLE:OFF
				// CHECKSTYLE:ON
<span class="pc bpc" id="L1076" title="1 of 2 branches missed.">				if (DEBUG_ENABLED) {</span>
<span class="nc" id="L1077">					logger.debug(&quot;[==DB==] Executing &quot; + insertStatement);</span>
				}
<span class="fc" id="L1079">				insertStatement.executeUpdate();</span>
<span class="fc" id="L1080">				insertStatement.close();</span>
<span class="nc" id="L1081">			} catch (final Exception e) {</span>
<span class="nc" id="L1082">				logger.debug(&quot;SQL Exception in storeJavaPropertyInfo&quot;, e);</span>
			} finally {
				try {
<span class="pc bpc" id="L1085" title="1 of 2 branches missed.">					if (conn != null) {</span>
<span class="fc" id="L1086">						conn.close();</span>
					}
<span class="nc" id="L1088">				} catch (final SQLException ex1) {</span>
<span class="nc" id="L1089">					logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="fc" id="L1090">				}</span>
			}
<span class="fc" id="L1092">			return uuid;</span>
		}
	}

	/**
	 * Store Annotation into database
	 * @param annotation
	 *            Annotation
	 * @return UUID of stored object
	 */
	public UUID storeAnnotation(final Annotation annotation) {
<span class="nc" id="L1103">		synchronized (dataSource) {</span>
<span class="nc" id="L1104">			Connection conn = null;</span>
<span class="nc" id="L1105">			final UUID uuid = UUID.randomUUID();</span>
			try {

<span class="nc" id="L1108">				conn = dataSource.getConnection();</span>
<span class="nc" id="L1109">				final PreparedStatement insertStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.INSERT_ANNOTATION.getSqlStatement());</span>
<span class="nc" id="L1110">				insertStatement.setObject(1, uuid);</span>
<span class="nc" id="L1111">				insertStatement.setString(2, annotation.getDescr());</span>

<span class="nc" id="L1113">				Array sqlKeys = null, sqlValues = null;</span>
<span class="nc" id="L1114">				final Map&lt;String, String&gt; parameters = annotation.getParameters();</span>
<span class="nc bnc" id="L1115" title="All 4 branches missed.">				if (parameters != null &amp;&amp; parameters.size() &gt; 0) {</span>
<span class="nc" id="L1116">					final String[] keys = new String[parameters.size()];</span>
<span class="nc" id="L1117">					final String[] values = new String[parameters.size()];</span>
<span class="nc" id="L1118">					int i = 0;</span>
<span class="nc" id="L1119">					final Iterator&lt;String&gt; iterator = annotation.getParameters().keySet().iterator();</span>
<span class="nc bnc" id="L1120" title="All 2 branches missed.">					while (iterator.hasNext()) {</span>
<span class="nc" id="L1121">						keys[i] = iterator.next();</span>
<span class="nc" id="L1122">						values[i] = parameters.get(keys[i]);</span>
<span class="nc" id="L1123">						i++;</span>
					}
<span class="nc" id="L1125">					sqlKeys = insertStatement.getConnection().createArrayOf(&quot;varchar&quot;, keys);</span>
<span class="nc" id="L1126">					sqlValues = insertStatement.getConnection().createArrayOf(&quot;varchar&quot;, values);</span>
				}
<span class="nc" id="L1128">				insertStatement.setArray(3, sqlKeys);</span>
<span class="nc" id="L1129">				insertStatement.setArray(4, sqlValues);</span>

				// CHECKSTYLE:OFF
				// CHECKSTYLE:ON
<span class="nc bnc" id="L1133" title="All 2 branches missed.">				if (DEBUG_ENABLED) {</span>
<span class="nc" id="L1134">					logger.debug(&quot;[==DB==] Executing &quot; + insertStatement);</span>
				}
<span class="nc" id="L1136">				insertStatement.executeUpdate();</span>
<span class="nc" id="L1137">				insertStatement.close();</span>
<span class="nc" id="L1138">			} catch (final Exception e) {</span>
<span class="nc" id="L1139">				logger.debug(&quot;SQL Exception in storeAnnotation&quot;, e);</span>
			} finally {
				try {
<span class="nc bnc" id="L1142" title="All 2 branches missed.">					if (conn != null) {</span>
<span class="nc" id="L1143">						conn.close();</span>
					}
<span class="nc" id="L1145">				} catch (final SQLException ex1) {</span>
<span class="nc" id="L1146">					logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L1147">				}</span>
			}
<span class="nc" id="L1149">			return uuid;</span>
		}
	}

	/**
	 * Store PythonPropertyInfo into database
	 * @param type
	 *            PythonPropertyInfo
	 * @return UUID of stored object
	 */
	public UUID storePythonPropertyInfo(final PythonPropertyInfo type) {
<span class="nc" id="L1160">		synchronized (dataSource) {</span>
<span class="nc" id="L1161">			Connection conn = null;</span>
<span class="nc" id="L1162">			final UUID uuid = UUID.randomUUID();</span>
			try {

<span class="nc" id="L1165">				conn = dataSource.getConnection();</span>
<span class="nc" id="L1166">				final PreparedStatement insertStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.INSERT_PYTHON_PROPERTY.getSqlStatement());</span>
<span class="nc" id="L1167">				insertStatement.setObject(1, uuid);</span>
				// CHECKSTYLE:OFF
				// CHECKSTYLE:ON
<span class="nc bnc" id="L1170" title="All 2 branches missed.">				if (DEBUG_ENABLED) {</span>
<span class="nc" id="L1171">					logger.debug(&quot;[==DB==] Executing &quot; + insertStatement);</span>
				}
<span class="nc" id="L1173">				insertStatement.executeUpdate();</span>
<span class="nc" id="L1174">				insertStatement.close();</span>
<span class="nc" id="L1175">			} catch (final Exception e) {</span>
<span class="nc" id="L1176">				logger.debug(&quot;SQL Exception in storePythonPropertyInfo&quot;, e);</span>
			} finally {
				try {
<span class="nc bnc" id="L1179" title="All 2 branches missed.">					if (conn != null) {</span>
<span class="nc" id="L1180">						conn.close();</span>
					}
<span class="nc" id="L1182">				} catch (final SQLException ex1) {</span>
<span class="nc" id="L1183">					logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L1184">				}</span>
			}
<span class="nc" id="L1186">			return uuid;</span>
		}
	}

	/**
	 * Store Operation into database
	 * @param operation
	 *            operation
	 * @return UUID of stored object
	 */
	public UUID storeOperation(final Operation operation) {
<span class="fc" id="L1197">		synchronized (dataSource) {</span>
<span class="fc" id="L1198">			Connection conn = null;</span>
<span class="fc" id="L1199">			final UUID uuid = operation.getDataClayID().getId();</span>
			try {
				// Params
<span class="fc" id="L1202">				final UUID[] paramsTypes = new UUID[operation.getParams().size()];</span>
<span class="fc" id="L1203">				int i = 0;</span>
<span class="fc bfc" id="L1204" title="All 2 branches covered.">				for (final Type paramType : operation.getParams().values()) {</span>
<span class="fc" id="L1205">					paramsTypes[i] = this.storeType(paramType);</span>
<span class="fc" id="L1206">					i++;</span>
<span class="fc" id="L1207">				}</span>
				// Return
<span class="fc" id="L1209">				final UUID returnTypeID = this.storeType(operation.getReturnType());</span>

				// Implementations
<span class="fc" id="L1212">				final UUID[] implementationsIDs = new UUID[operation.getImplementations().size()];</span>
<span class="fc" id="L1213">				i = 0;</span>
<span class="fc bfc" id="L1214" title="All 2 branches covered.">				for (final Implementation impl : operation.getImplementations()) {</span>
<span class="pc bpc" id="L1215" title="1 of 2 branches missed.">					if (impl instanceof JavaImplementation) {</span>
<span class="fc" id="L1216">						implementationsIDs[i] = this.storeJavaImplementation((JavaImplementation) impl);</span>
<span class="nc bnc" id="L1217" title="All 2 branches missed.">					} else if (impl instanceof PythonImplementation) {</span>
<span class="nc" id="L1218">						implementationsIDs[i] = this.storePythonImplementation((PythonImplementation) impl);</span>
					}
<span class="fc" id="L1220">					i++;</span>
<span class="fc" id="L1221">				}</span>

<span class="fc" id="L1223">				conn = dataSource.getConnection();</span>
<span class="fc" id="L1224">				final PreparedStatement insertStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.INSERT_OPERATION.getSqlStatement());</span>
<span class="fc" id="L1225">				insertStatement.setObject(1, uuid);</span>
				// CHECKSTYLE:OFF
<span class="fc" id="L1227">				insertStatement.setString(2, operation.getNamespace());</span>
<span class="fc" id="L1228">				insertStatement.setString(3, operation.getClassName());</span>
<span class="fc" id="L1229">				insertStatement.setString(4, operation.getDescriptor());</span>
<span class="fc" id="L1230">				insertStatement.setString(5, operation.getSignature());</span>
<span class="fc" id="L1231">				insertStatement.setString(6, operation.getName());</span>
<span class="fc" id="L1232">				insertStatement.setString(7, operation.getNameAndDescriptor());</span>

<span class="fc" id="L1234">				final String[] paramsNames = operation.getParams().keySet().toArray(new String[]{});</span>
<span class="fc" id="L1235">				Array sqlArray = insertStatement.getConnection().createArrayOf(&quot;varchar&quot;, paramsNames);</span>
<span class="fc" id="L1236">				insertStatement.setArray(8, sqlArray);</span>

<span class="fc" id="L1238">				sqlArray = insertStatement.getConnection().createArrayOf(&quot;uuid&quot;, paramsTypes);</span>
<span class="fc" id="L1239">				insertStatement.setArray(9, sqlArray);</span>

<span class="fc" id="L1241">				final String[] paramsOrder = operation.getParamsOrder().toArray(new String[]{});</span>
<span class="fc" id="L1242">				sqlArray = insertStatement.getConnection().createArrayOf(&quot;varchar&quot;, paramsOrder);</span>
<span class="fc" id="L1243">				insertStatement.setArray(10, sqlArray);</span>

<span class="fc" id="L1245">				insertStatement.setObject(11, returnTypeID);</span>

<span class="fc" id="L1247">				sqlArray = insertStatement.getConnection().createArrayOf(&quot;uuid&quot;, implementationsIDs);</span>
<span class="fc" id="L1248">				insertStatement.setArray(12, sqlArray);</span>

<span class="fc" id="L1250">				insertStatement.setBoolean(13, operation.getIsAbstract());</span>
<span class="fc" id="L1251">				insertStatement.setBoolean(14, operation.getIsStaticConstructor());</span>

<span class="fc" id="L1253">				insertStatement.setObject(15, operation.getMetaClassID().getId());</span>
<span class="fc" id="L1254">				insertStatement.setObject(16, operation.getNamespaceID().getId());</span>

<span class="pc bpc" id="L1256" title="1 of 2 branches missed.">				if (operation.getLanguageDepInfos() != null) {</span>
<span class="fc" id="L1257">					final String[] extensionsTypeArray = new String[operation.getLanguageDepInfos().size()];</span>
<span class="fc" id="L1258">					final UUID[] extensionsArray = new UUID[operation.getLanguageDepInfos().size()];</span>
<span class="fc" id="L1259">					i = 0;</span>
<span class="fc bfc" id="L1260" title="All 2 branches covered.">					for (final Entry&lt;Langs, LanguageDependantOperationInfo&gt; entry : operation.getLanguageDepInfos().entrySet()) {</span>
<span class="fc" id="L1261">						extensionsTypeArray[i] = entry.getKey().name();</span>
<span class="pc bpc" id="L1262" title="1 of 2 branches missed.">						if (entry.getKey().equals(Langs.LANG_JAVA)) {</span>
<span class="fc" id="L1263">							extensionsArray[i] = storeJavaOperationInfo((JavaOperationInfo) entry.getValue());</span>
<span class="nc bnc" id="L1264" title="All 2 branches missed.">						} else if (entry.getKey().equals(Langs.LANG_PYTHON)) {</span>
<span class="nc" id="L1265">							extensionsArray[i] = storePythonOperationInfo((PythonOperationInfo) entry.getValue());</span>
						}
<span class="fc" id="L1267">						i++;</span>
<span class="fc" id="L1268">					}</span>

<span class="fc" id="L1270">					sqlArray = insertStatement.getConnection().createArrayOf(&quot;varchar&quot;, extensionsTypeArray);</span>
<span class="fc" id="L1271">					insertStatement.setArray(17, sqlArray);</span>

<span class="fc" id="L1273">					sqlArray = insertStatement.getConnection().createArrayOf(&quot;uuid&quot;, extensionsArray);</span>
<span class="fc" id="L1274">					insertStatement.setArray(18, sqlArray);</span>
<span class="fc" id="L1275">				} else {</span>
<span class="nc" id="L1276">					insertStatement.setArray(17, null);</span>
<span class="nc" id="L1277">					insertStatement.setArray(18, null);</span>
				}

				// CHECKSTYLE:ON
<span class="pc bpc" id="L1281" title="1 of 2 branches missed.">				if (DEBUG_ENABLED) {</span>
<span class="nc" id="L1282">					logger.debug(&quot;[==DB==] Executing &quot; + insertStatement + &quot;(&quot; + uuid + &quot;)&quot;);</span>
				}
<span class="fc" id="L1284">				insertStatement.executeUpdate();</span>
<span class="fc" id="L1285">				insertStatement.close();</span>
<span class="nc" id="L1286">			} catch (final Exception e) {</span>
<span class="nc" id="L1287">				logger.debug(&quot;SQL Exception in storeOperation&quot;, e);</span>
			} finally {
				try {
<span class="pc bpc" id="L1290" title="1 of 2 branches missed.">					if (conn != null) {</span>
<span class="fc" id="L1291">						conn.close();</span>
					}
<span class="nc" id="L1293">				} catch (final SQLException ex1) {</span>
<span class="nc" id="L1294">					logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="fc" id="L1295">				}</span>
			}
<span class="fc" id="L1297">			return uuid;</span>
		}

	}

	/**
	 * Store JavaOperationInfo into database
	 * @param type
	 *            JavaOperationInfo
	 * @return UUID of stored object
	 */
	public UUID storeJavaOperationInfo(final JavaOperationInfo type) {
<span class="fc" id="L1309">		synchronized (dataSource) {</span>
<span class="fc" id="L1310">			Connection conn = null;</span>
<span class="fc" id="L1311">			final UUID uuid = UUID.randomUUID();</span>
			try {

<span class="fc" id="L1314">				conn = dataSource.getConnection();</span>
<span class="fc" id="L1315">				final PreparedStatement insertStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.INSERT_JAVA_OPERATION.getSqlStatement());</span>
<span class="fc" id="L1316">				insertStatement.setObject(1, uuid);</span>
<span class="fc" id="L1317">				insertStatement.setInt(2, type.getModifier());</span>
				// CHECKSTYLE:OFF
				// CHECKSTYLE:ON
<span class="pc bpc" id="L1320" title="1 of 2 branches missed.">				if (DEBUG_ENABLED) {</span>
<span class="nc" id="L1321">					logger.debug(&quot;[==DB==] Executing &quot; + insertStatement);</span>
				}
<span class="fc" id="L1323">				insertStatement.executeUpdate();</span>
<span class="fc" id="L1324">				insertStatement.close();</span>
<span class="nc" id="L1325">			} catch (final Exception e) {</span>
<span class="nc" id="L1326">				logger.debug(&quot;SQL Exception in storeJavaOperationInfo&quot;, e);</span>
			} finally {
				try {
<span class="pc bpc" id="L1329" title="1 of 2 branches missed.">					if (conn != null) {</span>
<span class="fc" id="L1330">						conn.close();</span>
					}
<span class="nc" id="L1332">				} catch (final SQLException ex1) {</span>
<span class="nc" id="L1333">					logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="fc" id="L1334">				}</span>
			}
<span class="fc" id="L1336">			return uuid;</span>
		}
	}

	/**
	 * Store PythonOperationInfo into database
	 * @param type
	 *            PythonOperationInfo
	 * @return UUID of stored object
	 */
	public UUID storePythonOperationInfo(final PythonOperationInfo type) {
<span class="nc" id="L1347">		synchronized (dataSource) {</span>
<span class="nc" id="L1348">			Connection conn = null;</span>
<span class="nc" id="L1349">			final UUID uuid = UUID.randomUUID();</span>
			try {

<span class="nc" id="L1352">				conn = dataSource.getConnection();</span>
<span class="nc" id="L1353">				final PreparedStatement insertStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.INSERT_PYTHON_OPERATION.getSqlStatement());</span>
<span class="nc" id="L1354">				insertStatement.setObject(1, uuid);</span>
				// CHECKSTYLE:OFF
				// CHECKSTYLE:ON
<span class="nc bnc" id="L1357" title="All 2 branches missed.">				if (DEBUG_ENABLED) {</span>
<span class="nc" id="L1358">					logger.debug(&quot;[==DB==] Executing &quot; + insertStatement);</span>
				}
<span class="nc" id="L1360">				insertStatement.executeUpdate();</span>
<span class="nc" id="L1361">				insertStatement.close();</span>
<span class="nc" id="L1362">			} catch (final Exception e) {</span>
<span class="nc" id="L1363">				logger.debug(&quot;SQL Exception in storePythonOperationInfo&quot;, e);</span>
			} finally {
				try {
<span class="nc bnc" id="L1366" title="All 2 branches missed.">					if (conn != null) {</span>
<span class="nc" id="L1367">						conn.close();</span>
					}
<span class="nc" id="L1369">				} catch (final SQLException ex1) {</span>
<span class="nc" id="L1370">					logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L1371">				}</span>
			}
<span class="nc" id="L1373">			return uuid;</span>
		}

	}

	/**
	 * Store MetaClass into database
	 * @param metaclass
	 *            metaclass
	 * @return UUID of stored object
	 */
	public UUID storeMetaClass(final MetaClass metaclass) {
<span class="fc" id="L1385">		synchronized (dataSource) {</span>
<span class="fc" id="L1386">			Connection conn = null;</span>
<span class="fc" id="L1387">			final UUID uuid = metaclass.getDataClayID().getId();</span>
			try {

<span class="fc" id="L1390">				final UUID[] properties = new UUID[metaclass.getProperties().size()];</span>
<span class="fc" id="L1391">				int i = 0;</span>
<span class="pc bpc" id="L1392" title="1 of 2 branches missed.">				for (final Property prop : metaclass.getProperties()) {</span>
<span class="nc" id="L1393">					properties[i] = this.storeProperty(prop);</span>
<span class="nc" id="L1394">					i++;</span>
<span class="nc" id="L1395">				}</span>

<span class="fc" id="L1397">				final UUID[] operations = new UUID[metaclass.getOperations().size()];</span>
<span class="fc" id="L1398">				i = 0;</span>
<span class="pc bpc" id="L1399" title="1 of 2 branches missed.">				for (final Operation op : metaclass.getOperations()) {</span>
<span class="nc" id="L1400">					operations[i] = this.storeOperation(op);</span>
<span class="nc" id="L1401">					i++;</span>
<span class="nc" id="L1402">				}</span>

<span class="fc" id="L1404">				UUID parentTypeID = null;</span>
<span class="pc bpc" id="L1405" title="1 of 2 branches missed.">				if (metaclass.getParentType() != null) {</span>
<span class="nc" id="L1406">					parentTypeID = this.storeType(metaclass.getParentType());</span>
				}
<span class="fc" id="L1408">				conn = dataSource.getConnection();</span>
<span class="fc" id="L1409">				final PreparedStatement insertStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.INSERT_METACLASS.getSqlStatement());</span>
<span class="fc" id="L1410">				insertStatement.setObject(1, uuid);</span>
				// CHECKSTYLE:OFF
<span class="fc" id="L1412">				insertStatement.setString(2, metaclass.getNamespace());</span>
<span class="fc" id="L1413">				insertStatement.setString(3, metaclass.getName());</span>
<span class="fc" id="L1414">				insertStatement.setObject(4, parentTypeID);</span>

<span class="fc" id="L1416">				Array sqlArray = insertStatement.getConnection().createArrayOf(&quot;uuid&quot;, properties);</span>
<span class="fc" id="L1417">				insertStatement.setArray(5, sqlArray);</span>

<span class="fc" id="L1419">				sqlArray = insertStatement.getConnection().createArrayOf(&quot;uuid&quot;, operations);</span>
<span class="fc" id="L1420">				insertStatement.setArray(6, sqlArray);</span>

<span class="fc" id="L1422">				insertStatement.setBoolean(7, metaclass.getIsAbstract());</span>
<span class="fc" id="L1423">				insertStatement.setObject(8, metaclass.getNamespaceID().getId());</span>

<span class="fc" id="L1425">				final String[] extensionsTypeArray = new String[metaclass.getLanguageDepInfos().size()];</span>
<span class="fc" id="L1426">				final UUID[] extensionsArray = new UUID[metaclass.getLanguageDepInfos().size()];</span>
<span class="fc" id="L1427">				i = 0;</span>
<span class="fc bfc" id="L1428" title="All 2 branches covered.">				for (final Entry&lt;Langs, LanguageDependantClassInfo&gt; entry : metaclass.getLanguageDepInfos().entrySet()) {</span>
<span class="fc" id="L1429">					extensionsTypeArray[i] = entry.getKey().name();</span>
<span class="pc bpc" id="L1430" title="1 of 2 branches missed.">					if (entry.getKey().equals(Langs.LANG_JAVA)) {</span>
<span class="fc" id="L1431">						extensionsArray[i] = storeJavaClassInfo((JavaClassInfo) entry.getValue());</span>
<span class="nc bnc" id="L1432" title="All 2 branches missed.">					} else if (entry.getKey().equals(Langs.LANG_PYTHON)) {</span>
<span class="nc" id="L1433">						extensionsArray[i] = storePythonClassInfo((PythonClassInfo) entry.getValue());</span>
					}
<span class="fc" id="L1435">					i++;</span>
<span class="fc" id="L1436">				}</span>

<span class="fc" id="L1438">				sqlArray = insertStatement.getConnection().createArrayOf(&quot;varchar&quot;, extensionsTypeArray);</span>
<span class="fc" id="L1439">				insertStatement.setArray(9, sqlArray);</span>

<span class="fc" id="L1441">				sqlArray = insertStatement.getConnection().createArrayOf(&quot;uuid&quot;, extensionsArray);</span>
<span class="fc" id="L1442">				insertStatement.setArray(10, sqlArray);</span>

				// CHECKSTYLE:ON
<span class="pc bpc" id="L1445" title="1 of 2 branches missed.">				if (DEBUG_ENABLED) {</span>
<span class="nc" id="L1446">					logger.debug(&quot;[==DB==] Executing &quot; + insertStatement);</span>
				}
<span class="fc" id="L1448">				insertStatement.executeUpdate();</span>
<span class="fc" id="L1449">				insertStatement.close();</span>
<span class="nc" id="L1450">			} catch (final Exception e) {</span>
<span class="nc" id="L1451">				logger.debug(&quot;SQL Exception in storeMetaClass&quot;, e);</span>
			} finally {
				try {
<span class="pc bpc" id="L1454" title="1 of 2 branches missed.">					if (conn != null) {</span>
<span class="fc" id="L1455">						conn.close();</span>
					}
<span class="nc" id="L1457">				} catch (final SQLException ex1) {</span>
<span class="nc" id="L1458">					logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="fc" id="L1459">				}</span>
			}
<span class="fc" id="L1461">			return uuid;</span>
		}
	}

	/**
	 * Store JavaClassInfo into database
	 * @param info
	 *            JavaClassInfo
	 * @return UUID of stored object
	 */
	public UUID storeJavaClassInfo(final JavaClassInfo info) {
<span class="fc" id="L1472">		synchronized (dataSource) {</span>
<span class="fc" id="L1473">			Connection conn = null;</span>
<span class="fc" id="L1474">			final UUID uuid = UUID.randomUUID();</span>
			try {

<span class="fc" id="L1477">				conn = dataSource.getConnection();</span>
<span class="fc" id="L1478">				final PreparedStatement insertStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.INSERT_JAVA_METACLASS.getSqlStatement());</span>
				// CHECKSTYLE:OFF

<span class="fc" id="L1481">				insertStatement.setObject(1, uuid);</span>
<span class="fc" id="L1482">				insertStatement.setString(2, info.getSignature());</span>
<span class="fc bfc" id="L1483" title="All 2 branches covered.">				if (info.getJavaParentInterfaces() != null) {</span>
<span class="fc" id="L1484">					final Array sqlArray = insertStatement.getConnection().createArrayOf(&quot;varchar&quot;, info.getJavaParentInterfaces());</span>
<span class="fc" id="L1485">					insertStatement.setArray(3, sqlArray);</span>
<span class="fc" id="L1486">				} else {</span>
<span class="fc" id="L1487">					insertStatement.setArray(3, null);</span>
				}

<span class="fc" id="L1490">				insertStatement.setBytes(4, info.getClassByteCode());</span>
<span class="fc" id="L1491">				insertStatement.setInt(5, info.getModifier());</span>
				// CHECKSTYLE:ON
<span class="pc bpc" id="L1493" title="1 of 2 branches missed.">				if (DEBUG_ENABLED) {</span>
<span class="nc" id="L1494">					logger.debug(&quot;[==DB==] Executing &quot; + insertStatement);</span>
				}
<span class="fc" id="L1496">				insertStatement.executeUpdate();</span>
<span class="fc" id="L1497">				insertStatement.close();</span>
<span class="nc" id="L1498">			} catch (final Exception e) {</span>
<span class="nc" id="L1499">				logger.debug(&quot;SQL Exception in storeJavaClassInfo&quot;, e);</span>
			} finally {
				try {
<span class="pc bpc" id="L1502" title="1 of 2 branches missed.">					if (conn != null) {</span>
<span class="fc" id="L1503">						conn.close();</span>
					}
<span class="nc" id="L1505">				} catch (final SQLException ex1) {</span>
<span class="nc" id="L1506">					logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="fc" id="L1507">				}</span>
			}
<span class="fc" id="L1509">			return uuid;</span>
		}
	}

	/**
	 * Store PythonClassInfo into database
	 * @param info
	 *            PythonClassInfo
	 * @return UUID of stored object
	 */
	public UUID storePythonClassInfo(final PythonClassInfo info) {
<span class="nc" id="L1520">		synchronized (dataSource) {</span>
<span class="nc" id="L1521">			Connection conn = null;</span>
<span class="nc" id="L1522">			final UUID uuid = UUID.randomUUID();</span>
			try {

<span class="nc" id="L1525">				conn = dataSource.getConnection();</span>
<span class="nc" id="L1526">				final PreparedStatement insertStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.INSERT_PYTHON_METACLASS.getSqlStatement());</span>
<span class="nc" id="L1527">				insertStatement.setObject(1, uuid);</span>

<span class="nc" id="L1529">				final String[] importx = new String[info.getImports().size()];</span>

<span class="nc" id="L1531">				int i = 0;</span>
<span class="nc bnc" id="L1532" title="All 2 branches missed.">				for (final String entry : info.getImports()) {</span>
<span class="nc" id="L1533">					importx[i] = entry;</span>
<span class="nc" id="L1534">					i++;</span>
<span class="nc" id="L1535">				}</span>

<span class="nc" id="L1537">				final Array sqlArray = insertStatement.getConnection().createArrayOf(&quot;varchar&quot;, importx);</span>
<span class="nc" id="L1538">				insertStatement.setArray(2, sqlArray);</span>
				// CHECKSTYLE:OFF

				// CHECKSTYLE:ON
<span class="nc bnc" id="L1542" title="All 2 branches missed.">				if (DEBUG_ENABLED) {</span>
<span class="nc" id="L1543">					logger.debug(&quot;[==DB==] Executing &quot; + insertStatement);</span>
				}
<span class="nc" id="L1545">				insertStatement.executeUpdate();</span>
<span class="nc" id="L1546">				insertStatement.close();</span>
<span class="nc" id="L1547">			} catch (final Exception e) {</span>
<span class="nc" id="L1548">				logger.debug(&quot;SQL Exception in storePythonClassInfo&quot;, e);</span>
			} finally {
				try {
<span class="nc bnc" id="L1551" title="All 2 branches missed.">					if (conn != null) {</span>
<span class="nc" id="L1552">						conn.close();</span>
					}
<span class="nc" id="L1554">				} catch (final SQLException ex1) {</span>
<span class="nc" id="L1555">					logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L1556">				}</span>
			}
<span class="nc" id="L1558">			return uuid;</span>
		}
	}

	/**
	 * Deserialize type
	 * @param rs
	 *            Result set
	 * @return Type
	 */
	private Type deserializeType(final ResultSet rs) {
<span class="fc" id="L1569">		synchronized (dataSource) {</span>
<span class="fc" id="L1570">			Type type = null;</span>
			try {
<span class="fc" id="L1572">				boolean isUserType = false;</span>

<span class="fc" id="L1574">				final UUID id = (UUID) rs.getObject(&quot;id&quot;);</span>

<span class="fc" id="L1576">				final String namespace = rs.getString(&quot;namespace&quot;);</span>
<span class="fc" id="L1577">				MetaClassID classID = null;</span>
<span class="fc bfc" id="L1578" title="All 2 branches covered.">				if (namespace != null) {</span>
					// it's user type
<span class="fc" id="L1580">					isUserType = true;</span>
<span class="fc" id="L1581">					classID = new MetaClassID((UUID) rs.getObject(&quot;classID&quot;));</span>
				}
<span class="fc" id="L1583">				final String descriptor = rs.getString(&quot;descriptor&quot;);</span>
<span class="fc" id="L1584">				final String signature = rs.getString(&quot;signature&quot;);</span>
<span class="fc" id="L1585">				final String typeName = rs.getString(&quot;typeName&quot;);</span>
<span class="fc" id="L1586">				Array sqlArray = rs.getArray(&quot;includes&quot;);</span>
<span class="fc" id="L1587">				final List&lt;Type&gt; includes = new ArrayList&lt;&gt;();</span>
<span class="pc bpc" id="L1588" title="1 of 2 branches missed.">				if (sqlArray != null) {</span>
<span class="nc" id="L1589">					final UUID[] uuidArray = (UUID[]) sqlArray.getArray();</span>
<span class="nc bnc" id="L1590" title="All 2 branches missed.">					for (final UUID includedUUID : uuidArray) {</span>
<span class="nc" id="L1591">						final Type include = getTypeByID(includedUUID);</span>
<span class="nc" id="L1592">						includes.add(include);</span>
					}
				}

<span class="fc" id="L1596">				final Map&lt;Langs, LanguageDependantTypeInfo&gt; extensions = new HashMap&lt;&gt;();</span>
<span class="fc" id="L1597">				sqlArray = rs.getArray(&quot;extendedtypes&quot;);</span>
<span class="pc bpc" id="L1598" title="1 of 2 branches missed.">				if (sqlArray != null) {</span>
<span class="fc" id="L1599">					final Array extensionsArray = rs.getArray(&quot;extensions&quot;);</span>
<span class="fc" id="L1600">					final String[] typesNames = (String[]) sqlArray.getArray();</span>
<span class="fc" id="L1601">					final UUID[] uuidArray = (UUID[]) extensionsArray.getArray();</span>
<span class="pc bpc" id="L1602" title="1 of 2 branches missed.">					for (int i = 0; i &lt; typesNames.length; ++i) {</span>
<span class="nc bnc" id="L1603" title="All 2 branches missed.">						if (typesNames[i].equals(Langs.LANG_JAVA.name())) {</span>
<span class="nc" id="L1604">							final JavaTypeInfo info = this.getJavaTypeByID(uuidArray[i]);</span>
<span class="nc" id="L1605">							extensions.put(Langs.LANG_JAVA, info);</span>
<span class="nc bnc" id="L1606" title="All 2 branches missed.">						} else if (typesNames[i].equals(Langs.LANG_PYTHON.name())) {</span>
<span class="nc" id="L1607">							final PythonTypeInfo info = this.getPythonTypeByID(uuidArray[i]);</span>
<span class="nc" id="L1608">							extensions.put(Langs.LANG_PYTHON, info);</span>
						}
					}
				}

<span class="fc bfc" id="L1613" title="All 2 branches covered.">				if (isUserType) {</span>
<span class="fc" id="L1614">					final UserType utype = new UserType(namespace,</span>
							typeName, descriptor, signature, includes);
<span class="fc" id="L1616">					utype.setClassID(classID);</span>
<span class="fc" id="L1617">					type = utype;</span>
<span class="fc" id="L1618">				} else {</span>
<span class="fc" id="L1619">					type = new Type(descriptor, signature, typeName, includes);</span>
				}

<span class="fc" id="L1622">				type.setId(id);</span>
<span class="fc" id="L1623">				type.setLanguageDepInfos(extensions);</span>

<span class="nc" id="L1625">			} catch (final SQLException e) {</span>
<span class="nc" id="L1626">				logger.debug(&quot;SQL Exception in deserializeType&quot;, e);</span>
<span class="fc" id="L1627">			}</span>
<span class="fc" id="L1628">			return type;</span>
		}
	}

	/**
	 * Deserialize JavaTypeInfo
	 * @param rs
	 *            Result set
	 * @return JavaTypeInfo
	 */
	private JavaTypeInfo deserializeJavaType(final ResultSet rs) {
<span class="nc" id="L1639">		final JavaTypeInfo type = new JavaTypeInfo(); // no fields</span>
		try {
<span class="nc" id="L1641">			final UUID id = (UUID)rs.getObject(&quot;id&quot;);</span>
<span class="nc" id="L1642">			type.setId(id);</span>
<span class="nc" id="L1643">		} catch (final SQLException e) {</span>
<span class="nc" id="L1644">			logger.debug(&quot;SQL Exception in deserializeJavaType&quot;, e);</span>
<span class="nc" id="L1645">		}</span>
<span class="nc" id="L1646">		return type;</span>
	}

	/**
	 * Deserialize PythonTypeInfo
	 * @param rs
	 *            Result set
	 * @return PythonTypeInfo
	 */
	private PythonTypeInfo deserializePythonType(final ResultSet rs) {
<span class="nc" id="L1656">		PythonTypeInfo type = null;</span>
		try {
<span class="nc" id="L1658">			final String signature = rs.getString(&quot;signature&quot;);</span>
<span class="nc" id="L1659">			type = new PythonTypeInfo(signature);</span>
<span class="nc" id="L1660">			final UUID id = (UUID)rs.getObject(&quot;id&quot;);</span>
<span class="nc" id="L1661">			type.setId(id);</span>
<span class="nc" id="L1662">		} catch (final SQLException e) {</span>
<span class="nc" id="L1663">			logger.debug(&quot;SQL Exception in deserializePythonType&quot;, e);</span>
<span class="nc" id="L1664">		}</span>
<span class="nc" id="L1665">		return type;</span>
	}

	/**
	 * Deserialize property
	 * @param rs
	 *            Result set
	 * @return Property
	 */
	private Property deserializeProperty(final ResultSet rs) {
<span class="fc" id="L1675">		Property property = null;</span>
		try {

<span class="fc" id="L1678">			final PropertyID id = new PropertyID((UUID)rs.getObject(&quot;id&quot;));</span>
<span class="fc" id="L1679">			final String namespace = rs.getString(&quot;namespace&quot;);</span>
<span class="fc" id="L1680">			final String className = rs.getString(&quot;className&quot;);</span>
<span class="fc" id="L1681">			final String name = rs.getString(&quot;name&quot;);</span>
<span class="fc" id="L1682">			final int position = rs.getInt(&quot;position&quot;);</span>
<span class="fc" id="L1683">			final Type propType = getTypeByID((UUID)rs.getObject(&quot;type&quot;));</span>

<span class="fc" id="L1685">			OperationID getterOperationID = null;</span>
<span class="fc" id="L1686">			final UUID getterUUID = (UUID)rs.getObject(&quot;getterOperationID&quot;);</span>
<span class="pc bpc" id="L1687" title="1 of 2 branches missed.">			if (getterUUID != null) {</span>
<span class="fc" id="L1688">				getterOperationID = new OperationID(getterUUID);</span>
			}

<span class="fc" id="L1691">			ImplementationID getterImplementationID = null;</span>
<span class="fc" id="L1692">			final UUID getterImplementationUUID = (UUID)rs.getObject(&quot;getterImplementationID&quot;);</span>
<span class="pc bpc" id="L1693" title="1 of 2 branches missed.">			if (getterImplementationUUID != null) {</span>
<span class="fc" id="L1694">				getterImplementationID = new ImplementationID(getterImplementationUUID);</span>
			}

<span class="fc" id="L1697">			OperationID setterOperationID = null;</span>
<span class="fc" id="L1698">			final UUID setterUUID = (UUID)rs.getObject(&quot;setterOperationID&quot;);</span>
<span class="pc bpc" id="L1699" title="1 of 2 branches missed.">			if (setterUUID != null) {</span>
<span class="fc" id="L1700">				setterOperationID = new OperationID(setterUUID);</span>
			}

<span class="fc" id="L1703">			ImplementationID setterImplementationID = null;</span>
<span class="fc" id="L1704">			final UUID setterImplementationUUID = (UUID)rs.getObject(&quot;setterImplementationID&quot;);</span>
<span class="pc bpc" id="L1705" title="1 of 2 branches missed.">			if (setterImplementationUUID != null) {</span>
<span class="fc" id="L1706">				setterImplementationID = new ImplementationID(setterImplementationUUID);</span>
			}

<span class="fc" id="L1709">			ImplementationID updateImplementationID = null;</span>
<span class="pc bpc" id="L1710" title="1 of 2 branches missed.">			if (rs.getObject(&quot;updateImplementationID&quot;) != null) {</span>
<span class="nc" id="L1711">				updateImplementationID = new ImplementationID((UUID)rs.getObject(&quot;updateImplementationID&quot;));</span>
			}

<span class="fc" id="L1714">			OperationID updateOperationID = null;</span>
<span class="pc bpc" id="L1715" title="1 of 2 branches missed.">			if (rs.getObject(&quot;updateOperationID&quot;) != null) {</span>
<span class="nc" id="L1716">				updateOperationID = new OperationID((UUID)rs.getObject(&quot;updateOperationID&quot;));</span>
			}

<span class="fc" id="L1719">			final NamespaceID namespaceID = new NamespaceID((UUID)rs.getObject(&quot;namespaceID&quot;));</span>
<span class="fc" id="L1720">			final MetaClassID metaClassID = new MetaClassID((UUID)rs.getObject(&quot;metaClassID&quot;));</span>

<span class="fc" id="L1722">			final Map&lt;Langs, LanguageDependantPropertyInfo&gt; extensions = new HashMap&lt;&gt;();</span>
<span class="fc" id="L1723">			final Array sqlArray = rs.getArray(&quot;extendedtypes&quot;);</span>
<span class="pc bpc" id="L1724" title="1 of 2 branches missed.">			if (sqlArray != null) {</span>
<span class="fc" id="L1725">				final Array extensionsArray = rs.getArray(&quot;extensions&quot;);</span>
<span class="fc" id="L1726">				final String[] typesNames = (String[]) sqlArray.getArray();</span>
<span class="fc" id="L1727">				final UUID[] uuidArray = (UUID[]) extensionsArray.getArray();</span>
<span class="fc bfc" id="L1728" title="All 2 branches covered.">				for (int i = 0; i &lt; typesNames.length; ++i) {</span>
<span class="pc bpc" id="L1729" title="1 of 2 branches missed.">					if (typesNames[i].equals(Langs.LANG_JAVA.name())) {</span>
<span class="fc" id="L1730">						final JavaPropertyInfo info = this.getJavaPropertyByID(uuidArray[i]);</span>
<span class="fc" id="L1731">						extensions.put(Langs.LANG_JAVA, info);</span>
<span class="pc bnc" id="L1732" title="All 2 branches missed.">					} else if (typesNames[i].equals(Langs.LANG_PYTHON.name())) {</span>
<span class="nc" id="L1733">						final PythonPropertyInfo info = this.getPythonPropertyByID(uuidArray[i]);</span>
<span class="nc" id="L1734">						extensions.put(Langs.LANG_PYTHON, info);</span>
					}
				}
			}

<span class="fc" id="L1739">			property = new Property(position, name, propType, namespace, className);</span>
<span class="fc" id="L1740">			property.setDataClayID(id);</span>
<span class="fc" id="L1741">			property.setGetterImplementationID(getterImplementationID);</span>
<span class="fc" id="L1742">			property.setGetterOperationID(getterOperationID);</span>
<span class="fc" id="L1743">			property.setMetaClassID(metaClassID);</span>
<span class="fc" id="L1744">			property.setNamespaceID(namespaceID);</span>
<span class="fc" id="L1745">			property.setSetterImplementationID(setterImplementationID);</span>
<span class="fc" id="L1746">			property.setSetterOperationID(setterOperationID);</span>
<span class="fc" id="L1747">			property.setUpdateImplementationID(updateImplementationID);</span>
<span class="fc" id="L1748">			property.setUpdateOperationID(updateOperationID);</span>
<span class="fc" id="L1749">			property.setType(propType);</span>
<span class="fc" id="L1750">			property.setLanguageDepInfos(extensions);</span>
<span class="fc" id="L1751">			property.setBeforeUpdate(rs.getString(&quot;beforeUpdate&quot;));</span>
<span class="fc" id="L1752">			property.setAfterUpdate(rs.getString(&quot;afterUpdate&quot;));</span>
<span class="fc" id="L1753">			property.setInMaster(rs.getBoolean(&quot;inMaster&quot;));</span>

<span class="fc" id="L1755">			final Array annotationsUUIDArray = rs.getArray(&quot;annotations&quot;);</span>
<span class="pc bpc" id="L1756" title="1 of 2 branches missed.">			if (annotationsUUIDArray != null) {</span>
<span class="nc" id="L1757">				final UUID[] uuidArray = (UUID[]) annotationsUUIDArray.getArray();</span>
<span class="nc bnc" id="L1758" title="All 2 branches missed.">				for (int i = 0; i &lt; uuidArray.length; i++) {</span>
<span class="nc" id="L1759">					property.addAnnotation(this.getAnnotationByID(uuidArray[i]));</span>
				}
			}
<span class="nc" id="L1762">		} catch (final SQLException e) {</span>
<span class="nc" id="L1763">			logger.debug(&quot;SQL Exception in deserializeProperty&quot;, e);</span>
<span class="fc" id="L1764">		}</span>
<span class="fc" id="L1765">		return property;</span>
	}

	/**
	 * Deserialize Annotation
	 * @param rs
	 *            Result set
	 * @return Annotation
	 */
	private Annotation deserializeAnnotation(final ResultSet rs) {
<span class="nc" id="L1775">		Annotation annotation = null;</span>
		try {
<span class="nc" id="L1777">			annotation = new Annotation(rs.getString(&quot;descr&quot;));</span>
<span class="nc" id="L1778">			annotation.setId((UUID)rs.getObject(&quot;id&quot;));</span>

<span class="nc" id="L1780">			final Array keysArray = rs.getArray(3);</span>
<span class="nc" id="L1781">			final Array valuesArray = rs.getArray(4);</span>
<span class="nc bnc" id="L1782" title="All 4 branches missed.">			if(keysArray != null &amp;&amp; valuesArray != null) {</span>
<span class="nc" id="L1783">				final String[] keys = (String[]) keysArray.getArray(), values = (String[]) valuesArray.getArray();</span>
<span class="nc bnc" id="L1784" title="All 2 branches missed.">				for (int i = 0; i &lt; keys.length; i++) {</span>
<span class="nc" id="L1785">					annotation.addParameter(keys[i], values[i]);</span>
				}
			}
<span class="nc" id="L1788">		} catch (final SQLException e) {</span>
<span class="nc" id="L1789">			logger.debug(&quot;SQL Exception in deserializeAnnotation&quot;, e);</span>
<span class="nc" id="L1790">		}</span>
<span class="nc" id="L1791">		return annotation;</span>
	}

	/**
	 * Deserialize JavaPropertyInfo
	 * @param rs
	 *            Result set
	 * @return JavaPropertyInfo
	 */
	private JavaPropertyInfo deserializeJavaProperty(final ResultSet rs) {
<span class="fc" id="L1801">		JavaPropertyInfo info = null;</span>
		try {
<span class="fc" id="L1803">			final int modifier = rs.getInt(&quot;modifier&quot;);</span>
<span class="fc" id="L1804">			info = new JavaPropertyInfo(modifier);</span>
<span class="fc" id="L1805">			final UUID id = (UUID)rs.getObject(&quot;id&quot;);</span>
<span class="fc" id="L1806">			info.setId(id);</span>
<span class="nc" id="L1807">		} catch (final SQLException e) {</span>
<span class="nc" id="L1808">			logger.debug(&quot;SQL Exception in deserializeJavaProperty&quot;, e);</span>
<span class="fc" id="L1809">		}</span>
<span class="fc" id="L1810">		return info;</span>
	}

	/**
	 * Deserialize PythonPropertyInfo
	 * @param rs
	 *            Result set
	 * @return PythonPropertyInfo
	 */
	private PythonPropertyInfo deserializePythonProperty(final ResultSet rs) {
<span class="nc" id="L1820">		final PythonPropertyInfo info = new PythonPropertyInfo(); // no fields</span>
		try {
<span class="nc" id="L1822">			final UUID id = (UUID)rs.getObject(&quot;id&quot;);</span>
<span class="nc" id="L1823">			info.setId(id);</span>
<span class="nc" id="L1824">		} catch (final SQLException e) {</span>
<span class="nc" id="L1825">			logger.debug(&quot;SQL Exception in deserializePythonProperty&quot;, e);</span>
<span class="nc" id="L1826">		}</span>
<span class="nc" id="L1827">		return info;</span>
	}

	/**
	 * Deserialize AccessedImplementation
	 * @param rs
	 *            Result set
	 * @return AccessedImplementation
	 */
	private AccessedImplementation deserializeAccessedImplementation(final ResultSet rs) {
<span class="nc" id="L1837">		AccessedImplementation accImpl = null;</span>
		try {

<span class="nc" id="L1840">			final String namespace = rs.getString(&quot;namespace&quot;);</span>
<span class="nc" id="L1841">			final String className = rs.getString(&quot;className&quot;);</span>
<span class="nc" id="L1842">			final String opSignature = rs.getString(&quot;opSignature&quot;);</span>
<span class="nc" id="L1843">			final int position = rs.getInt(&quot;position&quot;);</span>
<span class="nc" id="L1844">			final ImplementationID implID = new ImplementationID((UUID)rs.getObject(&quot;implid&quot;));</span>
<span class="nc" id="L1845">			final UUID id = (UUID)rs.getObject(&quot;id&quot;);</span>
<span class="nc" id="L1846">			accImpl = new AccessedImplementation(namespace, className, opSignature, position);</span>
<span class="nc" id="L1847">			accImpl.setImplementationID(implID);</span>
<span class="nc" id="L1848">			accImpl.setId(id);</span>

<span class="nc" id="L1850">		} catch (final SQLException e) {</span>
<span class="nc" id="L1851">			logger.debug(&quot;SQL Exception in deserializeAccessedImplementation&quot;, e);</span>
<span class="nc" id="L1852">		}</span>
<span class="nc" id="L1853">		return accImpl;</span>
	}

	/**
	 * Deserialize AccessedProperty
	 * @param rs
	 *            Result set
	 * @return AccessedProperty
	 */
	private AccessedProperty deserializeAccessedProperty(final ResultSet rs) {
<span class="fc" id="L1863">		AccessedProperty accProp = null;</span>
		try {

<span class="fc" id="L1866">			final String namespace = rs.getString(&quot;namespace&quot;);</span>
<span class="fc" id="L1867">			final String className = rs.getString(&quot;className&quot;);</span>
<span class="fc" id="L1868">			final String name = rs.getString(&quot;name&quot;);</span>
<span class="fc" id="L1869">			final PropertyID propID = new PropertyID((UUID)rs.getObject(&quot;propid&quot;));</span>
<span class="fc" id="L1870">			final UUID id = (UUID)rs.getObject(&quot;id&quot;);</span>

<span class="fc" id="L1872">			accProp = new AccessedProperty(namespace, className, name);</span>
<span class="fc" id="L1873">			accProp.setPropertyID(propID);</span>
<span class="fc" id="L1874">			accProp.setId(id);</span>

<span class="nc" id="L1876">		} catch (final SQLException e) {</span>
<span class="nc" id="L1877">			logger.debug(&quot;SQL Exception in deserializeAccessedProperty&quot;, e);</span>
<span class="fc" id="L1878">		}</span>
<span class="fc" id="L1879">		return accProp;</span>
	}

	/**
	 * Deserialize MemoryFeature
	 * @param rs
	 *            Result set
	 * @return MemoryFeature
	 */
	private MemoryFeature deserializeMemoryFeature(final ResultSet rs) {
<span class="nc" id="L1889">		MemoryFeature feature = null;</span>
		try {

<span class="nc" id="L1892">			final int capacity = rs.getInt(&quot;capacityInMB&quot;);</span>
<span class="nc" id="L1893">			feature = new MemoryFeature(capacity);</span>
<span class="nc" id="L1894">			final UUID id = (UUID)rs.getObject(&quot;id&quot;);</span>
<span class="nc" id="L1895">			feature.setId(id);</span>
<span class="nc" id="L1896">		} catch (final SQLException e) {</span>
<span class="nc" id="L1897">			logger.debug(&quot;SQL Exception in deserializeMemoryFeature&quot;, e);</span>
<span class="nc" id="L1898">		}</span>
<span class="nc" id="L1899">		return feature;</span>
	}

	/**
	 * Deserialize CPUFeature
	 * @param rs
	 *            Result set
	 * @return CPUFeature
	 */
	private CPUFeature deserializeCPUFeature(final ResultSet rs) {
<span class="nc" id="L1909">		CPUFeature feature = null;</span>
		try {

<span class="nc" id="L1912">			final int amount = rs.getInt(&quot;amount&quot;);</span>
<span class="nc" id="L1913">			feature = new CPUFeature(amount);</span>
<span class="nc" id="L1914">			final UUID id = (UUID)rs.getObject(&quot;id&quot;);</span>
<span class="nc" id="L1915">			feature.setId(id);</span>
<span class="nc" id="L1916">		} catch (final SQLException e) {</span>
<span class="nc" id="L1917">			logger.debug(&quot;SQL Exception in deserializeCPUFeature&quot;, e);</span>
<span class="nc" id="L1918">		}</span>
<span class="nc" id="L1919">		return feature;</span>
	}

	/**
	 * Deserialize LanguageFeature
	 * @param rs
	 *            Result set
	 * @return LanguageFeature
	 */
	private LanguageFeature deserializeLanguageFeature(final ResultSet rs) {
<span class="fc" id="L1929">		LanguageFeature feature = null;</span>
		try {

<span class="fc" id="L1932">			final String languageName = rs.getString(&quot;languageName&quot;);</span>
<span class="fc" id="L1933">			final String version = rs.getString(&quot;version&quot;);</span>
<span class="fc" id="L1934">			feature = new LanguageFeature(languageName, version);</span>
<span class="fc" id="L1935">			final UUID id = (UUID)rs.getObject(&quot;id&quot;);</span>
<span class="fc" id="L1936">			feature.setId(id);</span>
<span class="nc" id="L1937">		} catch (final SQLException e) {</span>
<span class="nc" id="L1938">			logger.debug(&quot;SQL Exception in deserializeLanguageFeature&quot;, e);</span>
<span class="fc" id="L1939">		}</span>
<span class="fc" id="L1940">		return feature;</span>
	}

	/**
	 * Deserialize ArchitectureFeature
	 * @param rs
	 *            Result set
	 * @return ArchitectureFeature
	 */
	private ArchitectureFeature deserializeArchitectureFeature(final ResultSet rs) {
<span class="nc" id="L1950">		ArchitectureFeature feature = null;</span>
		try {

<span class="nc" id="L1953">			final String architectureName = rs.getString(&quot;architectureName&quot;);</span>
<span class="nc" id="L1954">			feature = new ArchitectureFeature(architectureName);</span>
<span class="nc" id="L1955">			final UUID id = (UUID)rs.getObject(&quot;id&quot;);</span>
<span class="nc" id="L1956">			feature.setId(id);</span>
<span class="nc" id="L1957">		} catch (final SQLException e) {</span>
<span class="nc" id="L1958">			logger.debug(&quot;SQL Exception in deserializeArchitectureFeature&quot;, e);</span>
<span class="nc" id="L1959">		}</span>
<span class="nc" id="L1960">		return feature;</span>
	}

	/**
	 * Deserialize PrefetchingInfo
	 * @param rs
	 *            Result set
	 * @return PrefetchingInfo
	 */
	private PrefetchingInformation deserializePrefetchingInfo(final ResultSet rs) {
<span class="fc" id="L1970">		PrefetchingInformation prefetchingInfo = null;</span>
		try {

<span class="fc" id="L1973">			final boolean disableDynamicPrefetching = rs.getBoolean(&quot;disableDynamicPrefetching&quot;);</span>
<span class="fc" id="L1974">			final boolean injectPrefetchingCall = rs.getBoolean(&quot;injectPrefetchingCall&quot;);</span>
<span class="fc" id="L1975">			final String prefetchingNamespace = rs.getString(&quot;prefetchingNamespace&quot;);</span>
<span class="fc" id="L1976">			final String prefetchingClassName = rs.getString(&quot;prefetchingClassName&quot;);</span>
<span class="fc" id="L1977">			final String prefetchingMethodSignature = rs.getString(&quot;prefetchingMethodSignature&quot;);</span>

<span class="fc" id="L1979">			final UUID uuidImplID = (UUID)rs.getObject(&quot;implID&quot;);</span>
<span class="fc" id="L1980">			ImplementationID implId = null;</span>
<span class="pc bpc" id="L1981" title="1 of 2 branches missed.">			if (uuidImplID != null) {</span>
<span class="nc" id="L1982">				implId = new ImplementationID((UUID)rs.getObject(&quot;implID&quot;));</span>
			}

<span class="fc" id="L1985">			final UUID uuidPFID = (UUID)rs.getObject(&quot;classID&quot;);</span>
<span class="fc" id="L1986">			MetaClassID classId = null;</span>
<span class="pc bpc" id="L1987" title="1 of 2 branches missed.">			if (uuidPFID != null) {</span>
<span class="nc" id="L1988">				classId = new MetaClassID((UUID)rs.getObject(&quot;classID&quot;));</span>
			}

<span class="fc" id="L1991">			final Array sqlArray = rs.getArray(&quot;propertiesToPrefetch&quot;);</span>
<span class="fc" id="L1992">			final List&lt;List&lt;Property&gt;&gt; properties = new ArrayList&lt;&gt;();</span>
			try {
<span class="pc bpc" id="L1994" title="1 of 2 branches missed.">				if (sqlArray != null) {</span>
<span class="nc" id="L1995">					final UUID[][] uuidArray = (UUID[][]) sqlArray.getArray();</span>
<span class="nc bnc" id="L1996" title="All 2 branches missed.">					for (final UUID[] subArray : uuidArray) {</span>
<span class="nc" id="L1997">						final List&lt;Property&gt; subList = new ArrayList&lt;&gt;();</span>
<span class="nc bnc" id="L1998" title="All 2 branches missed.">						for (final UUID propUUID : subArray) {</span>
<span class="nc" id="L1999">							final Property prop = getPropertyByID(propUUID);</span>
<span class="nc" id="L2000">							subList.add(prop);</span>
						}
<span class="nc" id="L2002">						properties.add(subList);</span>
					}
				}
<span class="nc" id="L2005">			} catch (final Exception e) {</span>
				// Class cast exception if array is empty
<span class="fc" id="L2007">			}</span>
<span class="fc" id="L2008">			prefetchingInfo = new PrefetchingInformation();</span>
<span class="fc" id="L2009">			prefetchingInfo.setDisableDynamicPrefetching(disableDynamicPrefetching);</span>
<span class="fc" id="L2010">			prefetchingInfo.setInjectPrefetchingCall(injectPrefetchingCall);</span>
<span class="fc" id="L2011">			prefetchingInfo.setPrefetchingNameSpace(prefetchingNamespace);</span>
<span class="fc" id="L2012">			prefetchingInfo.setPrefetchingClassName(prefetchingClassName);</span>
<span class="fc" id="L2013">			prefetchingInfo.setPrefetchingMethodSignature(prefetchingMethodSignature);</span>
<span class="fc" id="L2014">			prefetchingInfo.setPrefetchingImplementationID(implId);</span>
<span class="fc" id="L2015">			prefetchingInfo.setPrefetchingClassID(classId);</span>
<span class="fc" id="L2016">			prefetchingInfo.setPropertiesToPrefetch(properties);</span>
<span class="fc" id="L2017">			final UUID id = (UUID)rs.getObject(&quot;id&quot;);</span>
<span class="fc" id="L2018">			prefetchingInfo.setId(id);</span>
<span class="nc" id="L2019">		} catch (final SQLException e) {</span>
<span class="nc" id="L2020">			logger.debug(&quot;SQL Exception in deserializePrefetchingInfo&quot;, e);</span>
<span class="fc" id="L2021">		}</span>
<span class="fc" id="L2022">		return prefetchingInfo;</span>
	}

	/**
	 * Deserialize Implementation
	 * @param rs
	 *            Result set
	 * @return Implementation
	 */
	private Implementation deserializeImplementation(final String tableName, final ResultSet rs) {
<span class="fc" id="L2032">		Implementation impl = null;</span>
		try {
<span class="fc" id="L2034">			final ImplementationID id = new ImplementationID((UUID)rs.getObject(&quot;id&quot;));</span>
<span class="fc" id="L2035">			final String responsibleaccountname = rs.getString(&quot;responsibleaccountname&quot;);</span>

<span class="fc" id="L2037">			final String namespace = rs.getString(&quot;namespace&quot;);</span>
<span class="fc" id="L2038">			final String className = rs.getString(&quot;className&quot;);</span>
<span class="fc" id="L2039">			final String opNameAndDescriptor = rs.getString(&quot;opNameAndDescriptor&quot;);</span>
<span class="fc" id="L2040">			final int position = rs.getInt(&quot;position&quot;);</span>

<span class="fc" id="L2042">			Array sqlArray = rs.getArray(&quot;includes&quot;);</span>
<span class="fc" id="L2043">			final List&lt;Type&gt; includes = new ArrayList&lt;&gt;();</span>
<span class="pc bpc" id="L2044" title="1 of 2 branches missed.">			if (sqlArray != null) {</span>
<span class="fc" id="L2045">				final UUID[] uuidArray = (UUID[]) sqlArray.getArray();</span>
<span class="fc bfc" id="L2046" title="All 2 branches covered.">				for (final UUID includedUUID : uuidArray) {</span>
<span class="fc" id="L2047">					final Type include = getTypeByID(includedUUID);</span>
<span class="fc" id="L2048">					includes.add(include);</span>
				}
			}

<span class="fc" id="L2052">			sqlArray = rs.getArray(&quot;accessedProperties&quot;);</span>
<span class="fc" id="L2053">			final List&lt;AccessedProperty&gt; accessedProperties = new ArrayList&lt;&gt;();</span>
<span class="pc bpc" id="L2054" title="1 of 2 branches missed.">			if (sqlArray != null) {</span>
<span class="fc" id="L2055">				final UUID[] uuidArray = (UUID[]) sqlArray.getArray();</span>
<span class="fc bfc" id="L2056" title="All 2 branches covered.">				for (final UUID includedUUID : uuidArray) {</span>
<span class="fc" id="L2057">					final AccessedProperty accProp = getAccessedPropertyByID(includedUUID);</span>
<span class="fc" id="L2058">					accessedProperties.add(accProp);</span>
				}
			}

<span class="fc" id="L2062">			sqlArray = rs.getArray(&quot;accessedImplementations&quot;);</span>
<span class="fc" id="L2063">			final List&lt;AccessedImplementation&gt; accessedImplementations = new ArrayList&lt;&gt;();</span>
<span class="pc bpc" id="L2064" title="1 of 2 branches missed.">			if (sqlArray != null) {</span>
<span class="fc" id="L2065">				final UUID[] uuidArray = (UUID[]) sqlArray.getArray();</span>
<span class="pc bpc" id="L2066" title="1 of 2 branches missed.">				for (final UUID includedUUID : uuidArray) {</span>
<span class="nc" id="L2067">					final AccessedImplementation accImpl = getAccessedImplementationByID(includedUUID);</span>
<span class="nc" id="L2068">					accessedImplementations.add(accImpl);</span>
				}
			}

<span class="fc" id="L2072">			sqlArray = rs.getArray(&quot;featurestypes&quot;);</span>
<span class="fc" id="L2073">			final Array reqfeaturesArray = rs.getArray(&quot;reqfeatures&quot;);</span>
<span class="fc" id="L2074">			final Map&lt;FeatureType, QuantitativeFeature&gt; requiredQuantitativeFeatures = new HashMap&lt;&gt;();</span>
<span class="fc" id="L2075">			final Map&lt;FeatureType, QualitativeFeature&gt; requiredQualitativeFeatures = new HashMap&lt;&gt;();</span>
<span class="pc bpc" id="L2076" title="1 of 2 branches missed.">			if (sqlArray != null) {</span>
<span class="fc" id="L2077">				final String[] strArray = (String[]) sqlArray.getArray();</span>
<span class="fc" id="L2078">				final UUID[] uuidArray = (UUID[]) reqfeaturesArray.getArray();</span>
<span class="fc bfc" id="L2079" title="All 2 branches covered.">				for (int i = 0; i &lt; strArray.length; ++i) {</span>
<span class="fc" id="L2080">					final FeatureType fType = FeatureType.valueOf(strArray[i]);</span>

<span class="fc" id="L2082">					Feature feature = null;</span>
<span class="pc bpc" id="L2083" title="4 of 5 branches missed.">					switch (fType) {</span>
					case ARCHITECTURE:
<span class="nc" id="L2085">						feature = getArchitectureFeatureByID(uuidArray[i]);</span>

<span class="nc" id="L2087">						break;</span>
					case CPU:
<span class="nc" id="L2089">						feature = getCPUFeatureByID(uuidArray[i]);</span>
<span class="nc" id="L2090">						break;</span>
					case LANGUAGE:
<span class="fc" id="L2092">						feature = getLanguageFeatureByID(uuidArray[i]);</span>
<span class="fc" id="L2093">						break;</span>
					case MEMORY:
<span class="nc" id="L2095">						feature = getMemoryFeatureByID(uuidArray[i]);</span>
<span class="nc" id="L2096">						break;</span>
					default:
<span class="nc" id="L2098">						logger.error(&quot;wrong deserialization of feature type&quot;);</span>
						break;
					}

<span class="pc bpc" id="L2102" title="2 of 3 branches missed.">					switch (feature.getType().getParent()) {</span>
					case QUALITATIVE:
<span class="fc" id="L2104">						requiredQualitativeFeatures.put(fType, (QualitativeFeature) feature);</span>
<span class="fc" id="L2105">						break;</span>
					case QUANTITATIVE:
<span class="nc" id="L2107">						requiredQuantitativeFeatures.put(fType, (QuantitativeFeature) feature);</span>
<span class="nc" id="L2108">						break;</span>
					default:
<span class="nc" id="L2110">						logger.error(&quot;wrong deserialization of feature type&quot;);</span>
						break;

					}
				}
			}

<span class="fc" id="L2117">			final OperationID operationID = new OperationID((UUID)rs.getObject(&quot;operationID&quot;));</span>
<span class="fc" id="L2118">			final MetaClassID metaClassID = new MetaClassID((UUID)rs.getObject(&quot;metaClassID&quot;));</span>
<span class="fc" id="L2119">			final AccountID responsibleAccountID = new AccountID((UUID)rs.getObject(&quot;responsibleAccountID&quot;));</span>
<span class="fc" id="L2120">			final NamespaceID namespaceID = new NamespaceID((UUID)rs.getObject(&quot;namespaceID&quot;));</span>
<span class="fc" id="L2121">			final UUID prefetchingInfoUUID = (UUID)rs.getObject(&quot;prefetchingInfo&quot;);</span>
<span class="fc" id="L2122">			PrefetchingInformation prefetchingInfo = null;</span>
<span class="fc bfc" id="L2123" title="All 2 branches covered.">			if (prefetchingInfoUUID != null) {</span>
<span class="fc" id="L2124">				prefetchingInfo = getPrefetchingInfoByID(prefetchingInfoUUID);</span>
			}

<span class="pc bpc" id="L2127" title="1 of 2 branches missed.">			if (tableName.equals(&quot;java_implementation&quot;)) {</span>

<span class="fc" id="L2129">				impl = new JavaImplementation(position, accessedProperties,</span>
						accessedImplementations, includes,
						prefetchingInfo, requiredQuantitativeFeatures,
						requiredQualitativeFeatures,
						namespace, className, opNameAndDescriptor);
<span class="fc" id="L2134">				impl.setDataClayID(id);</span>
<span class="fc" id="L2135">				impl.setResponsibleAccountName(responsibleaccountname);</span>
<span class="fc" id="L2136">				impl.setResponsibleAccountID(responsibleAccountID);</span>
<span class="fc" id="L2137">				impl.setOperationID(operationID);</span>
<span class="fc" id="L2138">				impl.setMetaClassID(metaClassID);</span>
<span class="fc" id="L2139">				impl.setNamespaceID(namespaceID);</span>

<span class="nc bnc" id="L2141" title="All 2 branches missed.">			} else if (tableName.equals(&quot;python_implementation&quot;)) {</span>
<span class="nc" id="L2142">				impl = new PythonImplementation(position, accessedProperties,</span>
						accessedImplementations, includes,
						prefetchingInfo, requiredQuantitativeFeatures,
						requiredQualitativeFeatures,
						namespace, className, opNameAndDescriptor,
<span class="nc" id="L2147">						getPythonCodeByImplementationID(id.getId()));</span>
<span class="nc" id="L2148">				impl.setDataClayID(id);</span>
<span class="nc" id="L2149">				impl.setResponsibleAccountName(responsibleaccountname);</span>
<span class="nc" id="L2150">				impl.setResponsibleAccountID(responsibleAccountID);</span>
<span class="nc" id="L2151">				impl.setOperationID(operationID);</span>
<span class="nc" id="L2152">				impl.setMetaClassID(metaClassID);</span>
<span class="nc" id="L2153">				impl.setNamespaceID(namespaceID);</span>

			} else {
<span class="nc" id="L2156">				throw new RuntimeException(&quot;Implementation of language not supported&quot;);</span>
			}

<span class="nc" id="L2159">		} catch (final SQLException e) {</span>
<span class="nc" id="L2160">			logger.debug(&quot;SQL Exception in deserializeImplementation&quot;, e);</span>
<span class="fc" id="L2161">		}</span>
<span class="fc" id="L2162">		return impl;</span>
	}

	/**
	 * Deserialize operation
	 * @param rs
	 *            Result set
	 * @return operation
	 */
	private Operation deserializeOperation(final ResultSet rs) {
<span class="fc" id="L2172">		Operation operation = null;</span>
		try {

<span class="fc" id="L2175">			final OperationID id = new OperationID((UUID)rs.getObject(&quot;id&quot;));</span>
<span class="fc" id="L2176">			final String namespace = rs.getString(&quot;namespace&quot;);</span>
<span class="fc" id="L2177">			final String className = rs.getString(&quot;className&quot;);</span>
<span class="fc" id="L2178">			final String descriptor = rs.getString(&quot;descriptor&quot;);</span>
<span class="fc" id="L2179">			final String signature = rs.getString(&quot;signature&quot;);</span>
<span class="fc" id="L2180">			final String name = rs.getString(&quot;name&quot;);</span>
<span class="fc" id="L2181">			final String nameAndDescriptor = rs.getString(&quot;nameAndDescriptor&quot;);</span>

<span class="fc" id="L2183">			final Array namesArray = rs.getArray(&quot;paramsNames&quot;);</span>
<span class="fc" id="L2184">			final Array typesArray = rs.getArray(&quot;paramsTypes&quot;);</span>
<span class="fc" id="L2185">			final Map&lt;String, Type&gt; params = new HashMap&lt;&gt;();</span>
<span class="pc bpc" id="L2186" title="1 of 2 branches missed.">			if (namesArray != null) {</span>
<span class="fc" id="L2187">				final String[] paramsNames = (String[]) namesArray.getArray();</span>
<span class="fc" id="L2188">				final UUID[] paramsTypesUUIDs = (UUID[]) typesArray.getArray();</span>
<span class="fc bfc" id="L2189" title="All 2 branches covered.">				for (int i = 0; i &lt; paramsNames.length; ++i) {</span>
<span class="fc" id="L2190">					final Type paramType = this.getTypeByID(paramsTypesUUIDs[i]);</span>
<span class="fc" id="L2191">					params.put(paramsNames[i], paramType);</span>
				}
			}

<span class="fc" id="L2195">			final Array namesOrderArray = rs.getArray(&quot;paramOrder&quot;);</span>
<span class="fc" id="L2196">			final List&lt;String&gt; paramsOrder = new ArrayList&lt;&gt;();</span>
<span class="pc bpc" id="L2197" title="1 of 2 branches missed.">			if (namesOrderArray != null) {</span>
<span class="fc" id="L2198">				final String[] namesOrder = (String[]) namesOrderArray.getArray();</span>
<span class="fc bfc" id="L2199" title="All 2 branches covered.">				for (final String paramName : namesOrder) {</span>
<span class="fc" id="L2200">					paramsOrder.add(paramName);</span>
				}

			}

<span class="fc" id="L2205">			final UUID returnTypeUUID = (UUID)rs.getObject(&quot;returnType&quot;);</span>
<span class="fc" id="L2206">			final Type returnType = getTypeByID(returnTypeUUID);</span>

<span class="fc" id="L2208">			final Array implsArray = rs.getArray(&quot;implementations&quot;);</span>
<span class="fc" id="L2209">			final SortedSet&lt;Implementation&gt; implementations = new TreeSet&lt;&gt;();</span>
<span class="pc bpc" id="L2210" title="1 of 2 branches missed.">			if (implsArray != null) {</span>
<span class="fc" id="L2211">				final UUID[] implsArrayUUIDs = (UUID[]) implsArray.getArray();</span>
<span class="fc bfc" id="L2212" title="All 2 branches covered.">				for (final UUID implUUID : implsArrayUUIDs) {</span>
<span class="fc" id="L2213">					implementations.add(this.getImplementationByID(implUUID));</span>
				}

			}

<span class="fc" id="L2218">			final boolean isAbstract = rs.getBoolean(&quot;isAbstract&quot;);</span>
<span class="fc" id="L2219">			final boolean isStaticConstructor = rs.getBoolean(&quot;isStaticConstructor&quot;);</span>

<span class="fc" id="L2221">			final MetaClassID metaClassID = new MetaClassID((UUID)rs.getObject(&quot;metaClassID&quot;));</span>
<span class="fc" id="L2222">			final NamespaceID namespaceID = new NamespaceID((UUID)rs.getObject(&quot;namespaceID&quot;));</span>

<span class="fc" id="L2224">			final Array sqlArray = rs.getArray(&quot;extendedtypes&quot;);</span>

			final String[] typesNames;
<span class="pc bpc" id="L2227" title="1 of 2 branches missed.">			if (sqlArray == null) {</span>
<span class="nc" id="L2228">				typesNames = new String[0];</span>
			} else {
<span class="fc" id="L2230">				typesNames = (String[]) sqlArray.getArray();</span>
			}

<span class="fc" id="L2233">			final Array extensionsArray = rs.getArray(&quot;extensions&quot;);</span>
			final UUID[] uuidArray;
<span class="pc bpc" id="L2235" title="1 of 2 branches missed.">			if (extensionsArray == null) {</span>
<span class="nc" id="L2236">				uuidArray = new UUID[0];</span>
			} else {
<span class="fc" id="L2238">				uuidArray = (UUID[]) extensionsArray.getArray();</span>
			}

<span class="fc" id="L2241">			final Map&lt;Langs, LanguageDependantOperationInfo&gt; extensions = new HashMap&lt;&gt;();</span>
<span class="fc bfc" id="L2242" title="All 2 branches covered.">			for (int i = 0; i &lt; typesNames.length; ++i) {</span>
<span class="pc bpc" id="L2243" title="1 of 2 branches missed.">				if (typesNames[i].equals(Langs.LANG_JAVA.name())) {</span>
<span class="fc" id="L2244">					final JavaOperationInfo info = this.getJavaOperationByID(uuidArray[i]);</span>
<span class="fc" id="L2245">					extensions.put(Langs.LANG_JAVA, info);</span>
<span class="pc bnc" id="L2246" title="All 2 branches missed.">				} else if (typesNames[i].equals(Langs.LANG_PYTHON.name())) {</span>
<span class="nc" id="L2247">					final PythonOperationInfo info = this.getPythonOperationByID(uuidArray[i]);</span>
<span class="nc" id="L2248">					extensions.put(Langs.LANG_PYTHON, info);</span>
				}
			}

<span class="fc" id="L2252">			operation = new Operation(name, descriptor, signature,</span>
					nameAndDescriptor,
					namespace, className,
					isAbstract);
<span class="fc" id="L2256">			operation.setDataClayID(id);</span>
<span class="fc" id="L2257">			operation.setImplementations(implementations);</span>
<span class="fc" id="L2258">			operation.setLanguageDepInfos(extensions);</span>
<span class="fc" id="L2259">			operation.setMetaClassID(metaClassID);</span>
<span class="fc" id="L2260">			operation.setNamespaceID(namespaceID);</span>
<span class="fc" id="L2261">			operation.setParamsOrder(paramsOrder);</span>
<span class="fc" id="L2262">			operation.setParams(params);</span>
<span class="fc" id="L2263">			operation.setReturnType(returnType);</span>
<span class="fc" id="L2264">			operation.setIsStaticConstructor(isStaticConstructor);</span>

<span class="nc" id="L2266">		} catch (final SQLException e) {</span>
<span class="nc" id="L2267">			logger.debug(&quot;SQL Exception in deserializeOperation&quot;, e);</span>
<span class="fc" id="L2268">		}</span>
<span class="fc" id="L2269">		return operation;</span>
	}

	/**
	 * Deserialize JavaOperationInfo
	 * @param rs
	 *            Result set
	 * @return JavaOperationInfo
	 */
	private JavaOperationInfo deserializeJavaOperation(final ResultSet rs) {
<span class="fc" id="L2279">		JavaOperationInfo info = null;</span>
		try {
<span class="fc" id="L2281">			final int modifier = rs.getInt(&quot;modifier&quot;);</span>
<span class="fc" id="L2282">			info = new JavaOperationInfo(modifier);</span>
<span class="fc" id="L2283">			final UUID id = (UUID)rs.getObject(&quot;id&quot;);</span>
<span class="fc" id="L2284">			info.setId(id);</span>
<span class="nc" id="L2285">		} catch (final SQLException e) {</span>
<span class="nc" id="L2286">			logger.debug(&quot;SQL Exception in deserializeJavaOperation&quot;, e);</span>
<span class="fc" id="L2287">		}</span>
<span class="fc" id="L2288">		return info;</span>
	}

	/**
	 * Deserialize PythonOperationInfo
	 * @param rs
	 *            Result set
	 * @return PythonOperationInfo
	 */
	private PythonOperationInfo deserializePythonOperation(final ResultSet rs) {
<span class="nc" id="L2298">		final PythonOperationInfo info = new PythonOperationInfo(); // no fields</span>
		try {
<span class="nc" id="L2300">			final UUID id = (UUID)rs.getObject(&quot;id&quot;);</span>
<span class="nc" id="L2301">			info.setId(id);</span>
<span class="nc" id="L2302">		} catch (final SQLException e) {</span>
<span class="nc" id="L2303">			logger.debug(&quot;SQL Exception in deserializePythonOperation&quot;, e);</span>
<span class="nc" id="L2304">		}</span>
<span class="nc" id="L2305">		return info;</span>
	}

	/**
	 * Deserialize metaclass
	 * @param rs
	 *            Result set
	 * @return MetaClass
	 */
	private MetaClass deserializeMetaClass(
			final ResultSet rs) {
<span class="fc" id="L2316">		MetaClass metaClass = null;</span>
		try {
			// CHECKSTYLE:OFF
<span class="fc" id="L2319">			final MetaClassID classID = new MetaClassID((UUID)rs.getObject(&quot;id&quot;));</span>
<span class="fc" id="L2320">			final String namespace = rs.getString(&quot;namespace&quot;);</span>
<span class="fc" id="L2321">			final String name = rs.getString(&quot;name&quot;);</span>
<span class="fc" id="L2322">			final UUID parentTypeID = (UUID)rs.getObject(&quot;parentType&quot;);</span>
<span class="fc" id="L2323">			UserType parentType = null;</span>
<span class="pc bpc" id="L2324" title="1 of 2 branches missed.">			if (parentTypeID != null) {</span>
<span class="nc" id="L2325">				parentType = (UserType) getTypeByID(parentTypeID);</span>
			}

<span class="fc" id="L2328">			Array sqlArray = rs.getArray(&quot;properties&quot;);</span>
<span class="fc" id="L2329">			final SortedSet&lt;Property&gt; properties = new TreeSet&lt;&gt;();</span>
<span class="pc bpc" id="L2330" title="1 of 2 branches missed.">			if (sqlArray != null) {</span>
<span class="fc" id="L2331">				final UUID[] uuidArray = (UUID[]) sqlArray.getArray();</span>
<span class="fc bfc" id="L2332" title="All 2 branches covered.">				for (final UUID propUUID : uuidArray) {</span>
<span class="fc" id="L2333">					final Property prop = getPropertyByID(propUUID);</span>
<span class="fc" id="L2334">					properties.add(prop);</span>
				}
			}

<span class="fc" id="L2338">			sqlArray = rs.getArray(&quot;operations&quot;);</span>
<span class="fc" id="L2339">			final Set&lt;Operation&gt; operations = new HashSet&lt;&gt;();</span>
<span class="fc bfc" id="L2340" title="All 2 branches covered.">			if (sqlArray != null) {</span>
<span class="fc" id="L2341">				final UUID[] uuidArray = (UUID[]) sqlArray.getArray();</span>
<span class="fc bfc" id="L2342" title="All 2 branches covered.">				for (final UUID propUUID : uuidArray) {</span>
<span class="fc" id="L2343">					final Operation op = getOperationByID(propUUID);</span>
<span class="fc" id="L2344">					operations.add(op);</span>
				}
			}

<span class="fc" id="L2348">			final boolean isAbstract = rs.getBoolean(&quot;isAbstract&quot;);</span>
<span class="fc" id="L2349">			final NamespaceID namespaceID = new NamespaceID((UUID)rs.getObject(&quot;namespaceID&quot;));</span>

<span class="fc" id="L2351">			sqlArray = rs.getArray(&quot;extendedtypes&quot;);</span>
<span class="fc" id="L2352">			final Array extensionsArray = rs.getArray(&quot;extensions&quot;);</span>
<span class="fc" id="L2353">			final String[] typesNames = (String[]) sqlArray.getArray();</span>
<span class="fc" id="L2354">			final UUID[] uuidArray = (UUID[]) extensionsArray.getArray();</span>
<span class="fc" id="L2355">			final Map&lt;Langs, LanguageDependantClassInfo&gt; extensions = new HashMap&lt;&gt;();</span>
<span class="fc bfc" id="L2356" title="All 2 branches covered.">			for (int i = 0; i &lt; typesNames.length; ++i) {</span>
<span class="pc bpc" id="L2357" title="1 of 2 branches missed.">				if (typesNames[i].equals(Langs.LANG_JAVA.name())) {</span>
<span class="fc" id="L2358">					final JavaClassInfo info = this.getJavaClassByID(uuidArray[i]);</span>
<span class="fc" id="L2359">					extensions.put(Langs.LANG_JAVA, info);</span>
<span class="pc bnc" id="L2360" title="All 2 branches missed.">				} else if (typesNames[i].equals(Langs.LANG_PYTHON.name())) {</span>
<span class="nc" id="L2361">					final PythonClassInfo info = this.getPythonClassByID(uuidArray[i]);</span>
<span class="nc" id="L2362">					extensions.put(Langs.LANG_PYTHON, info);</span>
				}
			}

<span class="fc" id="L2366">			metaClass = new MetaClass(namespace, name,</span>
					parentType, isAbstract);

<span class="fc" id="L2369">			metaClass.setDataClayID(classID);</span>
<span class="fc" id="L2370">			metaClass.setLanguageDepInfos(extensions);</span>
<span class="fc" id="L2371">			metaClass.setNamespaceID(namespaceID);</span>
<span class="fc" id="L2372">			metaClass.setOperations(operations);</span>
<span class="fc" id="L2373">			metaClass.setProperties(properties);</span>

<span class="nc" id="L2375">		} catch (final SQLException e) {</span>
<span class="nc" id="L2376">			logger.debug(&quot;SQL Exception in deserializeMetaClass&quot;, e);</span>
<span class="fc" id="L2377">		}</span>
<span class="fc" id="L2378">		return metaClass;</span>
	}

	/**
	 * Deserialize JavaClassInfo
	 * @param rs
	 *            Result set
	 * @return JavaClassInfo
	 */
	private JavaClassInfo deserializeJavaClass(final ResultSet rs) {
<span class="fc" id="L2388">		JavaClassInfo info = null;</span>
		try {
<span class="fc" id="L2390">			final String signature = rs.getString(&quot;signature&quot;);</span>
<span class="fc" id="L2391">			final Array sqlArray = rs.getArray(&quot;javaParentInterfaces&quot;);</span>
<span class="fc" id="L2392">			String[] javaParentInterfaces = null;</span>
<span class="pc bpc" id="L2393" title="1 of 2 branches missed.">			if (sqlArray != null) {</span>
<span class="nc" id="L2394">				javaParentInterfaces = (String[]) sqlArray.getArray();</span>
			}
<span class="fc" id="L2396">			final byte[] bytecode = rs.getBytes(&quot;classByteCode&quot;);</span>

<span class="fc" id="L2398">			info = new JavaClassInfo(signature, bytecode);</span>
<span class="fc" id="L2399">			info.setJavaParentInterfaces(javaParentInterfaces);</span>
<span class="fc" id="L2400">			final UUID id = (UUID)rs.getObject(&quot;id&quot;);</span>
<span class="fc" id="L2401">			int modifier = rs.getInt(&quot;modifier&quot;);</span>
<span class="fc" id="L2402">			info.setId(id);</span>
<span class="fc" id="L2403">			info.setModifier(modifier);</span>
<span class="nc" id="L2404">		} catch (final SQLException e) {</span>

<span class="nc" id="L2406">			logger.debug(&quot;SQL Exception in deserializeJavaClass&quot;, e);</span>
<span class="fc" id="L2407">		}</span>
<span class="fc" id="L2408">		return info;</span>
	}

	/**
	 * Deserialize PythonClassInfo
	 * @param rs
	 *            Result set
	 * @return PythonClassInfo
	 */
	private PythonClassInfo deserializePythonClass(final ResultSet rs) {
<span class="nc" id="L2418">		PythonClassInfo info = null;</span>
		try {
<span class="nc" id="L2420">			final Array sqlArray = rs.getArray(&quot;importx&quot;);</span>
<span class="nc" id="L2421">			final List&lt;String&gt; importx = new ArrayList&lt;&gt;();</span>
<span class="nc bnc" id="L2422" title="All 2 branches missed.">			if (sqlArray != null) {</span>
<span class="nc bnc" id="L2423" title="All 2 branches missed.">				for (final String str : (String[]) sqlArray.getArray()) {</span>
<span class="nc" id="L2424">					importx.add(str);</span>
				}
			}

<span class="nc" id="L2428">			info = new PythonClassInfo(importx);</span>
<span class="nc" id="L2429">			final UUID id = (UUID)rs.getObject(&quot;id&quot;);</span>
<span class="nc" id="L2430">			info.setId(id);</span>
<span class="nc" id="L2431">		} catch (final SQLException e) {</span>
<span class="nc" id="L2432">			logger.debug(&quot;SQL Exception in deserializePythonClass&quot;, e);</span>
<span class="nc" id="L2433">		}</span>
<span class="nc" id="L2434">		return info;</span>
	}

	/**
	 * Get Type by ID
	 * @param typeID
	 *            ID of the type
	 * @return The type
	 * @throws SQLException
	 *             if type not found
	 */
	public Type getTypeByID(final UUID typeID) throws SQLException {
<span class="fc" id="L2446">		synchronized (dataSource) {</span>
<span class="fc" id="L2447">			ResultSet rs = null;</span>
<span class="fc" id="L2448">			Type type = null;</span>
<span class="fc" id="L2449">			Connection conn = null;</span>
			try {
<span class="fc" id="L2451">				conn = dataSource.getConnection();</span>
<span class="fc" id="L2452">				final PreparedStatement selectStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.SELECT_TYPE_BY_ID.getSqlStatement());</span>

<span class="fc" id="L2454">				selectStatement.setObject(1, typeID);</span>
<span class="pc bpc" id="L2455" title="1 of 2 branches missed.">				if (DEBUG_ENABLED) {</span>
<span class="nc" id="L2456">					logger.debug(&quot;[==DB==] Executing &quot; + selectStatement + &quot;(&quot; + typeID + &quot;)&quot;);</span>
				}
<span class="fc" id="L2458">				rs = selectStatement.executeQuery();</span>
<span class="fc bfc" id="L2459" title="All 2 branches covered.">				if (rs.next()) {</span>
<span class="fc" id="L2460">					type = deserializeType(rs);</span>
				}
<span class="fc" id="L2462">				selectStatement.close();</span>
<span class="nc" id="L2463">			} catch (final SQLException e) {</span>
<span class="nc" id="L2464">				throw e;</span>
			} finally {
				try {
<span class="pc bpc" id="L2467" title="1 of 2 branches missed.">					if (conn != null) {</span>
<span class="fc" id="L2468">						conn.close();</span>
					}
<span class="nc" id="L2470">				} catch (final SQLException e) {</span>
<span class="nc" id="L2471">					logger.debug(&quot;SQL Exception in getTypeByID&quot;, e);</span>
<span class="fc" id="L2472">				}</span>
			}

<span class="fc" id="L2475">			return type;</span>
		}
	}

	/**
	 * Get JavaTypeInfo by ID
	 * @param uuid
	 *            ID
	 * @return The JavaTypeInfo
	 * @throws SQLException
	 *             if type not found
	 */
	private JavaTypeInfo getJavaTypeByID(final UUID uuid) throws SQLException {
<span class="nc" id="L2488">		ResultSet rs = null;</span>
<span class="nc" id="L2489">		JavaTypeInfo type = null;</span>
<span class="nc" id="L2490">		Connection conn = null;</span>
		try {
<span class="nc" id="L2492">			conn = dataSource.getConnection();</span>
<span class="nc" id="L2493">			final PreparedStatement selectStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.SELECT_JAVA_TYPE_BY_ID.getSqlStatement());</span>

<span class="nc" id="L2495">			selectStatement.setObject(1, uuid);</span>
<span class="nc bnc" id="L2496" title="All 2 branches missed.">			if (DEBUG_ENABLED) {</span>
<span class="nc" id="L2497">				logger.debug(&quot;[==DB==] Executing &quot; + selectStatement);</span>
			}
<span class="nc" id="L2499">			rs = selectStatement.executeQuery();</span>
<span class="nc bnc" id="L2500" title="All 2 branches missed.">			if (rs.next()) {</span>
<span class="nc" id="L2501">				type = deserializeJavaType(rs);</span>
			}
<span class="nc" id="L2503">			selectStatement.close();</span>
<span class="nc" id="L2504">		} catch (final SQLException e) {</span>
<span class="nc" id="L2505">			throw e;</span>
		} finally {
			try {
<span class="nc bnc" id="L2508" title="All 2 branches missed.">				if (conn != null) {</span>
<span class="nc" id="L2509">					conn.close();</span>
				}
<span class="nc" id="L2511">			} catch (final SQLException ex1) {</span>
<span class="nc" id="L2512">				logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L2513">			}</span>
		}

<span class="nc" id="L2516">		return type;</span>
	}

	/**
	 * Get PythonTypeInfo by ID
	 * @param uuid
	 *            ID
	 * @return The PythonTypeInfo
	 * @throws SQLException
	 *             if type not found
	 */
	private PythonTypeInfo getPythonTypeByID(final UUID uuid) throws SQLException {
<span class="nc" id="L2528">		ResultSet rs = null;</span>
<span class="nc" id="L2529">		PythonTypeInfo type = null;</span>
<span class="nc" id="L2530">		Connection conn = null;</span>
		try {
<span class="nc" id="L2532">			conn = dataSource.getConnection();</span>
<span class="nc" id="L2533">			final PreparedStatement selectStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.SELECT_PYTHON_TYPE_BY_ID.getSqlStatement());</span>

<span class="nc" id="L2535">			selectStatement.setObject(1, uuid);</span>
<span class="nc bnc" id="L2536" title="All 2 branches missed.">			if (DEBUG_ENABLED) {</span>
<span class="nc" id="L2537">				logger.debug(&quot;[==DB==] Executing &quot; + selectStatement);</span>
			}
<span class="nc" id="L2539">			rs = selectStatement.executeQuery();</span>
<span class="nc bnc" id="L2540" title="All 2 branches missed.">			if (rs.next()) {</span>
<span class="nc" id="L2541">				type = deserializePythonType(rs);</span>
			}
<span class="nc" id="L2543">			selectStatement.close();</span>
<span class="nc" id="L2544">		} catch (final SQLException e) {</span>
<span class="nc" id="L2545">			throw e;</span>
		} finally {
			try {
<span class="nc bnc" id="L2548" title="All 2 branches missed.">				if (conn != null) {</span>
<span class="nc" id="L2549">					conn.close();</span>
				}
<span class="nc" id="L2551">			} catch (final SQLException ex1) {</span>
<span class="nc" id="L2552">				logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L2553">			}</span>
		}

<span class="nc" id="L2556">		return type;</span>
	}

	/**
	 * Get Property by ID
	 * @param propertyID
	 *            ID of the Property
	 * @return The Property
	 * @throws SQLException
	 *             if type not found
	 */
	private Property getPropertyByID(final UUID propertyID) throws SQLException {
<span class="fc" id="L2568">		ResultSet rs = null;</span>
<span class="fc" id="L2569">		Property property = null;</span>
<span class="fc" id="L2570">		Connection conn = null;</span>
		try {
<span class="fc" id="L2572">			conn = dataSource.getConnection();</span>
<span class="fc" id="L2573">			final PreparedStatement selectStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.SELECT_PROPERTY_BY_ID.getSqlStatement());</span>

<span class="fc" id="L2575">			selectStatement.setObject(1, propertyID);</span>
<span class="pc bpc" id="L2576" title="1 of 2 branches missed.">			if (DEBUG_ENABLED) {</span>
<span class="nc" id="L2577">				logger.debug(&quot;[==DB==] Executing &quot; + selectStatement);</span>
			}
<span class="fc" id="L2579">			rs = selectStatement.executeQuery();</span>
<span class="pc bpc" id="L2580" title="1 of 2 branches missed.">			if (rs.next()) {</span>
<span class="fc" id="L2581">				property = deserializeProperty(rs);</span>
			}
<span class="fc" id="L2583">			selectStatement.close();</span>
<span class="nc" id="L2584">		} catch (final SQLException e) {</span>
<span class="nc" id="L2585">			throw e;</span>
		} finally {
			try {
<span class="pc bpc" id="L2588" title="1 of 2 branches missed.">				if (conn != null) {</span>
<span class="fc" id="L2589">					conn.close();</span>
				}
<span class="nc" id="L2591">			} catch (final SQLException ex1) {</span>
<span class="nc" id="L2592">				logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="fc" id="L2593">			}</span>
		}
<span class="fc" id="L2595">		return property;</span>
	}

	/**
	 * Get Annotation by ID
	 * @param annotationID
	 *            ID of the Property
	 * @return The annotation
	 * @throws SQLException
	 *             if annotation not found
	 */
	private Annotation getAnnotationByID(final UUID annotationID) throws SQLException {
<span class="nc" id="L2607">		ResultSet rs = null;</span>
<span class="nc" id="L2608">		Annotation annotation = null;</span>
<span class="nc" id="L2609">		Connection conn = null;</span>
		try {
<span class="nc" id="L2611">			conn = dataSource.getConnection();</span>
<span class="nc" id="L2612">			final PreparedStatement selectStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.SELECT_ANNOTATION_BY_ID.getSqlStatement());</span>

<span class="nc" id="L2614">			selectStatement.setObject(1, annotationID);</span>
<span class="nc bnc" id="L2615" title="All 2 branches missed.">			if (DEBUG_ENABLED) {</span>
<span class="nc" id="L2616">				logger.debug(&quot;[==DB==] Executing &quot; + selectStatement);</span>
			}
<span class="nc" id="L2618">			rs = selectStatement.executeQuery();</span>
<span class="nc bnc" id="L2619" title="All 2 branches missed.">			if (rs.next()) {</span>
<span class="nc" id="L2620">				annotation = deserializeAnnotation(rs);</span>
			}
<span class="nc" id="L2622">			selectStatement.close();</span>
<span class="nc" id="L2623">		} catch (final SQLException e) {</span>
<span class="nc" id="L2624">			logger.debug(&quot;SQL Exception in getAnnotationByID&quot;, e);</span>
<span class="nc" id="L2625">			throw e;</span>
		} finally {
			try {
<span class="nc bnc" id="L2628" title="All 2 branches missed.">				if (conn != null) {</span>
<span class="nc" id="L2629">					conn.close();</span>
				}
<span class="nc" id="L2631">			} catch (final SQLException ex1) {</span>
<span class="nc" id="L2632">				logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L2633">			}</span>
		}

<span class="nc" id="L2636">		return annotation;</span>
	}

	/**
	 * Get JavaPropertyInfo by ID
	 * @param uuid
	 *            ID of the JavaPropertyInfo
	 * @return The JavaPropertyInfo
	 * @throws SQLException
	 *             if JavaPropertyInfo not found
	 */
	private JavaPropertyInfo getJavaPropertyByID(final UUID uuid) throws SQLException {
<span class="fc" id="L2648">		ResultSet rs = null;</span>
<span class="fc" id="L2649">		JavaPropertyInfo property = null;</span>
<span class="fc" id="L2650">		Connection conn = null;</span>
		try {
<span class="fc" id="L2652">			conn = dataSource.getConnection();</span>
<span class="fc" id="L2653">			final PreparedStatement selectStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.SELECT_JAVA_PROPERTY_BY_ID.getSqlStatement());</span>

<span class="fc" id="L2655">			selectStatement.setObject(1, uuid);</span>
<span class="pc bpc" id="L2656" title="1 of 2 branches missed.">			if (DEBUG_ENABLED) {</span>
<span class="nc" id="L2657">				logger.debug(&quot;[==DB==] Executing &quot; + selectStatement);</span>
			}
<span class="fc" id="L2659">			rs = selectStatement.executeQuery();</span>
<span class="pc bpc" id="L2660" title="1 of 2 branches missed.">			if (rs.next()) {</span>
<span class="fc" id="L2661">				property = deserializeJavaProperty(rs);</span>
			}
<span class="fc" id="L2663">			selectStatement.close();</span>
<span class="nc" id="L2664">		} catch (final SQLException e) {</span>
<span class="nc" id="L2665">			throw e;</span>
		} finally {
			try {
<span class="pc bpc" id="L2668" title="1 of 2 branches missed.">				if (conn != null) {</span>
<span class="fc" id="L2669">					conn.close();</span>
				}
<span class="nc" id="L2671">			} catch (final SQLException ex1) {</span>
<span class="nc" id="L2672">				logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="fc" id="L2673">			}</span>
		}

<span class="fc" id="L2676">		return property;</span>
	}

	/**
	 * Get PythonPropertyInfo by ID
	 * @param uuid
	 *            ID of the PythonPropertyInfo
	 * @return The PythonPropertyInfo
	 * @throws SQLException
	 *             if PythonPropertyInfo not found
	 */
	private PythonPropertyInfo getPythonPropertyByID(final UUID uuid) throws SQLException {
<span class="nc" id="L2688">		ResultSet rs = null;</span>
<span class="nc" id="L2689">		PythonPropertyInfo property = null;</span>
<span class="nc" id="L2690">		Connection conn = null;</span>
		try {
<span class="nc" id="L2692">			conn = dataSource.getConnection();</span>
<span class="nc" id="L2693">			final PreparedStatement selectStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.SELECT_PYTHON_PROPERTY_BY_ID.getSqlStatement());</span>

<span class="nc" id="L2695">			selectStatement.setObject(1, uuid);</span>
<span class="nc bnc" id="L2696" title="All 2 branches missed.">			if (DEBUG_ENABLED) {</span>
<span class="nc" id="L2697">				logger.debug(&quot;[==DB==] Executing &quot; + selectStatement);</span>
			}
<span class="nc" id="L2699">			rs = selectStatement.executeQuery();</span>
<span class="nc bnc" id="L2700" title="All 2 branches missed.">			if (rs.next()) {</span>
<span class="nc" id="L2701">				property = deserializePythonProperty(rs);</span>
			}
<span class="nc" id="L2703">			selectStatement.close();</span>
<span class="nc" id="L2704">		} catch (final SQLException e) {</span>
<span class="nc" id="L2705">			throw e;</span>
		} finally {
			try {
<span class="nc bnc" id="L2708" title="All 2 branches missed.">				if (conn != null) {</span>
<span class="nc" id="L2709">					conn.close();</span>
				}
<span class="nc" id="L2711">			} catch (final SQLException ex1) {</span>
<span class="nc" id="L2712">				logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L2713">			}</span>
		}

<span class="nc" id="L2716">		return property;</span>
	}

	/**
	 * Get AccessedImplementation by ID
	 * @param uuid
	 *            ID of the AccessedImplementation
	 * @return The AccessedImplementation
	 * @throws SQLException
	 *             if type not found
	 */
	private AccessedImplementation getAccessedImplementationByID(final UUID uuid) throws SQLException {
<span class="nc" id="L2728">		ResultSet rs = null;</span>
<span class="nc" id="L2729">		AccessedImplementation result = null;</span>
<span class="nc" id="L2730">		Connection conn = null;</span>
		try {
<span class="nc" id="L2732">			conn = dataSource.getConnection();</span>
<span class="nc" id="L2733">			final PreparedStatement selectStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.SELECT_ACCESSED_IMPL_BY_ID.getSqlStatement());</span>

<span class="nc" id="L2735">			selectStatement.setObject(1, uuid);</span>
<span class="nc bnc" id="L2736" title="All 2 branches missed.">			if (DEBUG_ENABLED) {</span>
<span class="nc" id="L2737">				logger.debug(&quot;[==DB==] Executing &quot; + selectStatement);</span>
			}
<span class="nc" id="L2739">			rs = selectStatement.executeQuery();</span>
<span class="nc bnc" id="L2740" title="All 2 branches missed.">			if (rs.next()) {</span>
<span class="nc" id="L2741">				result = deserializeAccessedImplementation(rs);</span>
			}
<span class="nc" id="L2743">			selectStatement.close();</span>
<span class="nc" id="L2744">		} catch (final SQLException e) {</span>
<span class="nc" id="L2745">			throw e;</span>
		} finally {
			try {
<span class="nc bnc" id="L2748" title="All 2 branches missed.">				if (conn != null) {</span>
<span class="nc" id="L2749">					conn.close();</span>
				}
<span class="nc" id="L2751">			} catch (final SQLException ex1) {</span>
<span class="nc" id="L2752">				logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L2753">			}</span>
		}

<span class="nc" id="L2756">		return result;</span>
	}

	/**
	 * Get AccessedProperty by ID
	 * @param uuid
	 *            ID of the AccessedProperty
	 * @return The AccessedProperty
	 * @throws SQLException
	 *             if type not found
	 */
	private AccessedProperty getAccessedPropertyByID(final UUID uuid) throws SQLException {
<span class="fc" id="L2768">		ResultSet rs = null;</span>
<span class="fc" id="L2769">		AccessedProperty result = null;</span>
<span class="fc" id="L2770">		Connection conn = null;</span>
		try {
<span class="fc" id="L2772">			conn = dataSource.getConnection();</span>
<span class="fc" id="L2773">			final PreparedStatement selectStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.SELECT_ACCESSED_PROP_BY_ID.getSqlStatement());</span>

<span class="fc" id="L2775">			selectStatement.setObject(1, uuid);</span>
<span class="pc bpc" id="L2776" title="1 of 2 branches missed.">			if (DEBUG_ENABLED) {</span>
<span class="nc" id="L2777">				logger.debug(&quot;[==DB==] Executing &quot; + selectStatement);</span>
			}
<span class="fc" id="L2779">			rs = selectStatement.executeQuery();</span>
<span class="pc bpc" id="L2780" title="1 of 2 branches missed.">			if (rs.next()) {</span>
<span class="fc" id="L2781">				result = deserializeAccessedProperty(rs);</span>
			}
<span class="fc" id="L2783">			selectStatement.close();</span>
<span class="nc" id="L2784">		} catch (final SQLException e) {</span>
<span class="nc" id="L2785">			throw e;</span>
		} finally {
			try {
<span class="pc bpc" id="L2788" title="1 of 2 branches missed.">				if (conn != null) {</span>
<span class="fc" id="L2789">					conn.close();</span>
				}
<span class="nc" id="L2791">			} catch (final SQLException ex1) {</span>
<span class="nc" id="L2792">				logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="fc" id="L2793">			}</span>
		}

<span class="fc" id="L2796">		return result;</span>
	}

	/**
	 * Get MemoryFeature by ID
	 * @param uuid
	 *            ID of the MemoryFeature
	 * @return The MemoryFeature
	 * @throws SQLException
	 *             if type not found
	 */
	private MemoryFeature getMemoryFeatureByID(final UUID uuid) throws SQLException {
<span class="nc" id="L2808">		ResultSet rs = null;</span>
<span class="nc" id="L2809">		MemoryFeature result = null;</span>
<span class="nc" id="L2810">		Connection conn = null;</span>
		try {
<span class="nc" id="L2812">			conn = dataSource.getConnection();</span>
<span class="nc" id="L2813">			final PreparedStatement selectStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.SELECT_MEMORY_FEATURE_BY_ID.getSqlStatement());</span>

<span class="nc" id="L2815">			selectStatement.setObject(1, uuid);</span>
<span class="nc bnc" id="L2816" title="All 2 branches missed.">			if (DEBUG_ENABLED) {</span>
<span class="nc" id="L2817">				logger.debug(&quot;[==DB==] Executing &quot; + selectStatement);</span>
			}
<span class="nc" id="L2819">			rs = selectStatement.executeQuery();</span>
<span class="nc bnc" id="L2820" title="All 2 branches missed.">			if (rs.next()) {</span>
<span class="nc" id="L2821">				result = deserializeMemoryFeature(rs);</span>
			}
<span class="nc" id="L2823">			selectStatement.close();</span>
<span class="nc" id="L2824">		} catch (final SQLException e) {</span>
<span class="nc" id="L2825">			throw e;</span>
		} finally {
			try {
<span class="nc bnc" id="L2828" title="All 2 branches missed.">				if (conn != null) {</span>
<span class="nc" id="L2829">					conn.close();</span>
				}
<span class="nc" id="L2831">			} catch (final SQLException ex1) {</span>
<span class="nc" id="L2832">				logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L2833">			}</span>
		}

<span class="nc" id="L2836">		return result;</span>
	}

	/**
	 * Get CPUFeature by ID
	 * @param uuid
	 *            ID of the CPUFeature
	 * @return The CPUFeature
	 * @throws SQLException
	 *             if type not found
	 */
	private CPUFeature getCPUFeatureByID(final UUID uuid) throws SQLException {
<span class="nc" id="L2848">		ResultSet rs = null;</span>
<span class="nc" id="L2849">		CPUFeature result = null;</span>
<span class="nc" id="L2850">		Connection conn = null;</span>
		try {
<span class="nc" id="L2852">			conn = dataSource.getConnection();</span>
<span class="nc" id="L2853">			final PreparedStatement selectStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.SELECT_CPU_FEATURE_BY_ID.getSqlStatement());</span>

<span class="nc" id="L2855">			selectStatement.setObject(1, uuid);</span>
<span class="nc bnc" id="L2856" title="All 2 branches missed.">			if (DEBUG_ENABLED) {</span>
<span class="nc" id="L2857">				logger.debug(&quot;[==DB==] Executing &quot; + selectStatement);</span>
			}
<span class="nc" id="L2859">			rs = selectStatement.executeQuery();</span>
<span class="nc bnc" id="L2860" title="All 2 branches missed.">			if (rs.next()) {</span>
<span class="nc" id="L2861">				result = deserializeCPUFeature(rs);</span>
			}
<span class="nc" id="L2863">			selectStatement.close();</span>
<span class="nc" id="L2864">		} catch (final SQLException e) {</span>
<span class="nc" id="L2865">			throw e;</span>
		} finally {
			try {
<span class="nc bnc" id="L2868" title="All 2 branches missed.">				if (conn != null) {</span>
<span class="nc" id="L2869">					conn.close();</span>
				}
<span class="nc" id="L2871">			} catch (final SQLException ex1) {</span>
<span class="nc" id="L2872">				logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L2873">			}</span>
		}

<span class="nc" id="L2876">		return result;</span>
	}

	/**
	 * Get LanguageFeature by ID
	 * @param uuid
	 *            ID of the LanguageFeature
	 * @return The LanguageFeature
	 * @throws SQLException
	 *             if type not found
	 */
	private LanguageFeature getLanguageFeatureByID(final UUID uuid) throws SQLException {
<span class="fc" id="L2888">		ResultSet rs = null;</span>
<span class="fc" id="L2889">		LanguageFeature result = null;</span>
<span class="fc" id="L2890">		Connection conn = null;</span>
		try {
<span class="fc" id="L2892">			conn = dataSource.getConnection();</span>
<span class="fc" id="L2893">			final PreparedStatement selectStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.SELECT_LANGUAGE_FEATURE_BY_ID.getSqlStatement());</span>

<span class="fc" id="L2895">			selectStatement.setObject(1, uuid);</span>
<span class="pc bpc" id="L2896" title="1 of 2 branches missed.">			if (DEBUG_ENABLED) {</span>
<span class="nc" id="L2897">				logger.debug(&quot;[==DB==] Executing &quot; + selectStatement);</span>
			}
<span class="fc" id="L2899">			rs = selectStatement.executeQuery();</span>
<span class="pc bpc" id="L2900" title="1 of 2 branches missed.">			if (rs.next()) {</span>
<span class="fc" id="L2901">				result = deserializeLanguageFeature(rs);</span>
			}
<span class="fc" id="L2903">			selectStatement.close();</span>
<span class="nc" id="L2904">		} catch (final SQLException e) {</span>
<span class="nc" id="L2905">			throw e;</span>
		} finally {
			try {
<span class="pc bpc" id="L2908" title="1 of 2 branches missed.">				if (conn != null) {</span>
<span class="fc" id="L2909">					conn.close();</span>
				}
<span class="nc" id="L2911">			} catch (final SQLException ex1) {</span>
<span class="nc" id="L2912">				logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="fc" id="L2913">			}</span>
		}

<span class="fc" id="L2916">		return result;</span>
	}

	/**
	 * Get ArchitectureFeature by ID
	 * @param uuid
	 *            ID of the ArchitectureFeature
	 * @return The ArchitectureFeature
	 * @throws SQLException
	 *             if type not found
	 */
	private ArchitectureFeature getArchitectureFeatureByID(final UUID uuid) throws SQLException {
<span class="nc" id="L2928">		ResultSet rs = null;</span>
<span class="nc" id="L2929">		ArchitectureFeature result = null;</span>
<span class="nc" id="L2930">		Connection conn = null;</span>
		try {
<span class="nc" id="L2932">			conn = dataSource.getConnection();</span>
<span class="nc" id="L2933">			final PreparedStatement selectStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.SELECT_ARCH_FEATURE_BY_ID.getSqlStatement());</span>

<span class="nc" id="L2935">			selectStatement.setObject(1, uuid);</span>
<span class="nc bnc" id="L2936" title="All 2 branches missed.">			if (DEBUG_ENABLED) {</span>
<span class="nc" id="L2937">				logger.debug(&quot;[==DB==] Executing &quot; + selectStatement);</span>
			}
<span class="nc" id="L2939">			rs = selectStatement.executeQuery();</span>
<span class="nc bnc" id="L2940" title="All 2 branches missed.">			if (rs.next()) {</span>
<span class="nc" id="L2941">				result = deserializeArchitectureFeature(rs);</span>
			}
<span class="nc" id="L2943">			selectStatement.close();</span>
<span class="nc" id="L2944">		} catch (final SQLException e) {</span>
<span class="nc" id="L2945">			throw e;</span>
		} finally {
			try {
<span class="nc bnc" id="L2948" title="All 2 branches missed.">				if (conn != null) {</span>
<span class="nc" id="L2949">					conn.close();</span>
				}
<span class="nc" id="L2951">			} catch (final SQLException ex1) {</span>
<span class="nc" id="L2952">				logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L2953">			}</span>
		}

<span class="nc" id="L2956">		return result;</span>
	}

	/**
	 * Get PrefetchingInformation by ID
	 * @param uuid
	 *            ID of the PrefetchingInformation
	 * @return The PrefetchingInformation
	 * @throws SQLException
	 *             if type not found
	 */
	private PrefetchingInformation getPrefetchingInfoByID(final UUID uuid) throws SQLException {
<span class="fc" id="L2968">		ResultSet rs = null;</span>
<span class="fc" id="L2969">		PrefetchingInformation result = null;</span>
<span class="fc" id="L2970">		Connection conn = null;</span>
		try {
<span class="fc" id="L2972">			conn = dataSource.getConnection();</span>
<span class="fc" id="L2973">			final PreparedStatement selectStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.SELECT_PREFETCHING_INFO_BY_ID.getSqlStatement());</span>

<span class="fc" id="L2975">			selectStatement.setObject(1, uuid);</span>
<span class="pc bpc" id="L2976" title="1 of 2 branches missed.">			if (DEBUG_ENABLED) {</span>
<span class="nc" id="L2977">				logger.debug(&quot;[==DB==] Executing &quot; + selectStatement);</span>
			}
<span class="fc" id="L2979">			rs = selectStatement.executeQuery();</span>
<span class="pc bpc" id="L2980" title="1 of 2 branches missed.">			if (rs.next()) {</span>
<span class="fc" id="L2981">				result = deserializePrefetchingInfo(rs);</span>
			}
<span class="fc" id="L2983">			selectStatement.close();</span>
<span class="nc" id="L2984">		} catch (final SQLException e) {</span>
<span class="nc" id="L2985">			throw e;</span>
		} finally {
			try {
<span class="pc bpc" id="L2988" title="1 of 2 branches missed.">				if (conn != null) {</span>
<span class="fc" id="L2989">					conn.close();</span>
				}
<span class="nc" id="L2991">			} catch (final SQLException ex1) {</span>
<span class="nc" id="L2992">				logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="fc" id="L2993">			}</span>
		}

<span class="fc" id="L2996">		return result;</span>
	}

	/**
	 * Given a PythonImplementationID, return specifically its code
	 * 
	 * @param uuid
	 *            ID of the PythonImplementation
	 * @return
	 * @throws SQLException
	 */
	private String getPythonCodeByImplementationID(final UUID uuid) throws SQLException {
<span class="nc" id="L3008">		ResultSet rs = null;</span>
<span class="nc" id="L3009">		String res = null;</span>
<span class="nc" id="L3010">		Connection conn = null;</span>
		try {
<span class="nc" id="L3012">			conn = dataSource.getConnection();</span>
<span class="nc" id="L3013">			final PreparedStatement selectStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.SELECT_PYTHON_CODE_BY_IMPLEMENTATION_ID.getSqlStatement());</span>

<span class="nc" id="L3015">			selectStatement.setObject(1, uuid);</span>
<span class="nc bnc" id="L3016" title="All 2 branches missed.">			if (DEBUG_ENABLED) {</span>
<span class="nc" id="L3017">				logger.debug(&quot;[==DB==] Executing &quot; + selectStatement);</span>
			}
<span class="nc" id="L3019">			rs = selectStatement.executeQuery();</span>
<span class="nc bnc" id="L3020" title="All 2 branches missed.">			if (rs.next()) {</span>
<span class="nc" id="L3021">				res = rs.getString(1);</span>
			}
<span class="nc" id="L3023">			selectStatement.close();</span>

<span class="nc" id="L3025">		} catch (final SQLException e) {</span>
<span class="nc" id="L3026">			throw e;</span>
		} finally {
			try {
<span class="nc bnc" id="L3029" title="All 2 branches missed.">				if (conn != null) {</span>
<span class="nc" id="L3030">					conn.close();</span>
				}
<span class="nc" id="L3032">			} catch (final SQLException ex1) {</span>
<span class="nc" id="L3033">				logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L3034">			}</span>
		}
<span class="nc" id="L3036">		return res;</span>
	}

	/**
	 * Get Implementation by ID
	 * @param uuid
	 *            ID of the Implementation
	 * @return The Implementation
	 * @throws SQLException
	 *             if Operation not found
	 */
	private Implementation getImplementationByID(final UUID uuid) throws SQLException {
<span class="fc" id="L3048">		ResultSet rs = null;</span>
<span class="fc" id="L3049">		Implementation info = null;</span>
<span class="fc" id="L3050">		Connection conn = null;</span>
		// TODO fix this: first tries java and then python
		try {
<span class="fc" id="L3053">			conn = dataSource.getConnection();</span>
<span class="fc" id="L3054">			PreparedStatement selectStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.SELECT_JAVA_IMPLEMENTATION_BY_ID.getSqlStatement());</span>

<span class="fc" id="L3056">			selectStatement.setObject(1, uuid);</span>
<span class="pc bpc" id="L3057" title="1 of 2 branches missed.">			if (DEBUG_ENABLED) {</span>
<span class="nc" id="L3058">				logger.debug(&quot;[==DB==] Executing &quot; + selectStatement);</span>
			}
<span class="fc" id="L3060">			rs = selectStatement.executeQuery();</span>
<span class="fc bfc" id="L3061" title="All 2 branches covered.">			if (rs.next()) {</span>
<span class="fc" id="L3062">				info = deserializeImplementation(&quot;java_implementation&quot;, rs);</span>
			}else {
<span class="fc" id="L3064">				conn = dataSource.getConnection();</span>
<span class="fc" id="L3065">				PreparedStatement selectStatement2 = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.SELECT_PYTHON_IMPLEMENTATION_BY_ID.getSqlStatement());</span>

<span class="fc" id="L3067">				selectStatement2.setObject(1, uuid);</span>
<span class="pc bpc" id="L3068" title="1 of 2 branches missed.">				if (DEBUG_ENABLED) {</span>
<span class="nc" id="L3069">					logger.debug(&quot;[==DB==] Executing &quot; + selectStatement2);</span>
				}
<span class="fc" id="L3071">				rs = selectStatement2.executeQuery();</span>
<span class="pc bpc" id="L3072" title="1 of 2 branches missed.">				if (rs.next()) {</span>
<span class="nc" id="L3073">					info = deserializeImplementation(&quot;python_implementation&quot;, rs);</span>
				}
<span class="fc" id="L3075">				selectStatement2.close();</span>

			}
<span class="fc" id="L3078">			selectStatement.close();</span>

<span class="nc" id="L3080">		} catch (final SQLException e) {</span>
<span class="nc" id="L3081">			e.printStackTrace();</span>
<span class="nc" id="L3082">			throw e;</span>
		} finally {
			try {
<span class="pc bpc" id="L3085" title="1 of 2 branches missed.">				if (conn != null) {</span>
<span class="fc" id="L3086">					conn.close();</span>
				}
<span class="nc" id="L3088">			} catch (final SQLException ex1) {</span>
<span class="nc" id="L3089">				logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="fc" id="L3090">			}</span>
		}

<span class="fc" id="L3093">		return info;</span>
	}

	/**
	 * Get Operation by ID
	 * @param uuid
	 *            ID of the Operation
	 * @return The Operation
	 * @throws SQLException
	 *             if Operation not found
	 */
	private Operation getOperationByID(final UUID uuid) throws SQLException {
<span class="fc" id="L3105">		ResultSet rs = null;</span>
<span class="fc" id="L3106">		Operation info = null;</span>
<span class="fc" id="L3107">		Connection conn = null;</span>
		try {
<span class="fc" id="L3109">			conn = dataSource.getConnection();</span>
<span class="fc" id="L3110">			final PreparedStatement selectStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.SELECT_OPERATION_BY_ID.getSqlStatement());</span>

<span class="fc" id="L3112">			selectStatement.setObject(1, uuid);</span>
<span class="pc bpc" id="L3113" title="1 of 2 branches missed.">			if (DEBUG_ENABLED) {</span>
<span class="nc" id="L3114">				logger.debug(&quot;[==DB==] Executing &quot; + selectStatement + &quot;(&quot; + uuid + &quot;)&quot;);</span>
			}
<span class="fc" id="L3116">			rs = selectStatement.executeQuery();</span>
<span class="fc bfc" id="L3117" title="All 2 branches covered.">			if (rs.next()) {</span>
<span class="fc" id="L3118">				info = deserializeOperation(rs);</span>
			}
<span class="fc" id="L3120">			selectStatement.close();</span>

<span class="nc" id="L3122">		} catch (final SQLException e) {</span>
<span class="nc" id="L3123">			throw e;</span>
		} finally {
			try {
<span class="pc bpc" id="L3126" title="1 of 2 branches missed.">				if (conn != null) {</span>
<span class="fc" id="L3127">					conn.close();</span>
				}
<span class="nc" id="L3129">			} catch (final SQLException ex1) {</span>
<span class="nc" id="L3130">				logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="fc" id="L3131">			}</span>
		}

<span class="fc" id="L3134">		return info;</span>
	}

	/**
	 * Get JavaOperationInfo by ID
	 * @param uuid
	 *            ID of the JavaOperationInfo
	 * @return The JavaOperationInfo
	 * @throws SQLException
	 *             if JavaOperationInfo not found
	 */
	private JavaOperationInfo getJavaOperationByID(final UUID uuid) throws SQLException {
<span class="fc" id="L3146">		ResultSet rs = null;</span>
<span class="fc" id="L3147">		JavaOperationInfo info = null;</span>
<span class="fc" id="L3148">		Connection conn = null;</span>
		try {
<span class="fc" id="L3150">			conn = dataSource.getConnection();</span>
<span class="fc" id="L3151">			final PreparedStatement selectStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.SELECT_JAVA_OPERATION_BY_ID.getSqlStatement());</span>

<span class="fc" id="L3153">			selectStatement.setObject(1, uuid);</span>
<span class="pc bpc" id="L3154" title="1 of 2 branches missed.">			if (DEBUG_ENABLED) {</span>
<span class="nc" id="L3155">				logger.debug(&quot;[==DB==] Executing &quot; + selectStatement);</span>
			}
<span class="fc" id="L3157">			rs = selectStatement.executeQuery();</span>
<span class="pc bpc" id="L3158" title="1 of 2 branches missed.">			if (rs.next()) {</span>
<span class="fc" id="L3159">				info = deserializeJavaOperation(rs);</span>
			}
<span class="fc" id="L3161">			selectStatement.close();</span>

<span class="nc" id="L3163">		} catch (final SQLException e) {</span>
<span class="nc" id="L3164">			throw e;</span>
		} finally {
			try {
<span class="pc bpc" id="L3167" title="1 of 2 branches missed.">				if (conn != null) {</span>
<span class="fc" id="L3168">					conn.close();</span>
				}
<span class="nc" id="L3170">			} catch (final SQLException ex1) {</span>
<span class="nc" id="L3171">				logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="fc" id="L3172">			}</span>
		}

<span class="fc" id="L3175">		return info;</span>
	}

	/**
	 * Get PythonOperationInfo by ID
	 * @param uuid
	 *            ID of the PythonOperationInfo
	 * @return The PythonOperationInfo
	 * @throws SQLException
	 *             if PythonOperationInfo not found
	 */
	private PythonOperationInfo getPythonOperationByID(final UUID uuid) throws SQLException {
<span class="nc" id="L3187">		ResultSet rs = null;</span>
<span class="nc" id="L3188">		PythonOperationInfo info = null;</span>
<span class="nc" id="L3189">		Connection conn = null;</span>
		try {
<span class="nc" id="L3191">			conn = dataSource.getConnection();</span>
<span class="nc" id="L3192">			final PreparedStatement selectStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.SELECT_PYTHON_OPERATION_BY_ID.getSqlStatement());</span>

<span class="nc" id="L3194">			selectStatement.setObject(1, uuid);</span>
<span class="nc bnc" id="L3195" title="All 2 branches missed.">			if (DEBUG_ENABLED) {</span>
<span class="nc" id="L3196">				logger.debug(&quot;[==DB==] Executing &quot; + selectStatement);</span>
			}
<span class="nc" id="L3198">			rs = selectStatement.executeQuery();</span>
<span class="nc bnc" id="L3199" title="All 2 branches missed.">			if (rs.next()) {</span>
<span class="nc" id="L3200">				info = deserializePythonOperation(rs);</span>
			}
<span class="nc" id="L3202">			selectStatement.close();</span>

<span class="nc" id="L3204">		} catch (final SQLException e) {</span>
<span class="nc" id="L3205">			throw e;</span>
		} finally {
			try {
<span class="nc bnc" id="L3208" title="All 2 branches missed.">				if (conn != null) {</span>
<span class="nc" id="L3209">					conn.close();</span>
				}
<span class="nc" id="L3211">			} catch (final SQLException ex1) {</span>
<span class="nc" id="L3212">				logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L3213">			}</span>
		}

<span class="nc" id="L3216">		return info;</span>
	}

	/**
	 * Get MetaClass by ID
	 * @param metaClassID
	 *            ID of the object
	 * @return The MetaClass
	 * @throws SQLException
	 *             if not found
	 */
	private MetaClass getMetaClassByID(final UUID metaClassID) throws SQLException {
<span class="fc" id="L3228">		ResultSet rs = null;</span>
<span class="fc" id="L3229">		MetaClass mClass = null;</span>
<span class="fc" id="L3230">		Connection conn = null;</span>
		try {
<span class="fc" id="L3232">			conn = dataSource.getConnection();</span>
<span class="fc" id="L3233">			final PreparedStatement selectStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.SELECT_METACLASS_BY_ID.getSqlStatement());</span>

<span class="fc" id="L3235">			selectStatement.setObject(1, metaClassID);</span>
<span class="pc bpc" id="L3236" title="1 of 2 branches missed.">			if (DEBUG_ENABLED) {</span>
<span class="nc" id="L3237">				logger.debug(&quot;[==DB==] Executing &quot; + selectStatement);</span>
			}
<span class="fc" id="L3239">			rs = selectStatement.executeQuery();</span>
<span class="pc bpc" id="L3240" title="1 of 2 branches missed.">			if (rs.next()) {</span>
<span class="fc" id="L3241">				mClass = deserializeMetaClass(rs);</span>
			}
<span class="fc" id="L3243">			selectStatement.close();</span>

<span class="nc" id="L3245">		} catch (final SQLException e) {</span>
<span class="nc" id="L3246">			logger.debug(&quot;SQL Exception in getMetaClassByID&quot;, e);</span>
<span class="nc" id="L3247">			throw e;</span>
		} finally {
			try {
<span class="pc bpc" id="L3250" title="1 of 2 branches missed.">				if (conn != null) {</span>
<span class="fc" id="L3251">					conn.close();</span>
				}
<span class="nc" id="L3253">			} catch (final SQLException ex1) {</span>
<span class="nc" id="L3254">				logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="fc" id="L3255">			}</span>
		}

<span class="fc" id="L3258">		return mClass;</span>
	}

	/**
	 * Get JavaClassInfo by ID
	 * @param uuid
	 *            ID of the JavaClassInfo
	 * @return The JavaClassInfo
	 * @throws SQLException
	 *             if JavaClassInfo not found
	 */
	private JavaClassInfo getJavaClassByID(final UUID uuid) throws SQLException {
<span class="fc" id="L3270">		ResultSet rs = null;</span>
<span class="fc" id="L3271">		JavaClassInfo info = null;</span>
<span class="fc" id="L3272">		Connection conn = null;</span>
		try {
<span class="fc" id="L3274">			conn = dataSource.getConnection();</span>
<span class="fc" id="L3275">			final PreparedStatement selectStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.SELECT_JAVA_METACLASS_BY_ID.getSqlStatement());</span>

<span class="fc" id="L3277">			selectStatement.setObject(1, uuid);</span>
<span class="pc bpc" id="L3278" title="1 of 2 branches missed.">			if (DEBUG_ENABLED) {</span>
<span class="nc" id="L3279">				logger.debug(&quot;[==DB==] Executing &quot; + selectStatement);</span>
			}
<span class="fc" id="L3281">			rs = selectStatement.executeQuery();</span>
<span class="pc bpc" id="L3282" title="1 of 2 branches missed.">			if (rs.next()) {</span>
<span class="fc" id="L3283">				info = deserializeJavaClass(rs);</span>
			}
<span class="fc" id="L3285">			selectStatement.close();</span>

<span class="nc" id="L3287">		} catch (final SQLException e) {</span>
<span class="nc" id="L3288">			throw e;</span>
		} finally {
			try {
<span class="pc bpc" id="L3291" title="1 of 2 branches missed.">				if (conn != null) {</span>
<span class="fc" id="L3292">					conn.close();</span>
				}
<span class="nc" id="L3294">			} catch (final SQLException ex1) {</span>
<span class="nc" id="L3295">				logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="fc" id="L3296">			}</span>
		}

<span class="fc" id="L3299">		return info;</span>
	}

	/**
	 * Get PythonClassInfo by ID
	 * @param uuid
	 *            ID of the PythonClassInfo
	 * @return The PythonClassInfo
	 * @throws SQLException
	 *             if PythonClassInfo not found
	 */
	private PythonClassInfo getPythonClassByID(final UUID uuid) throws SQLException {
<span class="nc" id="L3311">		ResultSet rs = null;</span>
<span class="nc" id="L3312">		PythonClassInfo info = null;</span>
<span class="nc" id="L3313">		Connection conn = null;</span>
		try {
<span class="nc" id="L3315">			conn = dataSource.getConnection();</span>
<span class="nc" id="L3316">			final PreparedStatement selectStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.SELECT_PYTHON_METACLASS_BY_ID.getSqlStatement());</span>

<span class="nc" id="L3318">			selectStatement.setObject(1, uuid);</span>
<span class="nc bnc" id="L3319" title="All 2 branches missed.">			if (DEBUG_ENABLED) {</span>
<span class="nc" id="L3320">				logger.debug(&quot;[==DB==] Executing &quot; + selectStatement);</span>
			}
<span class="nc" id="L3322">			rs = selectStatement.executeQuery();</span>
<span class="nc bnc" id="L3323" title="All 2 branches missed.">			if (rs.next()) {</span>
<span class="nc" id="L3324">				info = deserializePythonClass(rs);</span>
			}
<span class="nc" id="L3326">			selectStatement.close();</span>

<span class="nc" id="L3328">		} catch (final SQLException e) {</span>
<span class="nc" id="L3329">			throw e;</span>
		} finally {
			try {
<span class="nc bnc" id="L3332" title="All 2 branches missed.">				if (conn != null) {</span>
<span class="nc" id="L3333">					conn.close();</span>
				}
<span class="nc" id="L3335">			} catch (final SQLException ex1) {</span>
<span class="nc" id="L3336">				logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L3337">			}</span>
		}

<span class="nc" id="L3340">		return info;</span>
	}

	/**
	 * Get MetaClass by ID
	 * @param metaClassID
	 *            ID of the object
	 * @return The MetaClass
	 */
	public MetaClass getMetaClassByID(final MetaClassID metaClassID) {
<span class="fc" id="L3350">		synchronized (dataSource) {</span>
			try {
<span class="fc" id="L3352">				return getMetaClassByID(metaClassID.getId());</span>
<span class="nc" id="L3353">			} catch (final SQLException e) {</span>
<span class="nc" id="L3354">				throw new DbObjectNotExistException(metaClassID);</span>
			}
		}
	}

	/**
	 * Get Operation by ID
	 * @param id
	 *            ID of the object
	 * @return The Operation
	 */
	public Operation getOperationByID(final OperationID id) {
<span class="fc" id="L3366">		synchronized (dataSource) {</span>
			try {
<span class="fc" id="L3368">				return getOperationByID(id.getId());</span>
<span class="nc" id="L3369">			} catch (final SQLException e) {</span>
<span class="nc" id="L3370">				throw new DbObjectNotExistException(id);</span>
			}
		}
	}

	/**
	 * Get Property by ID
	 * @param id
	 *            ID of the object
	 * @return The Property
	 */
	public Property getPropertyByID(final PropertyID id) {
<span class="fc" id="L3382">		synchronized (dataSource) {</span>
			try {
<span class="fc" id="L3384">				return getPropertyByID(id.getId());</span>
<span class="nc" id="L3385">			} catch (final SQLException e) {</span>
<span class="nc" id="L3386">				throw new DbObjectNotExistException(id);</span>
			}
		}
	}

	/**
	 * Get Implementation by ID
	 * @param id
	 *            ID of the object
	 * @return The Property
	 */
	public Implementation getImplementationByID(final ImplementationID id) {
<span class="fc" id="L3398">		synchronized (dataSource) {</span>
			try {
<span class="fc" id="L3400">				return getImplementationByID(id.getId());</span>
<span class="nc" id="L3401">			} catch (final SQLException e) {</span>
<span class="nc" id="L3402">				throw new DbObjectNotExistException(id);</span>
			}
		}
	}

	/**
	 * Delete accessedImplementation
	 * @param uuid
	 *            UUID of object to delete
	 */
	private void deleteAccessedImplementation(final UUID uuid) {
<span class="nc" id="L3413">		Connection conn = null;</span>
		try {
<span class="nc" id="L3415">			conn = dataSource.getConnection();</span>
<span class="nc" id="L3416">			final PreparedStatement stmt = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.DELETE_ACCESSED_IMPL_BY_ID.getSqlStatement());</span>
<span class="nc" id="L3417">			stmt.setObject(1, uuid);</span>
			// CHECKSTYLE:ON
<span class="nc bnc" id="L3419" title="All 2 branches missed.">			if (DEBUG_ENABLED) {</span>
<span class="nc" id="L3420">				logger.debug(&quot;[==DB==] Executing &quot; + stmt);</span>
			}
<span class="nc" id="L3422">			stmt.executeUpdate();</span>
<span class="nc" id="L3423">			stmt.close();</span>

<span class="nc" id="L3425">		} catch (final Exception e) {</span>
<span class="nc" id="L3426">			logger.debug(&quot;SQL Exception in deleteAccessedImplementation&quot;, e);</span>
		} finally {
			try {
<span class="nc bnc" id="L3429" title="All 2 branches missed.">				if (conn != null) {</span>
<span class="nc" id="L3430">					conn.close();</span>
				}
<span class="nc" id="L3432">			} catch (final SQLException ex1) {</span>
<span class="nc" id="L3433">				logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L3434">			}</span>
		}
<span class="nc" id="L3436">	}</span>

	/**
	 * Delete
	 * @param uuid
	 *            UUID of object to delete
	 */
	private void deleteAccessedProperty(final UUID uuid) {
<span class="nc" id="L3444">		Connection conn = null;</span>
		try {
<span class="nc" id="L3446">			conn = dataSource.getConnection();</span>
<span class="nc" id="L3447">			final PreparedStatement stmt = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.DELETE_ACCESSED_PROP_BY_ID.getSqlStatement());</span>
<span class="nc" id="L3448">			stmt.setObject(1, uuid);</span>
			// CHECKSTYLE:ON
<span class="nc bnc" id="L3450" title="All 2 branches missed.">			if (DEBUG_ENABLED) {</span>
<span class="nc" id="L3451">				logger.debug(&quot;[==DB==] Executing &quot; + stmt);</span>
			}
<span class="nc" id="L3453">			stmt.executeUpdate();</span>
<span class="nc" id="L3454">			stmt.close();</span>
<span class="nc" id="L3455">		} catch (final Exception e) {</span>
<span class="nc" id="L3456">			logger.debug(&quot;SQL Exception in deleteAccessedProperty&quot;, e);</span>
		} finally {
			try {
<span class="nc bnc" id="L3459" title="All 2 branches missed.">				if (conn != null) {</span>
<span class="nc" id="L3460">					conn.close();</span>
				}
<span class="nc" id="L3462">			} catch (final SQLException ex1) {</span>
<span class="nc" id="L3463">				logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L3464">			}</span>
		}
<span class="nc" id="L3466">	}</span>

	/**
	 * Delete
	 * @param uuid
	 *            UUID of object to delete
	 */
	private void deleteJavaTypeInfo(final UUID uuid) {
<span class="nc" id="L3474">		Connection conn = null;</span>
		try {
<span class="nc" id="L3476">			conn = dataSource.getConnection();</span>
<span class="nc" id="L3477">			final PreparedStatement stmt = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.DELETE_JAVA_TYPE_BY_ID.getSqlStatement());</span>
<span class="nc" id="L3478">			stmt.setObject(1, uuid);</span>
			// CHECKSTYLE:ON
<span class="nc bnc" id="L3480" title="All 2 branches missed.">			if (DEBUG_ENABLED) {</span>
<span class="nc" id="L3481">				logger.debug(&quot;[==DB==] Executing &quot; + stmt);</span>
			}
<span class="nc" id="L3483">			stmt.executeUpdate();</span>
<span class="nc" id="L3484">			stmt.close();</span>

<span class="nc" id="L3486">		} catch (final Exception e) {</span>
<span class="nc" id="L3487">			logger.debug(&quot;SQL Exception in deleteJavaTypeInfo&quot;, e);</span>
		} finally {
			try {
<span class="nc bnc" id="L3490" title="All 2 branches missed.">				if (conn != null) {</span>
<span class="nc" id="L3491">					conn.close();</span>
				}
<span class="nc" id="L3493">			} catch (final SQLException ex1) {</span>
<span class="nc" id="L3494">				logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L3495">			}</span>
		}
<span class="nc" id="L3497">	}</span>

	/**
	 * Delete
	 * @param uuid
	 *            UUID of object to delete
	 */
	private void deletePythonTypeInfo(final UUID uuid) {
<span class="nc" id="L3505">		Connection conn = null;</span>
		try {
<span class="nc" id="L3507">			conn = dataSource.getConnection();</span>
<span class="nc" id="L3508">			final PreparedStatement stmt = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.DELETE_PYTHON_TYPE_BY_ID.getSqlStatement());</span>
<span class="nc" id="L3509">			stmt.setObject(1, uuid);</span>
			// CHECKSTYLE:ON
<span class="nc bnc" id="L3511" title="All 2 branches missed.">			if (DEBUG_ENABLED) {</span>
<span class="nc" id="L3512">				logger.debug(&quot;[==DB==] Executing &quot; + stmt);</span>
			}
<span class="nc" id="L3514">			stmt.executeUpdate();</span>
<span class="nc" id="L3515">			stmt.close();</span>

<span class="nc" id="L3517">		} catch (final Exception e) {</span>
<span class="nc" id="L3518">			logger.debug(&quot;SQL Exception in deletePythonTypeInfo&quot;, e);</span>
		} finally {
			try {
<span class="nc bnc" id="L3521" title="All 2 branches missed.">				if (conn != null) {</span>
<span class="nc" id="L3522">					conn.close();</span>
				}
<span class="nc" id="L3524">			} catch (final SQLException ex1) {</span>
<span class="nc" id="L3525">				logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L3526">			}</span>
		}
<span class="nc" id="L3528">	}</span>

	/**
	 * Delete
	 * @param uuid
	 *            UUID of object to delete
	 */
	private void deleteType(final UUID uuid) {

		// Get type
		try {
<span class="fc" id="L3539">			final Type typeToDelete = getTypeByID(uuid);</span>
<span class="fc" id="L3540">			final Map&lt;Langs, LanguageDependantTypeInfo&gt; extensions = typeToDelete.getLanguageDepInfos();</span>
<span class="pc bpc" id="L3541" title="1 of 2 branches missed.">			for (final Entry&lt;Langs, LanguageDependantTypeInfo&gt; curEntry : extensions.entrySet()) {</span>
<span class="nc" id="L3542">				final Langs lang = curEntry.getKey();</span>
<span class="nc bnc" id="L3543" title="All 4 branches missed.">				switch (lang) {</span>
				case LANG_JAVA:
<span class="nc" id="L3545">					final JavaTypeInfo javaInfo = (JavaTypeInfo) curEntry.getValue();</span>
<span class="nc" id="L3546">					this.deleteJavaTypeInfo(javaInfo.getId());</span>
<span class="nc" id="L3547">					break;</span>
				case LANG_NONE:
<span class="nc" id="L3549">					break;</span>
				case LANG_PYTHON:
<span class="nc" id="L3551">					final PythonTypeInfo info = (PythonTypeInfo) curEntry.getValue();</span>
<span class="nc" id="L3552">					this.deletePythonTypeInfo(info.getId());</span>
<span class="nc" id="L3553">					break;</span>
				default:
					break;
				}
<span class="nc" id="L3557">			}</span>

			// Delete includes
<span class="pc bpc" id="L3560" title="1 of 2 branches missed.">			for (final Type included : typeToDelete.getIncludes()) {</span>
<span class="nc" id="L3561">				this.deleteType(included.getId());</span>
<span class="nc" id="L3562">			}</span>

<span class="nc" id="L3564">		} catch (final SQLException e1) {</span>
<span class="nc" id="L3565">			logger.debug(&quot;SQL Exception in deleteType&quot;, e1);</span>
<span class="fc" id="L3566">		}</span>

<span class="fc" id="L3568">		Connection conn = null;</span>
		try {
<span class="fc" id="L3570">			conn = dataSource.getConnection();</span>
<span class="fc" id="L3571">			final PreparedStatement stmt = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.DELETE_TYPE_BY_ID.getSqlStatement());</span>
<span class="fc" id="L3572">			stmt.setObject(1, uuid);</span>
			// CHECKSTYLE:ON
<span class="pc bpc" id="L3574" title="1 of 2 branches missed.">			if (DEBUG_ENABLED) {</span>
<span class="nc" id="L3575">				logger.debug(&quot;[==DB==] Executing &quot; + stmt + &quot;(&quot; + uuid + &quot;)&quot;);</span>
			}
<span class="fc" id="L3577">			stmt.executeUpdate();</span>
<span class="fc" id="L3578">			stmt.close();</span>

<span class="nc" id="L3580">		} catch (final Exception e) {</span>
<span class="nc" id="L3581">			logger.debug(&quot;SQL Exception in deleteType&quot;, e);</span>
		} finally {
			try {
<span class="pc bpc" id="L3584" title="1 of 2 branches missed.">				if (conn != null) {</span>
<span class="fc" id="L3585">					conn.close();</span>
				}
<span class="nc" id="L3587">			} catch (final SQLException ex1) {</span>
<span class="nc" id="L3588">				logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="fc" id="L3589">			}</span>
		}
<span class="fc" id="L3591">	}</span>

	/**
	 * Delete
	 * @param uuid
	 *            UUID of object to delete
	 */
	private void deleteMemoryFeature(final UUID uuid) {
<span class="nc" id="L3599">		Connection conn = null;</span>
		try {
<span class="nc" id="L3601">			conn = dataSource.getConnection();</span>
<span class="nc" id="L3602">			final PreparedStatement stmt = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.DELETE_MEMORY_FEATURE_BY_ID.getSqlStatement());</span>
<span class="nc" id="L3603">			stmt.setObject(1, uuid);</span>
			// CHECKSTYLE:ON
<span class="nc bnc" id="L3605" title="All 2 branches missed.">			if (DEBUG_ENABLED) {</span>
<span class="nc" id="L3606">				logger.debug(&quot;[==DB==] Executing &quot; + stmt);</span>
			}
<span class="nc" id="L3608">			stmt.executeUpdate();</span>
<span class="nc" id="L3609">			stmt.close();</span>

<span class="nc" id="L3611">		} catch (final Exception e) {</span>
<span class="nc" id="L3612">			logger.debug(&quot;SQL Exception in deleteMemoryFeature&quot;, e);</span>
		} finally {
			try {
<span class="nc bnc" id="L3615" title="All 2 branches missed.">				if (conn != null) {</span>
<span class="nc" id="L3616">					conn.close();</span>
				}
<span class="nc" id="L3618">			} catch (final SQLException ex1) {</span>
<span class="nc" id="L3619">				logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L3620">			}</span>
		}
<span class="nc" id="L3622">	}</span>

	/**
	 * Delete
	 * @param uuid
	 *            UUID of object to delete
	 */
	private void deleteCPUFeature(final UUID uuid) {
<span class="nc" id="L3630">		Connection conn = null;</span>
		try {
<span class="nc" id="L3632">			conn = dataSource.getConnection();</span>
<span class="nc" id="L3633">			final PreparedStatement stmt = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.DELETE_CPU_FEATURE_BY_ID.getSqlStatement());</span>
<span class="nc" id="L3634">			stmt.setObject(1, uuid);</span>
			// CHECKSTYLE:ON
<span class="nc bnc" id="L3636" title="All 2 branches missed.">			if (DEBUG_ENABLED) {</span>
<span class="nc" id="L3637">				logger.debug(&quot;[==DB==] Executing &quot; + stmt);</span>
			}
<span class="nc" id="L3639">			stmt.executeUpdate();</span>
<span class="nc" id="L3640">			stmt.close();</span>

<span class="nc" id="L3642">		} catch (final Exception e) {</span>
<span class="nc" id="L3643">			logger.debug(&quot;SQL Exception in deleteCPUFeature&quot;, e);</span>
		} finally {
			try {
<span class="nc bnc" id="L3646" title="All 2 branches missed.">				if (conn != null) {</span>
<span class="nc" id="L3647">					conn.close();</span>
				}
<span class="nc" id="L3649">			} catch (final SQLException ex1) {</span>
<span class="nc" id="L3650">				logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L3651">			}</span>
		}
<span class="nc" id="L3653">	}</span>

	/**
	 * Delete
	 * @param uuid
	 *            UUID of object to delete
	 */
	private void deleteLanguageFeature(final UUID uuid) {
<span class="nc" id="L3661">		Connection conn = null;</span>
		try {
<span class="nc" id="L3663">			conn = dataSource.getConnection();</span>
<span class="nc" id="L3664">			final PreparedStatement stmt = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.DELETE_LANGUAGE_FEATURE_BY_ID.getSqlStatement());</span>
<span class="nc" id="L3665">			stmt.setObject(1, uuid);</span>
			// CHECKSTYLE:ON
<span class="nc bnc" id="L3667" title="All 2 branches missed.">			if (DEBUG_ENABLED) {</span>
<span class="nc" id="L3668">				logger.debug(&quot;[==DB==] Executing &quot; + stmt);</span>
			}
<span class="nc" id="L3670">			stmt.executeUpdate();</span>
<span class="nc" id="L3671">			stmt.close();</span>

<span class="nc" id="L3673">		} catch (final Exception e) {</span>
<span class="nc" id="L3674">			logger.debug(&quot;SQL Exception in deleteLanguageFeature&quot;, e);</span>
		} finally {
			try {
<span class="nc bnc" id="L3677" title="All 2 branches missed.">				if (conn != null) {</span>
<span class="nc" id="L3678">					conn.close();</span>
				}
<span class="nc" id="L3680">			} catch (final SQLException ex1) {</span>
<span class="nc" id="L3681">				logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L3682">			}</span>
		}
<span class="nc" id="L3684">	}</span>

	/**
	 * Delete
	 * @param uuid
	 *            UUID of object to delete
	 */
	private void deleteArchitectureFeature(final UUID uuid) {
<span class="nc" id="L3692">		Connection conn = null;</span>
		try {
<span class="nc" id="L3694">			conn = dataSource.getConnection();</span>
<span class="nc" id="L3695">			final PreparedStatement stmt = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.DELETE_ARCH_FEATURE_BY_ID.getSqlStatement());</span>
<span class="nc" id="L3696">			stmt.setObject(1, uuid);</span>
			// CHECKSTYLE:ON
<span class="nc bnc" id="L3698" title="All 2 branches missed.">			if (DEBUG_ENABLED) {</span>
<span class="nc" id="L3699">				logger.debug(&quot;[==DB==] Executing &quot; + stmt);</span>
			}
<span class="nc" id="L3701">			stmt.executeUpdate();</span>
<span class="nc" id="L3702">			stmt.close();</span>

<span class="nc" id="L3704">		} catch (final Exception e) {</span>
<span class="nc" id="L3705">			logger.debug(&quot;SQL Exception in deleteArchitectureFeature&quot;, e);</span>
		} finally {
			try {
<span class="nc bnc" id="L3708" title="All 2 branches missed.">				if (conn != null) {</span>
<span class="nc" id="L3709">					conn.close();</span>
				}
<span class="nc" id="L3711">			} catch (final SQLException ex1) {</span>
<span class="nc" id="L3712">				logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L3713">			}</span>
		}
<span class="nc" id="L3715">	}</span>

	/**
	 * Delete
	 * @param uuid
	 *            UUID of object to delete
	 */
	private void deletePrefetchingInfo(final UUID uuid) {

<span class="nc" id="L3724">		Connection conn = null;</span>
		try {
<span class="nc" id="L3726">			conn = dataSource.getConnection();</span>
<span class="nc" id="L3727">			final PreparedStatement stmt = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.DELETE_PREFETCHING_INFO_BY_ID.getSqlStatement());</span>
<span class="nc" id="L3728">			stmt.setObject(1, uuid);</span>
			// CHECKSTYLE:ON
<span class="nc bnc" id="L3730" title="All 2 branches missed.">			if (DEBUG_ENABLED) {</span>
<span class="nc" id="L3731">				logger.debug(&quot;[==DB==] Executing &quot; + stmt);</span>
			}
<span class="nc" id="L3733">			stmt.executeUpdate();</span>
<span class="nc" id="L3734">			stmt.close();</span>

<span class="nc" id="L3736">		} catch (final Exception e) {</span>
<span class="nc" id="L3737">			logger.debug(&quot;SQL Exception in deletePrefetchingInfo&quot;, e);</span>
		} finally {
			try {
<span class="nc bnc" id="L3740" title="All 2 branches missed.">				if (conn != null) {</span>
<span class="nc" id="L3741">					conn.close();</span>
				}
<span class="nc" id="L3743">			} catch (final SQLException ex1) {</span>
<span class="nc" id="L3744">				logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L3745">			}</span>
		}
<span class="nc" id="L3747">	}</span>

	/**
	 * Delete
	 * @param uuid
	 *            UUID of object to delete
	 */
	private void deleteJavaImplementation(final UUID uuid) {

		try {
<span class="fc" id="L3757">			final JavaImplementation implementation = (JavaImplementation) this.getImplementationByID(uuid);</span>

			// Includes
<span class="pc bpc" id="L3760" title="1 of 2 branches missed.">			for (final Type included : implementation.getIncludes()) {</span>
<span class="nc" id="L3761">				this.deleteType(included.getId());</span>
<span class="nc" id="L3762">			}</span>

			// Acc. props
<span class="pc bpc" id="L3765" title="1 of 2 branches missed.">			for (final AccessedProperty accProp : implementation.getAccessedProperties()) {</span>
<span class="nc" id="L3766">				this.deleteAccessedProperty(accProp.getId());</span>
<span class="nc" id="L3767">			}</span>

			// Acc. impls
<span class="pc bpc" id="L3770" title="1 of 2 branches missed.">			for (final AccessedImplementation accImpl : implementation.getAccessedImplementations()) {</span>
<span class="nc" id="L3771">				this.deleteAccessedImplementation(accImpl.getId());</span>
<span class="nc" id="L3772">			}</span>

			// Features
<span class="pc bpc" id="L3775" title="1 of 2 branches missed.">			for (final Entry&lt;FeatureType, QuantitativeFeature&gt; curEntry : implementation.getRequiredQuantitativeFeatures().entrySet()) {</span>
<span class="nc" id="L3776">				final QuantitativeFeature qfeature = curEntry.getValue();</span>
<span class="nc bnc" id="L3777" title="All 3 branches missed.">				switch (curEntry.getKey()) {</span>
				case CPU:
<span class="nc" id="L3779">					final CPUFeature cpuFeature = (CPUFeature) qfeature;</span>
<span class="nc" id="L3780">					this.deleteCPUFeature(cpuFeature.getId());</span>
<span class="nc" id="L3781">					break;</span>
				case MEMORY:
<span class="nc" id="L3783">					final MemoryFeature memFeature = (MemoryFeature) qfeature;</span>
<span class="nc" id="L3784">					this.deleteMemoryFeature(memFeature.getId());</span>
<span class="nc" id="L3785">					break;</span>
				default:
					break;

				}
<span class="nc" id="L3790">			}</span>

<span class="pc bpc" id="L3792" title="1 of 2 branches missed.">			for (final Entry&lt;FeatureType, QualitativeFeature&gt; curEntry : implementation.getRequiredQualitativeFeatures().entrySet()) {</span>
<span class="nc" id="L3793">				final QualitativeFeature qfeature = curEntry.getValue();</span>
<span class="nc bnc" id="L3794" title="All 3 branches missed.">				switch (curEntry.getKey()) {</span>
				case ARCHITECTURE:
<span class="nc" id="L3796">					final ArchitectureFeature archFeature = (ArchitectureFeature) qfeature;</span>
<span class="nc" id="L3797">					this.deleteArchitectureFeature(archFeature.getId());</span>
<span class="nc" id="L3798">					break;</span>
				case LANGUAGE:
<span class="nc" id="L3800">					final LanguageFeature langFeature = (LanguageFeature) qfeature;</span>
<span class="nc" id="L3801">					this.deleteLanguageFeature(langFeature.getId());</span>
<span class="nc" id="L3802">					break;</span>
				default:
					break;

				}
<span class="nc" id="L3807">			}</span>

			// Prefetching info
<span class="pc bpc" id="L3810" title="1 of 2 branches missed.">			if (implementation.getPrefetchingInfo() != null) {</span>
<span class="nc" id="L3811">				this.deletePrefetchingInfo(implementation.getPrefetchingInfo().getId());</span>
			}

<span class="nc" id="L3814">		} catch (final SQLException e1) {</span>
<span class="nc" id="L3815">			logger.debug(&quot;SQL Exception in deleteJavaImplementation (first step)&quot;, e1);</span>
<span class="fc" id="L3816">		}</span>

<span class="fc" id="L3818">		Connection conn = null;</span>
		try {
<span class="fc" id="L3820">			conn = dataSource.getConnection();</span>
<span class="fc" id="L3821">			final PreparedStatement stmt = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.DELETE_JAVA_IMPLEMENTATION_BY_ID.getSqlStatement());</span>
<span class="fc" id="L3822">			stmt.setObject(1, uuid);</span>
			// CHECKSTYLE:ON
<span class="pc bpc" id="L3824" title="1 of 2 branches missed.">			if (DEBUG_ENABLED) {</span>
<span class="nc" id="L3825">				logger.debug(&quot;[==DB==] Executing &quot; + stmt);</span>
			}
<span class="fc" id="L3827">			stmt.executeUpdate();</span>
<span class="fc" id="L3828">			stmt.close();</span>

<span class="nc" id="L3830">		} catch (final Exception e) {</span>
<span class="nc" id="L3831">			logger.debug(&quot;SQL Exception in deleteJavaImplementation (second step)&quot;, e);</span>
		} finally {
			try {
<span class="pc bpc" id="L3834" title="1 of 2 branches missed.">				if (conn != null) {</span>
<span class="fc" id="L3835">					conn.close();</span>
				}
<span class="nc" id="L3837">			} catch (final SQLException ex1) {</span>
<span class="nc" id="L3838">				logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="fc" id="L3839">			}</span>
		}
<span class="fc" id="L3841">	}</span>

	/**
	 * Delete
	 * @param uuid
	 *            UUID of object to delete
	 */
	private void deletePythonImplementation(final UUID uuid) {

		try {
<span class="nc" id="L3851">			final PythonImplementation implementation = (PythonImplementation) this.getImplementationByID(uuid);</span>

			// Includes
<span class="nc bnc" id="L3854" title="All 2 branches missed.">			for (final Type included : implementation.getIncludes()) {</span>
<span class="nc" id="L3855">				this.deleteType(included.getId());</span>
<span class="nc" id="L3856">			}</span>

			// Acc. props
<span class="nc bnc" id="L3859" title="All 2 branches missed.">			for (final AccessedProperty accProp : implementation.getAccessedProperties()) {</span>
<span class="nc" id="L3860">				this.deleteAccessedProperty(accProp.getId());</span>
<span class="nc" id="L3861">			}</span>

			// Acc. impls
<span class="nc bnc" id="L3864" title="All 2 branches missed.">			for (final AccessedImplementation accImpl : implementation.getAccessedImplementations()) {</span>
<span class="nc" id="L3865">				this.deleteAccessedImplementation(accImpl.getId());</span>
<span class="nc" id="L3866">			}</span>

			// Features
<span class="nc bnc" id="L3869" title="All 2 branches missed.">			for (final Entry&lt;FeatureType, QuantitativeFeature&gt; curEntry : implementation.getRequiredQuantitativeFeatures().entrySet()) {</span>
<span class="nc" id="L3870">				final QuantitativeFeature qfeature = curEntry.getValue();</span>
<span class="nc bnc" id="L3871" title="All 3 branches missed.">				switch (curEntry.getKey()) {</span>
				case CPU:
<span class="nc" id="L3873">					final CPUFeature cpuFeature = (CPUFeature) qfeature;</span>
<span class="nc" id="L3874">					this.deleteCPUFeature(cpuFeature.getId());</span>
<span class="nc" id="L3875">					break;</span>
				case MEMORY:
<span class="nc" id="L3877">					final MemoryFeature memFeature = (MemoryFeature) qfeature;</span>
<span class="nc" id="L3878">					this.deleteMemoryFeature(memFeature.getId());</span>
<span class="nc" id="L3879">					break;</span>
				default:
					break;

				}
<span class="nc" id="L3884">			}</span>

<span class="nc bnc" id="L3886" title="All 2 branches missed.">			for (final Entry&lt;FeatureType, QualitativeFeature&gt; curEntry : implementation.getRequiredQualitativeFeatures().entrySet()) {</span>
<span class="nc" id="L3887">				final QualitativeFeature qfeature = curEntry.getValue();</span>
<span class="nc bnc" id="L3888" title="All 3 branches missed.">				switch (curEntry.getKey()) {</span>
				case ARCHITECTURE:
<span class="nc" id="L3890">					final ArchitectureFeature archFeature = (ArchitectureFeature) qfeature;</span>
<span class="nc" id="L3891">					this.deleteArchitectureFeature(archFeature.getId());</span>
<span class="nc" id="L3892">					break;</span>
				case LANGUAGE:
<span class="nc" id="L3894">					final LanguageFeature langFeature = (LanguageFeature) qfeature;</span>
<span class="nc" id="L3895">					this.deleteLanguageFeature(langFeature.getId());</span>
<span class="nc" id="L3896">					break;</span>
				default:
					break;

				}
<span class="nc" id="L3901">			}</span>

			// Prefetching info
<span class="nc bnc" id="L3904" title="All 2 branches missed.">			if (implementation.getPrefetchingInfo() != null) {</span>
<span class="nc" id="L3905">				this.deletePrefetchingInfo(implementation.getPrefetchingInfo().getId());</span>
			}

<span class="nc" id="L3908">		} catch (final SQLException e1) {</span>
<span class="nc" id="L3909">			logger.debug(&quot;SQL Exception in deletePythonImplementation (first step)&quot;, e1);</span>
<span class="nc" id="L3910">		}</span>

<span class="nc" id="L3912">		Connection conn = null;</span>
		try {
<span class="nc" id="L3914">			conn = dataSource.getConnection();</span>
<span class="nc" id="L3915">			final PreparedStatement stmt = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.DELETE_JAVA_IMPLEMENTATION_BY_ID.getSqlStatement());</span>
<span class="nc" id="L3916">			stmt.setObject(1, uuid);</span>
			// CHECKSTYLE:ON
<span class="nc bnc" id="L3918" title="All 2 branches missed.">			if (DEBUG_ENABLED) {</span>
<span class="nc" id="L3919">				logger.debug(&quot;[==DB==] Executing &quot; + stmt);</span>
			}
<span class="nc" id="L3921">			stmt.executeUpdate();</span>
<span class="nc" id="L3922">			stmt.close();</span>

<span class="nc" id="L3924">		} catch (final Exception e) {</span>
<span class="nc" id="L3925">			logger.debug(&quot;SQL Exception in deletePythonImplementation (second step)&quot;, e);</span>
		} finally {
			try {
<span class="nc bnc" id="L3928" title="All 2 branches missed.">				if (conn != null) {</span>
<span class="nc" id="L3929">					conn.close();</span>
				}
<span class="nc" id="L3931">			} catch (final SQLException ex1) {</span>
<span class="nc" id="L3932">				logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L3933">			}</span>
		}
<span class="nc" id="L3935">	}</span>

	/**
	 * Delete
	 * @param uuid
	 *            UUID of object to delete
	 */
	private void deleteJavaProperty(final UUID uuid) {
<span class="nc" id="L3943">		Connection conn = null;</span>
		try {
<span class="nc" id="L3945">			conn = dataSource.getConnection();</span>
<span class="nc" id="L3946">			final PreparedStatement stmt = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.DELETE_JAVA_PROPERTY_BY_ID.getSqlStatement());</span>
<span class="nc" id="L3947">			stmt.setObject(1, uuid);</span>
			// CHECKSTYLE:ON
<span class="nc bnc" id="L3949" title="All 2 branches missed.">			if (DEBUG_ENABLED) {</span>
<span class="nc" id="L3950">				logger.debug(&quot;[==DB==] Executing &quot; + stmt);</span>
			}
<span class="nc" id="L3952">			stmt.executeUpdate();</span>
<span class="nc" id="L3953">			stmt.close();</span>

<span class="nc" id="L3955">		} catch (final Exception e) {</span>
<span class="nc" id="L3956">			logger.debug(&quot;SQL Exception in deleteJavaProperty&quot;, e);</span>
		} finally {
			try {
<span class="nc bnc" id="L3959" title="All 2 branches missed.">				if (conn != null) {</span>
<span class="nc" id="L3960">					conn.close();</span>
				}
<span class="nc" id="L3962">			} catch (final SQLException ex1) {</span>
<span class="nc" id="L3963">				logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L3964">			}</span>
		}
<span class="nc" id="L3966">	}</span>

	/**
	 * Delete
	 * @param uuid
	 *            UUID of object to delete
	 */
	private void deletePythonProperty(final UUID uuid) {
<span class="nc" id="L3974">		Connection conn = null;</span>
		try {
<span class="nc" id="L3976">			conn = dataSource.getConnection();</span>
<span class="nc" id="L3977">			final PreparedStatement stmt = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.DELETE_JAVA_PROPERTY_BY_ID.getSqlStatement());</span>
<span class="nc" id="L3978">			stmt.setObject(1, uuid);</span>
			// CHECKSTYLE:ON
<span class="nc bnc" id="L3980" title="All 2 branches missed.">			if (DEBUG_ENABLED) {</span>
<span class="nc" id="L3981">				logger.debug(&quot;[==DB==] Executing &quot; + stmt);</span>
			}
<span class="nc" id="L3983">			stmt.executeUpdate();</span>
<span class="nc" id="L3984">			stmt.close();</span>

<span class="nc" id="L3986">		} catch (final Exception e) {</span>
<span class="nc" id="L3987">			logger.debug(&quot;SQL Exception in deletePythonProperty&quot;, e);</span>
		} finally {
			try {
<span class="nc bnc" id="L3990" title="All 2 branches missed.">				if (conn != null) {</span>
<span class="nc" id="L3991">					conn.close();</span>
				}
<span class="nc" id="L3993">			} catch (final SQLException ex1) {</span>
<span class="nc" id="L3994">				logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L3995">			}</span>
		}
<span class="nc" id="L3997">	}</span>

	/**
	 * Delete
	 * @param uuid
	 *            UUID of object to delete
	 */
	private void deleteProperty(final UUID uuid) {

		try {
<span class="nc" id="L4007">			final Property prop = this.getPropertyByID(uuid);</span>

			// Type
<span class="nc" id="L4010">			this.deleteType(prop.getType().getId());</span>

			// Extensions
<span class="nc" id="L4013">			final Map&lt;Langs, LanguageDependantPropertyInfo&gt; extensions = prop.getLanguageDepInfos();</span>
<span class="nc bnc" id="L4014" title="All 2 branches missed.">			for (final Entry&lt;Langs, LanguageDependantPropertyInfo&gt; curEntry : extensions.entrySet()) {</span>
<span class="nc" id="L4015">				final Langs lang = curEntry.getKey();</span>
<span class="nc bnc" id="L4016" title="All 4 branches missed.">				switch (lang) {</span>
				case LANG_JAVA:
<span class="nc" id="L4018">					final JavaPropertyInfo javaInfo = (JavaPropertyInfo) curEntry.getValue();</span>
<span class="nc" id="L4019">					this.deleteJavaProperty(javaInfo.getId());</span>
<span class="nc" id="L4020">					break;</span>
				case LANG_NONE:
<span class="nc" id="L4022">					break;</span>
				case LANG_PYTHON:
<span class="nc" id="L4024">					final PythonPropertyInfo info = (PythonPropertyInfo) curEntry.getValue();</span>
<span class="nc" id="L4025">					this.deletePythonProperty(info.getId());</span>
<span class="nc" id="L4026">					break;</span>
				default:
					break;
				}
<span class="nc" id="L4030">			}</span>

			// Annotations
<span class="nc bnc" id="L4033" title="All 2 branches missed.">			for (final Annotation annotation : prop.getAnnotations()) {</span>
<span class="nc" id="L4034">				this.deleteAnnotation(annotation.getId());</span>
<span class="nc" id="L4035">			}</span>

<span class="nc" id="L4037">		} catch (final SQLException e1) {</span>
<span class="nc" id="L4038">			logger.debug(&quot;SQL Exception in deleteProperty (first step)&quot;, e1);</span>
<span class="nc" id="L4039">		}</span>

<span class="nc" id="L4041">		Connection conn = null;</span>
		try {
<span class="nc" id="L4043">			conn = dataSource.getConnection();</span>
<span class="nc" id="L4044">			final PreparedStatement stmt = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.DELETE_PROPERTY_BY_ID.getSqlStatement());</span>
<span class="nc" id="L4045">			stmt.setObject(1, uuid);</span>
			// CHECKSTYLE:ON
<span class="nc bnc" id="L4047" title="All 2 branches missed.">			if (DEBUG_ENABLED) {</span>
<span class="nc" id="L4048">				logger.debug(&quot;[==DB==] Executing &quot; + stmt);</span>
			}
<span class="nc" id="L4050">			stmt.executeUpdate();</span>
<span class="nc" id="L4051">			stmt.close();</span>

<span class="nc" id="L4053">		} catch (final Exception e) {</span>
<span class="nc" id="L4054">			logger.debug(&quot;SQL Exception in deleteProperty (second step)&quot;, e);</span>
		} finally {
			try {
<span class="nc bnc" id="L4057" title="All 2 branches missed.">				if (conn != null) {</span>
<span class="nc" id="L4058">					conn.close();</span>
				}
<span class="nc" id="L4060">			} catch (final SQLException ex1) {</span>
<span class="nc" id="L4061">				logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L4062">			}</span>
		}
<span class="nc" id="L4064">	}</span>

	/**
	 * Delete
	 * @param uuid
	 *            UUID of annotation to delete
	 */
	private void deleteAnnotation(final UUID uuid) {
<span class="nc" id="L4072">		Connection conn = null;</span>
		try {
<span class="nc" id="L4074">			conn = dataSource.getConnection();</span>
<span class="nc" id="L4075">			final PreparedStatement stmt = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.DELETE_ANNOTATION_BY_ID.getSqlStatement());</span>
<span class="nc" id="L4076">			stmt.setObject(1, uuid);</span>
			// CHECKSTYLE:ON
<span class="nc bnc" id="L4078" title="All 2 branches missed.">			if (DEBUG_ENABLED) {</span>
<span class="nc" id="L4079">				logger.debug(&quot;[==DB==] Executing &quot; + stmt);</span>
			}
<span class="nc" id="L4081">			stmt.executeUpdate();</span>
<span class="nc" id="L4082">			stmt.close();</span>

<span class="nc" id="L4084">		} catch (final Exception e) {</span>
<span class="nc" id="L4085">			e.printStackTrace();</span>
		} finally {
			try {
<span class="nc bnc" id="L4088" title="All 2 branches missed.">				if (conn != null) {</span>
<span class="nc" id="L4089">					conn.close();</span>
				}
<span class="nc" id="L4091">			} catch (final SQLException ex1) {</span>
<span class="nc" id="L4092">				logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L4093">			}</span>
		}
<span class="nc" id="L4095">	}</span>

	/**
	 * Delete
	 * @param uuid
	 *            UUID of object to delete
	 */
	private void deleteJavaOperation(final UUID uuid) {
<span class="fc" id="L4103">		Connection conn = null;</span>
		try {
<span class="fc" id="L4105">			conn = dataSource.getConnection();</span>
<span class="fc" id="L4106">			final PreparedStatement stmt = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.DELETE_JAVA_OPERATION_BY_ID.getSqlStatement());</span>
<span class="fc" id="L4107">			stmt.setObject(1, uuid);</span>
			// CHECKSTYLE:ON
<span class="pc bpc" id="L4109" title="1 of 2 branches missed.">			if (DEBUG_ENABLED) {</span>
<span class="nc" id="L4110">				logger.debug(&quot;[==DB==] Executing &quot; + stmt);</span>
			}
<span class="fc" id="L4112">			stmt.executeUpdate();</span>
<span class="fc" id="L4113">			stmt.close();</span>

<span class="nc" id="L4115">		} catch (final Exception e) {</span>
<span class="nc" id="L4116">			e.printStackTrace();</span>
		} finally {
			try {
<span class="pc bpc" id="L4119" title="1 of 2 branches missed.">				if (conn != null) {</span>
<span class="fc" id="L4120">					conn.close();</span>
				}
<span class="nc" id="L4122">			} catch (final SQLException ex1) {</span>
<span class="nc" id="L4123">				logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="fc" id="L4124">			}</span>
		}
<span class="fc" id="L4126">	}</span>

	/**
	 * Delete
	 * @param uuid
	 *            UUID of object to delete
	 */
	private void deletePythonOperation(final UUID uuid) {
<span class="nc" id="L4134">		Connection conn = null;</span>
		try {
<span class="nc" id="L4136">			conn = dataSource.getConnection();</span>
<span class="nc" id="L4137">			final PreparedStatement stmt = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.DELETE_PYTHON_OPERATION_BY_ID.getSqlStatement());</span>
<span class="nc" id="L4138">			stmt.setObject(1, uuid);</span>
			// CHECKSTYLE:ON
<span class="nc bnc" id="L4140" title="All 2 branches missed.">			if (DEBUG_ENABLED) {</span>
<span class="nc" id="L4141">				logger.debug(&quot;[==DB==] Executing &quot; + stmt);</span>
			}
<span class="nc" id="L4143">			stmt.executeUpdate();</span>
<span class="nc" id="L4144">			stmt.close();</span>

<span class="nc" id="L4146">		} catch (final Exception e) {</span>
<span class="nc" id="L4147">			e.printStackTrace();</span>
		} finally {
			try {
<span class="nc bnc" id="L4150" title="All 2 branches missed.">				if (conn != null) {</span>
<span class="nc" id="L4151">					conn.close();</span>
				}
<span class="nc" id="L4153">			} catch (final SQLException ex1) {</span>
<span class="nc" id="L4154">				logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L4155">			}</span>
		}
<span class="nc" id="L4157">	}</span>

	/**
	 * Delete
	 * @param uuid
	 *            UUID of object to delete
	 */
	private void deleteOperation(final UUID uuid) {

		try {
<span class="fc" id="L4167">			final Operation operation = this.getOperationByID(uuid);</span>

			// Params
<span class="fc bfc" id="L4170" title="All 2 branches covered.">			for (final Type paramType : operation.getParams().values()) {</span>
<span class="fc" id="L4171">				this.deleteType(paramType.getId());</span>
<span class="fc" id="L4172">			}</span>
			// Return
<span class="fc" id="L4174">			this.deleteType(operation.getReturnType().getId());</span>

			// Implementations
<span class="fc bfc" id="L4177" title="All 2 branches covered.">			for (final Implementation impl : operation.getImplementations()) {</span>
<span class="pc bpc" id="L4178" title="1 of 2 branches missed.">				if (impl instanceof JavaImplementation) {</span>
<span class="fc" id="L4179">					this.deleteJavaImplementation(impl.getDataClayID().getId());</span>
<span class="nc bnc" id="L4180" title="All 2 branches missed.">				} else if (impl instanceof PythonImplementation) {</span>
<span class="nc" id="L4181">					this.deletePythonImplementation(impl.getDataClayID().getId());</span>
				}
<span class="fc" id="L4183">			}</span>

			// Extensions
<span class="fc" id="L4186">			final Map&lt;Langs, LanguageDependantOperationInfo&gt; extensions = operation.getLanguageDepInfos();</span>
<span class="fc bfc" id="L4187" title="All 2 branches covered.">			for (final Entry&lt;Langs, LanguageDependantOperationInfo&gt; curEntry : extensions.entrySet()) {</span>
<span class="fc" id="L4188">				final Langs lang = curEntry.getKey();</span>
<span class="pc bpc" id="L4189" title="3 of 4 branches missed.">				switch (lang) {</span>
				case LANG_JAVA:
<span class="fc" id="L4191">					final JavaOperationInfo javaInfo = (JavaOperationInfo) curEntry.getValue();</span>
<span class="fc" id="L4192">					this.deleteJavaOperation(javaInfo.getId());</span>
<span class="fc" id="L4193">					break;</span>
				case LANG_NONE:
<span class="nc" id="L4195">					break;</span>
				case LANG_PYTHON:
<span class="nc" id="L4197">					final PythonOperationInfo info = (PythonOperationInfo) curEntry.getValue();</span>
<span class="nc" id="L4198">					this.deletePythonOperation(info.getId());</span>
<span class="nc" id="L4199">					break;</span>
				default:
					break;
				}
<span class="fc" id="L4203">			}</span>

<span class="nc" id="L4205">		} catch (final SQLException e1) {</span>
<span class="nc" id="L4206">			e1.printStackTrace();</span>
<span class="fc" id="L4207">		}</span>

<span class="fc" id="L4209">		Connection conn = null;</span>
		try {
<span class="fc" id="L4211">			conn = dataSource.getConnection();</span>
<span class="fc" id="L4212">			final PreparedStatement stmt = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.DELETE_OPERATION_BY_ID.getSqlStatement());</span>
<span class="fc" id="L4213">			stmt.setObject(1, uuid);</span>
			// CHECKSTYLE:ON
<span class="pc bpc" id="L4215" title="1 of 2 branches missed.">			if (DEBUG_ENABLED) {</span>
<span class="nc" id="L4216">				logger.debug(&quot;[==DB==] Executing &quot; + stmt);</span>
			}
<span class="fc" id="L4218">			stmt.executeUpdate();</span>
<span class="fc" id="L4219">			stmt.close();</span>

<span class="nc" id="L4221">		} catch (final Exception e) {</span>
<span class="nc" id="L4222">			e.printStackTrace();</span>
		} finally {
			try {
<span class="pc bpc" id="L4225" title="1 of 2 branches missed.">				if (conn != null) {</span>
<span class="fc" id="L4226">					conn.close();</span>
				}
<span class="nc" id="L4228">			} catch (final SQLException ex1) {</span>
<span class="nc" id="L4229">				logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="fc" id="L4230">			}</span>
		}
<span class="fc" id="L4232">	}</span>

	/**
	 * Delete
	 * @param uuid
	 *            UUID of object to delete
	 */
	private void deleteJavaClass(final UUID uuid) {
<span class="nc" id="L4240">		Connection conn = null;</span>
		try {
<span class="nc" id="L4242">			conn = dataSource.getConnection();</span>
<span class="nc" id="L4243">			final PreparedStatement stmt = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.DELETE_JAVA_METACLASS_BY_ID.getSqlStatement());</span>
<span class="nc" id="L4244">			stmt.setObject(1, uuid);</span>
			// CHECKSTYLE:ON
<span class="nc bnc" id="L4246" title="All 2 branches missed.">			if (DEBUG_ENABLED) {</span>
<span class="nc" id="L4247">				logger.debug(&quot;[==DB==] Executing &quot; + stmt);</span>
			}
<span class="nc" id="L4249">			stmt.executeUpdate();</span>
<span class="nc" id="L4250">			stmt.close();</span>

<span class="nc" id="L4252">		} catch (final Exception e) {</span>
<span class="nc" id="L4253">			e.printStackTrace();</span>
		} finally {
			try {
<span class="nc bnc" id="L4256" title="All 2 branches missed.">				if (conn != null) {</span>
<span class="nc" id="L4257">					conn.close();</span>
				}
<span class="nc" id="L4259">			} catch (final SQLException ex1) {</span>
<span class="nc" id="L4260">				logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L4261">			}</span>
		}
<span class="nc" id="L4263">	}</span>

	/**
	 * Delete
	 * @param uuid
	 *            UUID of object to delete
	 */
	private void deletePythonClass(final UUID uuid) {
<span class="nc" id="L4271">		Connection conn = null;</span>
		try {
<span class="nc" id="L4273">			conn = dataSource.getConnection();</span>
<span class="nc" id="L4274">			final PreparedStatement stmt = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.DELETE_PYTHON_METACLASS_BY_ID.getSqlStatement());</span>
<span class="nc" id="L4275">			stmt.setObject(1, uuid);</span>
			// CHECKSTYLE:ON
<span class="nc bnc" id="L4277" title="All 2 branches missed.">			if (DEBUG_ENABLED) {</span>
<span class="nc" id="L4278">				logger.debug(&quot;[==DB==] Executing &quot; + stmt);</span>
			}
<span class="nc" id="L4280">			stmt.executeUpdate();</span>
<span class="nc" id="L4281">			stmt.close();</span>

<span class="nc" id="L4283">		} catch (final Exception e) {</span>
<span class="nc" id="L4284">			e.printStackTrace();</span>
		} finally {
			try {
<span class="nc bnc" id="L4287" title="All 2 branches missed.">				if (conn != null) {</span>
<span class="nc" id="L4288">					conn.close();</span>
				}
<span class="nc" id="L4290">			} catch (final SQLException ex1) {</span>
<span class="nc" id="L4291">				logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L4292">			}</span>
		}
<span class="nc" id="L4294">	}</span>

	/**
	 * Delete
	 * @param uuid
	 *            UUID of object to delete
	 */
	private void deleteMetaClass(final UUID uuid) {

		try {
<span class="nc" id="L4304">			final MetaClass clazz = this.getMetaClassByID(uuid);</span>

			// Parent type
<span class="nc bnc" id="L4307" title="All 2 branches missed.">			if (clazz.getParentType() != null) {</span>
<span class="nc" id="L4308">				this.deleteType(clazz.getParentType().getId());</span>
			}

			// Properties
<span class="nc bnc" id="L4312" title="All 2 branches missed.">			for (final Property prop : clazz.getProperties()) {</span>
<span class="nc" id="L4313">				this.deleteProperty(prop.getDataClayID().getId());</span>
<span class="nc" id="L4314">			}</span>

			// Operations
<span class="nc bnc" id="L4317" title="All 2 branches missed.">			for (final Operation op : clazz.getOperations()) {</span>
<span class="nc" id="L4318">				this.deleteOperation(op.getDataClayID().getId());</span>
<span class="nc" id="L4319">			}</span>

			// Extensions
<span class="nc" id="L4322">			final Map&lt;Langs, LanguageDependantClassInfo&gt; extensions = clazz.getLanguageDepInfos();</span>
<span class="nc bnc" id="L4323" title="All 2 branches missed.">			for (final Entry&lt;Langs, LanguageDependantClassInfo&gt; curEntry : extensions.entrySet()) {</span>
<span class="nc" id="L4324">				final Langs lang = curEntry.getKey();</span>
<span class="nc bnc" id="L4325" title="All 4 branches missed.">				switch (lang) {</span>
				case LANG_JAVA:
<span class="nc" id="L4327">					final JavaClassInfo javaInfo = (JavaClassInfo) curEntry.getValue();</span>
<span class="nc" id="L4328">					this.deleteJavaClass(javaInfo.getId());</span>
<span class="nc" id="L4329">					break;</span>
				case LANG_NONE:
<span class="nc" id="L4331">					break;</span>
				case LANG_PYTHON:
<span class="nc" id="L4333">					final PythonClassInfo info = (PythonClassInfo) curEntry.getValue();</span>
<span class="nc" id="L4334">					this.deletePythonClass(info.getId());</span>
<span class="nc" id="L4335">					break;</span>
				default:
					break;
				}
<span class="nc" id="L4339">			}</span>

<span class="nc" id="L4341">		} catch (final SQLException e1) {</span>
<span class="nc" id="L4342">			e1.printStackTrace();</span>
<span class="nc" id="L4343">		}</span>

<span class="nc" id="L4345">		Connection conn = null;</span>
		try {
<span class="nc" id="L4347">			conn = dataSource.getConnection();</span>
<span class="nc" id="L4348">			final PreparedStatement stmt = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.DELETE_METACLASS_BY_ID.getSqlStatement());</span>
<span class="nc" id="L4349">			stmt.setObject(1, uuid);</span>
			// CHECKSTYLE:ON
<span class="nc bnc" id="L4351" title="All 2 branches missed.">			if (DEBUG_ENABLED) {</span>
<span class="nc" id="L4352">				logger.debug(&quot;[==DB==] Executing &quot; + stmt);</span>
			}
<span class="nc" id="L4354">			stmt.executeUpdate();</span>
<span class="nc" id="L4355">			stmt.close();</span>

<span class="nc" id="L4357">		} catch (final Exception e) {</span>
<span class="nc" id="L4358">			e.printStackTrace();</span>
		} finally {
			try {
<span class="nc bnc" id="L4361" title="All 2 branches missed.">				if (conn != null) {</span>
<span class="nc" id="L4362">					conn.close();</span>
				}
<span class="nc" id="L4364">			} catch (final SQLException ex1) {</span>
<span class="nc" id="L4365">				logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L4366">			}</span>
		}
<span class="nc" id="L4368">	}</span>

	/**
	 * Delete
	 * @param classID
	 *            ID of object to delete
	 */
	public void deleteClass(final MetaClassID classID) {
<span class="nc" id="L4376">		synchronized (dataSource) {</span>
<span class="nc" id="L4377">			this.deleteMetaClass(classID.getId());</span>
<span class="nc" id="L4378">		}</span>
<span class="nc" id="L4379">	}</span>

	/**
	 * Update java bytecode
	 * @param javaClassInfoUUID
	 *            UUID of JavaClassInfo
	 * @param newByteCode
	 *            New bytecode
	 */
	public void updateJavaClassByteCode(final UUID javaClassInfoUUID,
			final byte[] newByteCode) {
<span class="fc" id="L4390">		synchronized (dataSource) {</span>
<span class="fc" id="L4391">			Connection conn = null;</span>
			try {
<span class="fc" id="L4393">				conn = dataSource.getConnection();</span>
<span class="fc" id="L4394">				final PreparedStatement stmt = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.UPDATE_JAVA_CLASS_BYTECODE_BY_ID.getSqlStatement());</span>
<span class="fc" id="L4395">				stmt.setBytes(1, newByteCode);</span>
<span class="fc" id="L4396">				stmt.setObject(2, javaClassInfoUUID);</span>
				// CHECKSTYLE:ON
<span class="pc bpc" id="L4398" title="1 of 2 branches missed.">				if (DEBUG_ENABLED) {</span>
<span class="nc" id="L4399">					logger.debug(&quot;[==DB==] Executing &quot; + stmt);</span>
				}
<span class="fc" id="L4401">				stmt.executeUpdate();</span>
<span class="fc" id="L4402">				stmt.close();</span>

<span class="nc" id="L4404">			} catch (final Exception e) {</span>
<span class="nc" id="L4405">				e.printStackTrace();</span>
			} finally {
				try {
<span class="pc bpc" id="L4408" title="1 of 2 branches missed.">					if (conn != null) {</span>
<span class="fc" id="L4409">						conn.close();</span>
					}
<span class="nc" id="L4411">				} catch (final SQLException ex1) {</span>
<span class="nc" id="L4412">					logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="fc" id="L4413">				}</span>
			}
<span class="fc" id="L4415">		}</span>

<span class="fc" id="L4417">	}</span>

	/**
	 * Check if exists class in namespace
	 * @param namespaceID
	 *            ID of namespace
	 * @return TRUE if exists.
	 */
	public boolean existsClassInNamespace(final NamespaceID namespaceID) {
<span class="nc" id="L4426">		synchronized (dataSource) {</span>
<span class="nc" id="L4427">			ResultSet rs = null;</span>
<span class="nc" id="L4428">			boolean exists = false;</span>
<span class="nc" id="L4429">			Connection conn = null;</span>
			try {
<span class="nc" id="L4431">				conn = dataSource.getConnection();</span>
<span class="nc" id="L4432">				final PreparedStatement existsStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.EXISTS_CLASS_IN_NAMESPACE.getSqlStatement());</span>

<span class="nc" id="L4434">				existsStatement.setObject(1, namespaceID.getId());</span>
<span class="nc bnc" id="L4435" title="All 2 branches missed.">				if (DEBUG_ENABLED) {</span>
<span class="nc" id="L4436">					logger.debug(&quot;[==DB==] Executing &quot; + existsStatement);</span>
				}
<span class="nc" id="L4438">				rs = existsStatement.executeQuery();</span>
<span class="nc" id="L4439">				rs.next();</span>
<span class="nc" id="L4440">				exists = rs.getBoolean(1);</span>
<span class="nc" id="L4441">				existsStatement.close();</span>
<span class="nc" id="L4442">			} catch (final Exception e) {</span>
<span class="nc" id="L4443">				e.printStackTrace();</span>
			} finally {
				try {
<span class="nc bnc" id="L4446" title="All 2 branches missed.">					if (conn != null) {</span>
<span class="nc" id="L4447">						conn.close();</span>
					}
<span class="nc" id="L4449">				} catch (final SQLException ex1) {</span>
<span class="nc" id="L4450">					logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L4451">				}</span>
			}

<span class="nc" id="L4454">			return exists;</span>
		}

	}

	/**
	 * Update class with new properties and operations
	 * @param classID
	 *            ID of class
	 * @param newProperty
	 *            New property
	 * @param newSetter
	 *            New setter operation
	 * @param newGetter
	 *            New getter operation
	 */
	public void updateClassPropertiesAndOperations(final MetaClassID classID,
			final Property newProperty, final Operation newSetter,
			final Operation newGetter, final Operation newUpdate) {
<span class="fc" id="L4473">		synchronized (dataSource) {</span>
<span class="fc" id="L4474">			final UUID newPropertyUUID = this.storeProperty(newProperty);</span>
<span class="fc" id="L4475">			final UUID setterUUID = this.storeOperation(newSetter);</span>
<span class="fc" id="L4476">			final UUID getterUUID = this.storeOperation(newGetter);</span>

<span class="fc" id="L4478">			UUID updateUUID = null;</span>
<span class="pc bpc" id="L4479" title="1 of 2 branches missed.">			if (newUpdate != null) {</span>
<span class="nc" id="L4480">				updateUUID = this.storeOperation(newUpdate);</span>
			}
<span class="fc" id="L4482">			Connection conn = null;</span>
			try {
				// CHECKSTYLE:OFF
<span class="fc" id="L4485">				conn = dataSource.getConnection();</span>
<span class="fc" id="L4486">				final PreparedStatement stmt = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.UPDATE_CLASS_ADD_PROPERTY_BY_ID.getSqlStatement());</span>
<span class="fc" id="L4487">				stmt.setObject(1, newPropertyUUID);</span>
<span class="fc" id="L4488">				stmt.setObject(2, setterUUID);</span>
<span class="fc" id="L4489">				stmt.setObject(3, getterUUID);</span>
<span class="pc bpc" id="L4490" title="1 of 2 branches missed.">				if (updateUUID != null) {</span>
<span class="nc" id="L4491">					stmt.setObject(4, updateUUID);</span>
				} else {
<span class="fc" id="L4493">					stmt.setObject(4, null);</span>
				}
<span class="fc" id="L4495">				stmt.setObject(5, classID.getId());</span>
				// CHECKSTYLE:ON
<span class="pc bpc" id="L4497" title="1 of 2 branches missed.">				if (DEBUG_ENABLED) {</span>
<span class="nc" id="L4498">					logger.debug(&quot;[==DB==] Executing &quot; + stmt);</span>
				}
<span class="fc" id="L4500">				stmt.executeUpdate();</span>
<span class="fc" id="L4501">				stmt.close();</span>
<span class="nc" id="L4502">			} catch (final Exception e) {</span>
<span class="nc" id="L4503">				e.printStackTrace();</span>
			} finally {
				try {
<span class="pc bpc" id="L4506" title="1 of 2 branches missed.">					if (conn != null) {</span>
<span class="fc" id="L4507">						conn.close();</span>
					}
<span class="nc" id="L4509">				} catch (final SQLException ex1) {</span>
<span class="nc" id="L4510">					logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="fc" id="L4511">				}</span>
			}
<span class="fc" id="L4513">		}</span>

<span class="fc" id="L4515">	}</span>

	/**
	 * Update class with new properties and operations
	 * @param classID
	 *            ID of class
	 * @param newProperty
	 *            New property
	 * @param newSetter
	 *            New setter operation
	 * @param newGetter
	 *            New getter operation
	 */
	public void updateClassPropertiesAndOperations(final MetaClassID classID,
			final Property newProperty, final OperationID newSetter,
			final OperationID newGetter) {
<span class="nc" id="L4531">		synchronized (dataSource) {</span>
<span class="nc" id="L4532">			final UUID newPropertyUUID = this.storeProperty(newProperty);</span>
<span class="nc" id="L4533">			final UUID setterUUID = newSetter.getId();</span>
<span class="nc" id="L4534">			final UUID getterUUID = newGetter.getId();</span>
<span class="nc" id="L4535">			Connection conn = null;</span>
			try {
				// CHECKSTYLE:OFF
<span class="nc" id="L4538">				conn = dataSource.getConnection();</span>
<span class="nc" id="L4539">				final PreparedStatement stmt = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.UPDATE_CLASS_ADD_PROPERTY_BY_ID.getSqlStatement());</span>
<span class="nc" id="L4540">				stmt.setObject(1, newPropertyUUID);</span>
<span class="nc" id="L4541">				stmt.setObject(2, setterUUID);</span>
<span class="nc" id="L4542">				stmt.setObject(3, getterUUID);</span>
<span class="nc" id="L4543">				stmt.setObject(4, classID.getId());</span>
				// CHECKSTYLE:ON
<span class="nc bnc" id="L4545" title="All 2 branches missed.">				if (DEBUG_ENABLED) {</span>
<span class="nc" id="L4546">					logger.debug(&quot;[==DB==] Executing &quot; + stmt);</span>
				}
<span class="nc" id="L4548">				stmt.executeUpdate();</span>
<span class="nc" id="L4549">				stmt.close();</span>

<span class="nc" id="L4551">			} catch (final Exception e) {</span>
<span class="nc" id="L4552">				e.printStackTrace();</span>
			} finally {
				try {
<span class="nc bnc" id="L4555" title="All 2 branches missed.">					if (conn != null) {</span>
<span class="nc" id="L4556">						conn.close();</span>
					}
<span class="nc" id="L4558">				} catch (final SQLException ex1) {</span>
<span class="nc" id="L4559">					logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L4560">				}</span>
			}
<span class="nc" id="L4562">		}</span>
<span class="nc" id="L4563">	}</span>

	/**
	 * Update class with new operation
	 * @param classID
	 *            ID of class
	 * @param newoperation
	 *            New operation
	 */
	public void updateClassAddOperation(final MetaClassID classID,
			final Operation newoperation) {
<span class="fc" id="L4574">		synchronized (dataSource) {</span>
<span class="fc" id="L4575">			final UUID newOpUUID = this.storeOperation(newoperation);</span>
<span class="fc" id="L4576">			Connection conn = null;</span>
			try {
				// CHECKSTYLE:OFF
<span class="fc" id="L4579">				conn = dataSource.getConnection();</span>
<span class="fc" id="L4580">				final PreparedStatement stmt = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.UPDATE_CLASS_ADD_OPERATION_BY_ID.getSqlStatement());</span>
<span class="fc" id="L4581">				stmt.setObject(1, newOpUUID);</span>
<span class="fc" id="L4582">				stmt.setObject(2, classID.getId());</span>
				// CHECKSTYLE:ON
<span class="pc bpc" id="L4584" title="1 of 2 branches missed.">				if (DEBUG_ENABLED) {</span>
<span class="nc" id="L4585">					logger.debug(&quot;[==DB==] Executing &quot; + stmt);</span>
				}
<span class="fc" id="L4587">				stmt.executeUpdate();</span>
<span class="fc" id="L4588">				stmt.close();</span>

<span class="nc" id="L4590">			} catch (final Exception e) {</span>
<span class="nc" id="L4591">				e.printStackTrace();</span>
			} finally {
				try {
<span class="pc bpc" id="L4594" title="1 of 2 branches missed.">					if (conn != null) {</span>
<span class="fc" id="L4595">						conn.close();</span>
					}
<span class="nc" id="L4597">				} catch (final SQLException ex1) {</span>
<span class="nc" id="L4598">					logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="fc" id="L4599">				}</span>
			}
<span class="fc" id="L4601">		}</span>
<span class="fc" id="L4602">	}</span>

	/**
	 * Update class removing operation
	 * @param classID
	 *            ID of class
	 * @param opID
	 *            ID of operation
	 */
	public void updateClassRemoveOperation(final MetaClassID classID,
			final OperationID opID) {
<span class="fc" id="L4613">		synchronized (dataSource) {</span>
<span class="fc" id="L4614">			Connection conn = null;</span>
			try {
				// CHECKSTYLE:OFF
<span class="fc" id="L4617">				conn = dataSource.getConnection();</span>
<span class="fc" id="L4618">				final PreparedStatement stmt = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.UPDATE_CLASS_REMOVE_OPERATION_BY_ID.getSqlStatement());</span>
<span class="fc" id="L4619">				stmt.setObject(1, opID.getId());</span>
<span class="fc" id="L4620">				stmt.setObject(2, classID.getId());</span>
				// CHECKSTYLE:ON
<span class="pc bpc" id="L4622" title="1 of 2 branches missed.">				if (DEBUG_ENABLED) {</span>
<span class="nc" id="L4623">					logger.debug(&quot;[==DB==] Executing &quot; + stmt);</span>
				}
<span class="fc" id="L4625">				stmt.executeUpdate();</span>
<span class="fc" id="L4626">				stmt.close();</span>

<span class="nc" id="L4628">			} catch (final Exception e) {</span>
<span class="nc" id="L4629">				e.printStackTrace();</span>
			} finally {
				try {
<span class="pc bpc" id="L4632" title="1 of 2 branches missed.">					if (conn != null) {</span>
<span class="fc" id="L4633">						conn.close();</span>
					}
<span class="nc" id="L4635">				} catch (final SQLException ex1) {</span>
<span class="nc" id="L4636">					logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="fc" id="L4637">				}</span>
			}
<span class="fc" id="L4639">		}</span>
<span class="fc" id="L4640">	}</span>

	/**
	 * Update operation removing implementation
	 * @param opID
	 *            ID of operation
	 * @param implID
	 *            ID of implementation
	 */
	public void updateOperationRemoveImplementation(final OperationID opID,
			final ImplementationID implID) {
<span class="nc" id="L4651">		synchronized (dataSource) {</span>
<span class="nc" id="L4652">			Connection conn = null;</span>
			try {
				// CHECKSTYLE:OFF
<span class="nc" id="L4655">				conn = dataSource.getConnection();</span>
<span class="nc" id="L4656">				final PreparedStatement stmt = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.UPDATE_OPERATION_REMOVE_IMPLEMENTATION_BY_ID.getSqlStatement());</span>
<span class="nc" id="L4657">				stmt.setObject(1, implID.getId());</span>
<span class="nc" id="L4658">				stmt.setObject(2, opID.getId());</span>
				// CHECKSTYLE:ON
<span class="nc bnc" id="L4660" title="All 2 branches missed.">				if (DEBUG_ENABLED) {</span>
<span class="nc" id="L4661">					logger.debug(&quot;[==DB==] Executing &quot; + stmt);</span>
				}
<span class="nc" id="L4663">				stmt.executeUpdate();</span>
<span class="nc" id="L4664">				stmt.close();</span>

<span class="nc" id="L4666">			} catch (final Exception e) {</span>
<span class="nc" id="L4667">				e.printStackTrace();</span>
			} finally {
				try {
<span class="nc bnc" id="L4670" title="All 2 branches missed.">					if (conn != null) {</span>
<span class="nc" id="L4671">						conn.close();</span>
					}
<span class="nc" id="L4673">				} catch (final SQLException ex1) {</span>
<span class="nc" id="L4674">					logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L4675">				}</span>
			}
<span class="nc" id="L4677">		}</span>
<span class="nc" id="L4678">	}</span>

	/**
	 * Update operation adding implementation
	 * @param opID
	 *            ID of operation
	 * @param impl
	 *            implementation
	 */
	public void updateOperationAddImplementation(final OperationID opID,
			final Implementation impl) {
<span class="nc" id="L4689">		synchronized (dataSource) {</span>
<span class="nc" id="L4690">			UUID implUUID = null;</span>
<span class="nc bnc" id="L4691" title="All 2 branches missed.">			if (impl instanceof JavaImplementation) {</span>
<span class="nc" id="L4692">				implUUID = this.storeJavaImplementation((JavaImplementation) impl);</span>
<span class="nc bnc" id="L4693" title="All 2 branches missed.">			} else if (impl instanceof PythonImplementation) {</span>
<span class="nc" id="L4694">				implUUID = this.storePythonImplementation((PythonImplementation) impl);</span>
			}

<span class="nc" id="L4697">			Connection conn = null;</span>
			try {
				// CHECKSTYLE:OFF
<span class="nc" id="L4700">				conn = dataSource.getConnection();</span>
<span class="nc" id="L4701">				final PreparedStatement stmt = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.UPDATE_OPERATION_ADD_IMPLEMENTATION_BY_ID.getSqlStatement());</span>
<span class="nc" id="L4702">				stmt.setObject(1, implUUID);</span>
<span class="nc" id="L4703">				stmt.setObject(2, opID.getId());</span>
				// CHECKSTYLE:ON
<span class="nc bnc" id="L4705" title="All 2 branches missed.">				if (DEBUG_ENABLED) {</span>
<span class="nc" id="L4706">					logger.debug(&quot;[==DB==] Executing &quot; + stmt);</span>
				}
<span class="nc" id="L4708">				stmt.executeUpdate();</span>
<span class="nc" id="L4709">				stmt.close();</span>

<span class="nc" id="L4711">			} catch (final Exception e) {</span>
<span class="nc" id="L4712">				e.printStackTrace();</span>
			} finally {
				try {
<span class="nc bnc" id="L4715" title="All 2 branches missed.">					if (conn != null) {</span>
<span class="nc" id="L4716">						conn.close();</span>
					}
<span class="nc" id="L4718">				} catch (final SQLException ex1) {</span>
<span class="nc" id="L4719">					logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L4720">				}</span>
			}
<span class="nc" id="L4722">		}</span>
<span class="nc" id="L4723">	}</span>

	/**
	 * Delete operation recursively
	 * @param dataClayID
	 *            ID of operation
	 */
	public void deleteOperation(final OperationID dataClayID) {
<span class="fc" id="L4731">		synchronized (dataSource) {</span>
<span class="fc" id="L4732">			this.deleteOperation(dataClayID.getId());</span>
<span class="fc" id="L4733">		}</span>
<span class="fc" id="L4734">	}</span>

	/**
	 * Delete implementation recursively
	 * @param impl
	 *            implementation
	 */
	public void deleteImplementation(final Implementation impl) {
<span class="nc" id="L4742">		synchronized (dataSource) {</span>
<span class="nc bnc" id="L4743" title="All 2 branches missed.">			if (impl instanceof JavaImplementation) {</span>
<span class="nc" id="L4744">				deleteJavaImplementation(impl.getDataClayID().getId());</span>
<span class="nc bnc" id="L4745" title="All 2 branches missed.">			} else if (impl instanceof PythonImplementation) {</span>
<span class="nc" id="L4746">				deletePythonImplementation(impl.getDataClayID().getId());</span>
			}
<span class="nc" id="L4748">		}</span>
<span class="nc" id="L4749">	}</span>

	/**
	 * Check if exists class in some type
	 * @param classID
	 *            ID of class
	 * @return TRUE if exists.
	 */
	public boolean existsClassInSomeType(final MetaClassID classID) {
<span class="nc" id="L4758">		synchronized (dataSource) {</span>
<span class="nc" id="L4759">			ResultSet rs = null;</span>
<span class="nc" id="L4760">			boolean exists = false;</span>
<span class="nc" id="L4761">			Connection conn = null;</span>
			try {
<span class="nc" id="L4763">				conn = dataSource.getConnection();</span>
<span class="nc" id="L4764">				final PreparedStatement existsStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.EXISTS_TYPE_CLASS_ID.getSqlStatement());</span>

<span class="nc" id="L4766">				existsStatement.setObject(1, classID.getId());</span>
<span class="nc bnc" id="L4767" title="All 2 branches missed.">				if (DEBUG_ENABLED) {</span>
<span class="nc" id="L4768">					logger.debug(&quot;[==DB==] Executing &quot; + existsStatement);</span>
				}
<span class="nc" id="L4770">				rs = existsStatement.executeQuery();</span>
<span class="nc" id="L4771">				rs.next();</span>
<span class="nc" id="L4772">				exists = rs.getBoolean(1);</span>
<span class="nc" id="L4773">				existsStatement.close();</span>
<span class="nc" id="L4774">			} catch (final Exception e) {</span>
<span class="nc" id="L4775">				e.printStackTrace();</span>
			} finally {
				try {
<span class="nc bnc" id="L4778" title="All 2 branches missed.">					if (conn != null) {</span>
<span class="nc" id="L4779">						conn.close();</span>
					}
<span class="nc" id="L4781">				} catch (final SQLException ex1) {</span>
<span class="nc" id="L4782">					logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L4783">				}</span>
			}

<span class="nc" id="L4786">			return exists;</span>
		}
	}

	/**
	 * Check if exists accessed implementation
	 * @param implID
	 *            ID of implementation
	 * @return TRUE if exists.
	 */
	public boolean existsAccessedImplementationWithID(final ImplementationID implID) {
<span class="nc" id="L4797">		synchronized (dataSource) {</span>
<span class="nc" id="L4798">			ResultSet rs = null;</span>
<span class="nc" id="L4799">			boolean exists = false;</span>
<span class="nc" id="L4800">			Connection conn = null;</span>
			try {
<span class="nc" id="L4802">				conn = dataSource.getConnection();</span>
<span class="nc" id="L4803">				final PreparedStatement existsStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.EXISTS_ACCESSED_IMPLEMENTATION_ID.getSqlStatement());</span>

<span class="nc" id="L4805">				existsStatement.setObject(1, implID.getId());</span>
<span class="nc bnc" id="L4806" title="All 2 branches missed.">				if (DEBUG_ENABLED) {</span>
<span class="nc" id="L4807">					logger.debug(&quot;[==DB==] Executing &quot; + existsStatement);</span>
				}
<span class="nc" id="L4809">				rs = existsStatement.executeQuery();</span>
<span class="nc" id="L4810">				rs.next();</span>
<span class="nc" id="L4811">				exists = rs.getBoolean(1);</span>
<span class="nc" id="L4812">				existsStatement.close();</span>
<span class="nc" id="L4813">			} catch (final Exception e) {</span>
<span class="nc" id="L4814">				e.printStackTrace();</span>
			} finally {
				try {
<span class="nc bnc" id="L4817" title="All 2 branches missed.">					if (conn != null) {</span>
<span class="nc" id="L4818">						conn.close();</span>
					}
<span class="nc" id="L4820">				} catch (final SQLException ex1) {</span>
<span class="nc" id="L4821">					logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L4822">				}</span>
			}

<span class="nc" id="L4825">			return exists;</span>
		}
	}

	/**
	 * Get class by name and namespace id
	 * @param className
	 *            Name of class
	 * @param namespaceID
	 *            Namespace ID
	 * @return The class
	 */
	public MetaClass getClassByNameAndNamespaceID(final String className,
			final NamespaceID namespaceID) {
<span class="nc" id="L4839">		synchronized (dataSource) {</span>
<span class="nc" id="L4840">			ResultSet rs = null;</span>
<span class="nc" id="L4841">			MetaClass result = null;</span>
<span class="nc" id="L4842">			Connection conn = null;</span>
			try {
<span class="nc" id="L4844">				conn = dataSource.getConnection();</span>
<span class="nc" id="L4845">				final PreparedStatement selectStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.SELECT_CLASS_BY_NAME_AND_NAMESPACEID.getSqlStatement());</span>

<span class="nc" id="L4847">				selectStatement.setString(1, className);</span>
<span class="nc" id="L4848">				selectStatement.setObject(2, namespaceID.getId());</span>
<span class="nc bnc" id="L4849" title="All 2 branches missed.">				if (DEBUG_ENABLED) {</span>
<span class="nc" id="L4850">					logger.debug(&quot;[==DB==] Executing &quot; + selectStatement);</span>
				}
<span class="nc" id="L4852">				rs = selectStatement.executeQuery();</span>
<span class="nc bnc" id="L4853" title="All 2 branches missed.">				if (rs.next()) {</span>
<span class="nc" id="L4854">					result = deserializeMetaClass(rs);</span>
				}
<span class="nc" id="L4856">				selectStatement.close();</span>
<span class="nc" id="L4857">			} catch (final SQLException e) {</span>
<span class="nc" id="L4858">				e.printStackTrace();</span>
			} finally {
				try {
<span class="nc bnc" id="L4861" title="All 2 branches missed.">					if (conn != null) {</span>
<span class="nc" id="L4862">						conn.close();</span>
					}
<span class="nc" id="L4864">				} catch (final SQLException ex1) {</span>
<span class="nc" id="L4865">					logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L4866">				}</span>
			}

<span class="nc" id="L4869">			return result;</span>
		}
	}

	/**
	 * Get class by name and namespace id
	 * @param className
	 *            Name of class
	 * @param namespace
	 *            Namespace
	 * @return The class
	 */
	public MetaClass getClassByNameAndNamespace(final String className,
			final String namespace) {
<span class="nc" id="L4883">		synchronized (dataSource) {</span>
<span class="nc" id="L4884">			ResultSet rs = null;</span>
<span class="nc" id="L4885">			MetaClass result = null;</span>
<span class="nc" id="L4886">			Connection conn = null;</span>
			try {
<span class="nc" id="L4888">				conn = dataSource.getConnection();</span>
<span class="nc" id="L4889">				final PreparedStatement selectStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.SELECT_CLASS_BY_NAME_AND_NAMESPACE.getSqlStatement());</span>

<span class="nc" id="L4891">				selectStatement.setString(1, className);</span>
<span class="nc" id="L4892">				selectStatement.setString(2, namespace);</span>
<span class="nc bnc" id="L4893" title="All 2 branches missed.">				if (DEBUG_ENABLED) {</span>
<span class="nc" id="L4894">					logger.debug(&quot;[==DB==] Executing &quot; + selectStatement);</span>
				}
<span class="nc" id="L4896">				rs = selectStatement.executeQuery();</span>
<span class="nc bnc" id="L4897" title="All 2 branches missed.">				if (rs.next()) {</span>
<span class="nc" id="L4898">					result = deserializeMetaClass(rs);</span>
				}
<span class="nc" id="L4900">				selectStatement.close();</span>
<span class="nc" id="L4901">			} catch (final SQLException e) {</span>
<span class="nc" id="L4902">				e.printStackTrace();</span>
			} finally {
				try {
<span class="nc bnc" id="L4905" title="All 2 branches missed.">					if (conn != null) {</span>
<span class="nc" id="L4906">						conn.close();</span>
					}
<span class="nc" id="L4908">				} catch (final SQLException ex1) {</span>
<span class="nc" id="L4909">					logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L4910">				}</span>
			}

<span class="nc" id="L4913">			return result;</span>
		}
	}

	/**
	 * Get property by names
	 * @param propertyName
	 *            property name
	 * @param className
	 *            Name of class
	 * @param namespace
	 *            Namespace
	 * @return The property
	 */
	public Property getPropertyByNames(final String propertyName, final String className,
			final String namespace) {
<span class="nc" id="L4929">		synchronized (dataSource) {</span>
<span class="nc" id="L4930">			ResultSet rs = null;</span>
<span class="nc" id="L4931">			Property result = null;</span>
<span class="nc" id="L4932">			Connection conn = null;</span>
			try {
<span class="nc" id="L4934">				conn = dataSource.getConnection();</span>
<span class="nc" id="L4935">				final PreparedStatement selectStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.SELECT_PROPERTY_BY_NAMES.getSqlStatement());</span>
<span class="nc" id="L4936">				selectStatement.setString(1, propertyName);</span>
				// CHECKSTYLE:OFF
<span class="nc" id="L4938">				selectStatement.setString(2, className);</span>
<span class="nc" id="L4939">				selectStatement.setString(3, namespace);</span>
				// CHECKSTYLE:ON
<span class="nc bnc" id="L4941" title="All 2 branches missed.">				if (DEBUG_ENABLED) {</span>
<span class="nc" id="L4942">					logger.debug(&quot;[==DB==] Executing &quot; + selectStatement);</span>
				}
<span class="nc" id="L4944">				rs = selectStatement.executeQuery();</span>
<span class="nc bnc" id="L4945" title="All 2 branches missed.">				if (rs.next()) {</span>
<span class="nc" id="L4946">					result = deserializeProperty(rs);</span>
				}
<span class="nc" id="L4948">				selectStatement.close();</span>
<span class="nc" id="L4949">			} catch (final SQLException e) {</span>
<span class="nc" id="L4950">				e.printStackTrace();</span>
			} finally {
				try {
<span class="nc bnc" id="L4953" title="All 2 branches missed.">					if (conn != null) {</span>
<span class="nc" id="L4954">						conn.close();</span>
					}
<span class="nc" id="L4956">				} catch (final SQLException ex1) {</span>
<span class="nc" id="L4957">					logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L4958">				}</span>
			}

<span class="nc" id="L4961">			return result;</span>
		}
	}

	/**
	 * Get operation by names
	 * @param operationSignature
	 *            signature
	 * @param className
	 *            Name of class
	 * @param namespace
	 *            Namespace
	 * @return The Operation
	 */
	public Operation getOperationByNames(final String operationSignature, final String className,
			final String namespace) {
<span class="nc" id="L4977">		synchronized (dataSource) {</span>
<span class="nc" id="L4978">			ResultSet rs = null;</span>
<span class="nc" id="L4979">			Operation result = null;</span>
<span class="nc" id="L4980">			Connection conn = null;</span>
			try {
<span class="nc" id="L4982">				conn = dataSource.getConnection();</span>
<span class="nc" id="L4983">				final PreparedStatement selectStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.SELECT_OPERATION_BY_NAMES.getSqlStatement());</span>
<span class="nc" id="L4984">				selectStatement.setString(1, operationSignature);</span>
<span class="nc" id="L4985">				selectStatement.setString(2, className);</span>
				// CHECKSTYLE:OFF
<span class="nc" id="L4987">				selectStatement.setString(3, namespace);</span>
				// CHECKSTYLE:ON
<span class="nc bnc" id="L4989" title="All 2 branches missed.">				if (DEBUG_ENABLED) {</span>
<span class="nc" id="L4990">					logger.debug(&quot;[==DB==] Executing &quot; + selectStatement);</span>
				}
<span class="nc" id="L4992">				rs = selectStatement.executeQuery();</span>
<span class="nc bnc" id="L4993" title="All 2 branches missed.">				if (rs.next()) {</span>
<span class="nc" id="L4994">					result = deserializeOperation(rs);</span>
				}
<span class="nc" id="L4996">				selectStatement.close();</span>
<span class="nc" id="L4997">			} catch (final SQLException e) {</span>
<span class="nc" id="L4998">				e.printStackTrace();</span>
			} finally {
				try {
<span class="nc bnc" id="L5001" title="All 2 branches missed.">					if (conn != null) {</span>
<span class="nc" id="L5002">						conn.close();</span>
					}
<span class="nc" id="L5004">				} catch (final SQLException ex1) {</span>
<span class="nc" id="L5005">					logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L5006">				}</span>
			}

<span class="nc" id="L5009">			return result;</span>
		}
	}

	/**
	 * Get properties by class id and namespace id
	 * @param classID
	 *            ID of class
	 * @param namespaceID
	 *            Namespace ID
	 * @return The properties
	 */
	public List&lt;Property&gt; getPropertiesByClassIDAndNamespaceID(final MetaClassID classID,
			final NamespaceID namespaceID) {
<span class="nc" id="L5023">		synchronized (dataSource) {</span>
<span class="nc" id="L5024">			ResultSet rs = null;</span>
<span class="nc" id="L5025">			final List&lt;Property&gt; result = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L5026">			Connection conn = null;</span>
			try {
<span class="nc" id="L5028">				conn = dataSource.getConnection();</span>
<span class="nc" id="L5029">				final PreparedStatement selectStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.SELECT_PROPERTY_OF_ENRICHMENT.getSqlStatement());</span>

<span class="nc" id="L5031">				selectStatement.setObject(1, classID.getId());</span>
<span class="nc" id="L5032">				selectStatement.setObject(2, namespaceID.getId());</span>
<span class="nc bnc" id="L5033" title="All 2 branches missed.">				if (DEBUG_ENABLED) {</span>
<span class="nc" id="L5034">					logger.debug(&quot;[==DB==] Executing &quot; + selectStatement);</span>
				}
<span class="nc" id="L5036">				rs = selectStatement.executeQuery();</span>
<span class="nc bnc" id="L5037" title="All 2 branches missed.">				while (rs.next()) {</span>
<span class="nc" id="L5038">					result.add(deserializeProperty(rs));</span>
				}
<span class="nc" id="L5040">				selectStatement.close();</span>
<span class="nc" id="L5041">			} catch (final SQLException e) {</span>
<span class="nc" id="L5042">				e.printStackTrace();</span>
			} finally {
				try {
<span class="nc bnc" id="L5045" title="All 2 branches missed.">					if (conn != null) {</span>
<span class="nc" id="L5046">						conn.close();</span>
					}
<span class="nc" id="L5048">				} catch (final SQLException ex1) {</span>
<span class="nc" id="L5049">					logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L5050">				}</span>
			}

<span class="nc" id="L5053">			return result;</span>
		}
	}

	/**
	 * Get operations by class id and namespace id
	 * @param classID
	 *            ID of class
	 * @param namespaceID
	 *            Namespace ID
	 * @return The operations
	 */
	public List&lt;Operation&gt; getOperationsByClassIDAndNamespaceID(final MetaClassID classID,
			final NamespaceID namespaceID) {
<span class="nc" id="L5067">		synchronized (dataSource) {</span>
<span class="nc" id="L5068">			ResultSet rs = null;</span>
<span class="nc" id="L5069">			final List&lt;Operation&gt; result = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L5070">			Connection conn = null;</span>
			try {
<span class="nc" id="L5072">				conn = dataSource.getConnection();</span>
<span class="nc" id="L5073">				final PreparedStatement selectStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.SELECT_OPERATION_OF_ENRICHMENT.getSqlStatement());</span>

<span class="nc" id="L5075">				selectStatement.setObject(1, classID.getId());</span>
<span class="nc" id="L5076">				selectStatement.setObject(2, namespaceID.getId());</span>
<span class="nc bnc" id="L5077" title="All 2 branches missed.">				if (DEBUG_ENABLED) {</span>
<span class="nc" id="L5078">					logger.debug(&quot;[==DB==] Executing &quot; + selectStatement);</span>
				}
<span class="nc" id="L5080">				rs = selectStatement.executeQuery();</span>
<span class="nc bnc" id="L5081" title="All 2 branches missed.">				while (rs.next()) {</span>
<span class="nc" id="L5082">					result.add(deserializeOperation(rs));</span>
				}
<span class="nc" id="L5084">				selectStatement.close();</span>
<span class="nc" id="L5085">			} catch (final SQLException e) {</span>
<span class="nc" id="L5086">				e.printStackTrace();</span>
			} finally {
				try {
<span class="nc bnc" id="L5089" title="All 2 branches missed.">					if (conn != null) {</span>
<span class="nc" id="L5090">						conn.close();</span>
					}
<span class="nc" id="L5092">				} catch (final SQLException ex1) {</span>
<span class="nc" id="L5093">					logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L5094">				}</span>
			}

<span class="nc" id="L5097">			return result;</span>
		}
	}

	/**
	 * Get classes in namespace
	 * @param namespaceID
	 *            Namespace ID
	 * @return The classes
	 */
	public List&lt;MetaClass&gt; getClassesInNamespace(
			final NamespaceID namespaceID) {
<span class="nc" id="L5109">		synchronized (dataSource) {</span>
<span class="nc" id="L5110">			ResultSet rs = null;</span>
<span class="nc" id="L5111">			final List&lt;MetaClass&gt; result = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L5112">			Connection conn = null;</span>
			try {
<span class="nc" id="L5114">				conn = dataSource.getConnection();</span>
<span class="nc" id="L5115">				final PreparedStatement selectStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.SELECT_CLASSES_IN_NAMESPACE.getSqlStatement());</span>

<span class="nc" id="L5117">				selectStatement.setObject(1, namespaceID.getId());</span>
<span class="nc bnc" id="L5118" title="All 2 branches missed.">				if (DEBUG_ENABLED) {</span>
<span class="nc" id="L5119">					logger.debug(&quot;[==DB==] Executing &quot; + selectStatement);</span>
				}
<span class="nc" id="L5121">				rs = selectStatement.executeQuery();</span>
<span class="nc bnc" id="L5122" title="All 2 branches missed.">				while (rs.next()) {</span>
<span class="nc" id="L5123">					result.add(deserializeMetaClass(rs));</span>
				}
<span class="nc" id="L5125">				selectStatement.close();</span>
<span class="nc" id="L5126">			} catch (final SQLException e) {</span>
<span class="nc" id="L5127">				e.printStackTrace();</span>
			} finally {
				try {
<span class="nc bnc" id="L5130" title="All 2 branches missed.">					if (conn != null) {</span>
<span class="nc" id="L5131">						conn.close();</span>
					}
<span class="nc" id="L5133">				} catch (final SQLException ex1) {</span>
<span class="nc" id="L5134">					logger.debug(&quot;SQL Exception while closing connection&quot;, ex1);</span>
<span class="nc" id="L5135">				}</span>
			}

<span class="nc" id="L5138">			return result;</span>
		}
	}

	public MetaClassID getClassIDByNameAndNamespaceID(final String className, final NamespaceID nspaceID) {
<span class="nc" id="L5143">		synchronized (dataSource) {</span>
<span class="nc" id="L5144">			ResultSet rs = null;</span>
<span class="nc" id="L5145">			MetaClassID result = null;</span>
<span class="nc" id="L5146">			Connection conn = null;</span>
			try {
<span class="nc" id="L5148">				conn = dataSource.getConnection();</span>
<span class="nc" id="L5149">				final PreparedStatement selectStatement = conn.prepareStatement(ClassManagerSQLStatements.SqlStatements.SELECT_CLASSID_BY_NAME_AND_NAMESPACEID.getSqlStatement());</span>

<span class="nc" id="L5151">				selectStatement.setString(1, className);</span>
<span class="nc" id="L5152">				selectStatement.setObject(2, nspaceID.getId());</span>
<span class="nc bnc" id="L5153" title="All 2 branches missed.">				if (DEBUG_ENABLED) {</span>
<span class="nc" id="L5154">					logger.debug(&quot;[==DB==] Executing &quot; + selectStatement);</span>
				}
<span class="nc" id="L5156">				rs = selectStatement.executeQuery();</span>
<span class="nc bnc" id="L5157" title="All 2 branches missed.">				if (rs.next()) {</span>
<span class="nc" id="L5158">					result = new MetaClassID((UUID) rs.getObject(&quot;id&quot;));</span>
				}
<span class="nc" id="L5160">				selectStatement.close();</span>

<span class="nc" id="L5162">			} catch (final SQLException e) {</span>
<span class="nc" id="L5163">				e.printStackTrace();</span>
			} finally {
				try {
<span class="nc bnc" id="L5166" title="All 2 branches missed.">					if (conn != null) {</span>
<span class="nc" id="L5167">						conn.close();</span>
					}
<span class="nc" id="L5169">				} catch (final SQLException e) {</span>
<span class="nc" id="L5170">					e.printStackTrace();</span>
<span class="nc" id="L5171">				}</span>
			}

<span class="nc" id="L5174">			return result;</span>
		}
	}
	
	/**
	 * Close DB.
	 */
	public void close() {
		try {
<span class="fc" id="L5183">			dataSource.close();</span>
<span class="nc" id="L5184">		} catch (final SQLException e) {</span>
			// TODO Auto-generated catch block
<span class="nc" id="L5186">			e.printStackTrace();</span>
<span class="fc" id="L5187">		}</span>
<span class="fc" id="L5188">	}</span>

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.6.202009150832</span></div></body></html>